{"ast":null,"code":"import \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.filter.js\";\nimport \"core-js/modules/es.iterator.for-each.js\";\nimport \"core-js/modules/esnext.json.parse.js\";\nimport axios from 'axios';\nimport apiConfig from '@/config/api.config';\nexport default {\n  name: 'NotificationView',\n  data() {\n    return {\n      currentTab: 'all',\n      list: []\n    };\n  },\n  computed: {\n    filteredList() {\n      if (this.currentTab === 'unread') {\n        return this.list.filter(item => !item.read);\n      }\n      return this.list;\n    },\n    unreadCount() {\n      return this.list.filter(item => !item.read).length;\n    },\n    hasUnread() {\n      return this.unreadCount > 0;\n    }\n  },\n  mounted() {\n    this.fetchNotifications();\n  },\n  methods: {\n    fetchNotifications() {\n      // Ëé∑ÂèñÁî®Êà∑ID\n      const userInfoStr = localStorage.getItem('userInfo');\n      const userInfo = userInfoStr ? JSON.parse(userInfoStr) : {};\n      const uid = userInfo.uid || userInfo.id || localStorage.getItem('userId');\n      if (!uid) return;\n\n      // Ê£ÄÊü•Â≠¶ÁîüËÆ§ËØÅÁä∂ÊÄÅ\n      this.checkStudentStatus(uid);\n    },\n    checkStudentStatus(uid) {\n      const readStatus = localStorage.getItem('student_auth_read_status_v3');\n      axios.get(apiConfig.student.getStatus(uid)).then(res => {\n        if (res.data.code === 1 && res.data.data) {\n          const status = res.data.data.status;\n          // status: 1 (Approved), 2 (Rejected)\n\n          if (status === 1 || status === 2) {\n            const isRead = String(readStatus) === String(status);\n\n            // Ê®°ÊãüÊ∂àÊÅØÊï∞ÊçÆ\n            const notification = {\n              id: 'auth_' + status,\n              title: 'Â≠¶ÁîüËÆ§ËØÅÈÄöÁü•',\n              message: status === 1 ? 'ÊÅ≠ÂñúÊÇ®ÔºÅÊÇ®ÁöÑÂ≠¶ÁîüËÆ§ËØÅÁî≥ËØ∑Â∑≤ÈÄöËøáÂÆ°Ê†∏„ÄÇÊÇ®Áé∞Âú®ÂèØ‰ª•‰∫´ÂèóÂ≠¶Áîü‰∏ìÂ±û‰ºòÊÉ†‰∫ÜÔºÅ' : 'ÂæàÊä±Ê≠âÔºåÊÇ®ÁöÑÂ≠¶ÁîüËÆ§ËØÅÁî≥ËØ∑Êú™ÈÄöËøá„ÄÇËØ∑Ê£ÄÊü•‰ø°ÊÅØÂêéÈáçÊñ∞Êèê‰∫§„ÄÇ',\n              time: new Date().toLocaleString(),\n              // ÂÆûÈôÖÂ∫î‰ΩøÁî®ÂêéÁ´ØÊó∂Èó¥\n              type: status === 1 ? 'success' : 'error',\n              read: isRead,\n              rawStatus: status\n            };\n            this.list = [notification];\n          }\n        }\n      }).catch(console.error);\n    },\n    markAsRead(item) {\n      item.read = true;\n      if (item.rawStatus) {\n        localStorage.setItem('student_auth_read_status_v3', item.rawStatus);\n      }\n      // Ëß¶ÂèëApp.vueÊõ¥Êñ∞Á∫¢ÁÇπ\n      window.dispatchEvent(new Event('login-status-changed'));\n    },\n    markAllAsRead() {\n      this.list.forEach(item => {\n        if (!item.read) {\n          this.markAsRead(item);\n        }\n      });\n    }\n  }\n};","map":{"version":3,"names":["axios","apiConfig","name","data","currentTab","list","computed","filteredList","filter","item","read","unreadCount","length","hasUnread","mounted","fetchNotifications","methods","userInfoStr","localStorage","getItem","userInfo","JSON","parse","uid","id","checkStudentStatus","readStatus","get","student","getStatus","then","res","code","status","isRead","String","notification","title","message","time","Date","toLocaleString","type","rawStatus","catch","console","error","markAsRead","setItem","window","dispatchEvent","Event","markAllAsRead","forEach"],"sources":["D:\\1_homework_file\\Â§ß‰∏â‰∏ä\\ËΩØ‰ª∂Â∑•Á®ã\\È°πÁõÆÁïôÊ°£\\1ÂâçÁ´ØÂºÄÂèë_ÊàëÊâçÊòØÁúüÁöÑ\\version5.0\\src\\views\\user\\NotificationView.vue"],"sourcesContent":["<template>\r\n  <div class=\"notification-page\">\r\n    <div class=\"page-container\">\r\n      <div class=\"page-header\">\r\n        <h1>Ê∂àÊÅØ‰∏≠ÂøÉ</h1>\r\n        <div class=\"header-actions\">\r\n          <button @click=\"markAllAsRead\" class=\"mark-read-btn\" :disabled=\"!hasUnread\">\r\n            <span class=\"icon\">‚úì</span> ÂÖ®ÈÉ®Ê†áËÆ∞‰∏∫Â∑≤ËØª\r\n          </button>\r\n        </div>\r\n      </div>\r\n\r\n      <div class=\"notification-tabs\">\r\n        <button \r\n          :class=\"['tab-btn', { active: currentTab === 'all' }]\" \r\n          @click=\"currentTab = 'all'\"\r\n        >\r\n          ÂÖ®ÈÉ®Ê∂àÊÅØ\r\n        </button>\r\n        <button \r\n          :class=\"['tab-btn', { active: currentTab === 'unread' }]\" \r\n          @click=\"currentTab = 'unread'\"\r\n        >\r\n          Êú™ËØªÊ∂àÊÅØ\r\n          <span v-if=\"unreadCount > 0\" class=\"badge\">{{ unreadCount }}</span>\r\n        </button>\r\n      </div>\r\n\r\n      <div class=\"notification-list\" v-if=\"filteredList.length > 0\">\r\n        <div \r\n          v-for=\"item in filteredList\" \r\n          :key=\"item.id\" \r\n          class=\"notification-card\"\r\n          :class=\"{ unread: !item.read }\"\r\n        >\r\n          <div class=\"card-icon\">\r\n            <span v-if=\"item.type === 'success'\" class=\"icon-success\">‚úÖ</span>\r\n            <span v-else-if=\"item.type === 'error'\" class=\"icon-error\">‚ùå</span>\r\n            <span v-else class=\"icon-info\">üì¢</span>\r\n          </div>\r\n          <div class=\"card-content\">\r\n            <div class=\"card-header\">\r\n              <span class=\"card-title\">{{ item.title }}</span>\r\n              <span class=\"card-time\">{{ item.time }}</span>\r\n            </div>\r\n            <p class=\"card-message\">{{ item.message }}</p>\r\n          </div>\r\n          <div class=\"card-actions\" v-if=\"!item.read\">\r\n             <button @click=\"markAsRead(item)\" class=\"read-btn\" title=\"Ê†áËÆ∞‰∏∫Â∑≤ËØª\">\r\n               üîµ\r\n             </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <div v-else class=\"empty-state\">\r\n        <div class=\"empty-icon\">üì≠</div>\r\n        <h3>ÊöÇÊó†{{ currentTab === 'unread' ? 'Êú™ËØª' : '' }}Ê∂àÊÅØ</h3>\r\n        <p>ÂΩìÊúâÊñ∞ÁöÑÈÄöÁü•Êó∂Ôºå‰ºöÂá∫Áé∞Âú®ËøôÈáå</p>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport axios from 'axios';\r\nimport apiConfig from '@/config/api.config';\r\n\r\nexport default {\r\n  name: 'NotificationView',\r\n  data() {\r\n    return {\r\n      currentTab: 'all',\r\n      list: []\r\n    };\r\n  },\r\n  computed: {\r\n    filteredList() {\r\n      if (this.currentTab === 'unread') {\r\n        return this.list.filter(item => !item.read);\r\n      }\r\n      return this.list;\r\n    },\r\n    unreadCount() {\r\n      return this.list.filter(item => !item.read).length;\r\n    },\r\n    hasUnread() {\r\n      return this.unreadCount > 0;\r\n    }\r\n  },\r\n  mounted() {\r\n    this.fetchNotifications();\r\n  },\r\n  methods: {\r\n    fetchNotifications() {\r\n      // Ëé∑ÂèñÁî®Êà∑ID\r\n      const userInfoStr = localStorage.getItem('userInfo');\r\n      const userInfo = userInfoStr ? JSON.parse(userInfoStr) : {};\r\n      const uid = userInfo.uid || userInfo.id || localStorage.getItem('userId');\r\n\r\n      if (!uid) return;\r\n\r\n      // Ê£ÄÊü•Â≠¶ÁîüËÆ§ËØÅÁä∂ÊÄÅ\r\n      this.checkStudentStatus(uid);\r\n    },\r\n\r\n    checkStudentStatus(uid) {\r\n      const readStatus = localStorage.getItem('student_auth_read_status_v3');\r\n      \r\n      axios.get(apiConfig.student.getStatus(uid))\r\n        .then(res => {\r\n          if (res.data.code === 1 && res.data.data) {\r\n            const status = res.data.data.status;\r\n            // status: 1 (Approved), 2 (Rejected)\r\n            \r\n            if (status === 1 || status === 2) {\r\n              const isRead = String(readStatus) === String(status);\r\n              \r\n              // Ê®°ÊãüÊ∂àÊÅØÊï∞ÊçÆ\r\n              const notification = {\r\n                id: 'auth_' + status,\r\n                title: 'Â≠¶ÁîüËÆ§ËØÅÈÄöÁü•',\r\n                message: status === 1 \r\n                  ? 'ÊÅ≠ÂñúÊÇ®ÔºÅÊÇ®ÁöÑÂ≠¶ÁîüËÆ§ËØÅÁî≥ËØ∑Â∑≤ÈÄöËøáÂÆ°Ê†∏„ÄÇÊÇ®Áé∞Âú®ÂèØ‰ª•‰∫´ÂèóÂ≠¶Áîü‰∏ìÂ±û‰ºòÊÉ†‰∫ÜÔºÅ' \r\n                  : 'ÂæàÊä±Ê≠âÔºåÊÇ®ÁöÑÂ≠¶ÁîüËÆ§ËØÅÁî≥ËØ∑Êú™ÈÄöËøá„ÄÇËØ∑Ê£ÄÊü•‰ø°ÊÅØÂêéÈáçÊñ∞Êèê‰∫§„ÄÇ',\r\n                time: new Date().toLocaleString(), // ÂÆûÈôÖÂ∫î‰ΩøÁî®ÂêéÁ´ØÊó∂Èó¥\r\n                type: status === 1 ? 'success' : 'error',\r\n                read: isRead,\r\n                rawStatus: status\r\n              };\r\n\r\n              this.list = [notification];\r\n            }\r\n          }\r\n        })\r\n        .catch(console.error);\r\n    },\r\n\r\n    markAsRead(item) {\r\n      item.read = true;\r\n      if (item.rawStatus) {\r\n        localStorage.setItem('student_auth_read_status_v3', item.rawStatus);\r\n      }\r\n      // Ëß¶ÂèëApp.vueÊõ¥Êñ∞Á∫¢ÁÇπ\r\n      window.dispatchEvent(new Event('login-status-changed'));\r\n    },\r\n\r\n    markAllAsRead() {\r\n      this.list.forEach(item => {\r\n        if (!item.read) {\r\n          this.markAsRead(item);\r\n        }\r\n      });\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.notification-page {\r\n  min-height: 80vh;\r\n  background: #f5f7fa;\r\n  padding: 40px 20px;\r\n}\r\n\r\n.page-container {\r\n  max-width: 800px;\r\n  margin: 0 auto;\r\n  background: white;\r\n  border-radius: 8px;\r\n  box-shadow: 0 2px 12px rgba(0,0,0,0.1);\r\n  overflow: hidden;\r\n}\r\n\r\n.page-header {\r\n  padding: 20px 30px;\r\n  border-bottom: 1px solid #eee;\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n}\r\n\r\n.page-header h1 {\r\n  margin: 0;\r\n  font-size: 24px;\r\n  color: #333;\r\n}\r\n\r\n.mark-read-btn {\r\n  background: white;\r\n  border: 1px solid #dcdfe6;\r\n  color: #606266;\r\n  padding: 8px 16px;\r\n  border-radius: 4px;\r\n  cursor: pointer;\r\n  font-size: 14px;\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 5px;\r\n  transition: all 0.3s;\r\n}\r\n\r\n.mark-read-btn:hover:not(:disabled) {\r\n  color: #409eff;\r\n  border-color: #c6e2ff;\r\n  background-color: #ecf5ff;\r\n}\r\n\r\n.mark-read-btn:disabled {\r\n  cursor: not-allowed;\r\n  opacity: 0.6;\r\n}\r\n\r\n.notification-tabs {\r\n  padding: 0 30px;\r\n  border-bottom: 1px solid #eee;\r\n  display: flex;\r\n  gap: 20px;\r\n}\r\n\r\n.tab-btn {\r\n  padding: 15px 0;\r\n  background: none;\r\n  border: none;\r\n  font-size: 16px;\r\n  color: #606266;\r\n  cursor: pointer;\r\n  position: relative;\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 6px;\r\n}\r\n\r\n.tab-btn.active {\r\n  color: #409eff;\r\n  font-weight: 500;\r\n}\r\n\r\n.tab-btn.active::after {\r\n  content: '';\r\n  position: absolute;\r\n  bottom: 0;\r\n  left: 0;\r\n  width: 100%;\r\n  height: 2px;\r\n  background: #409eff;\r\n}\r\n\r\n.badge {\r\n  background: #f56c6c;\r\n  color: white;\r\n  font-size: 12px;\r\n  padding: 0 6px;\r\n  border-radius: 10px;\r\n  line-height: 18px;\r\n}\r\n\r\n.notification-list {\r\n  padding: 20px;\r\n}\r\n\r\n.notification-card {\r\n  display: flex;\r\n  gap: 20px;\r\n  padding: 20px;\r\n  border-bottom: 1px solid #f0f0f0;\r\n  transition: background 0.3s;\r\n  border-radius: 4px;\r\n}\r\n\r\n.notification-card:hover {\r\n  background: #f9fafc;\r\n}\r\n\r\n.notification-card.unread {\r\n  background: #ecf5ff;\r\n}\r\n\r\n.card-icon {\r\n  font-size: 24px;\r\n  padding-top: 2px;\r\n}\r\n\r\n.card-content {\r\n  flex: 1;\r\n}\r\n\r\n.card-header {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  margin-bottom: 8px;\r\n}\r\n\r\n.card-title {\r\n  font-weight: bold;\r\n  color: #303133;\r\n  font-size: 16px;\r\n}\r\n\r\n.card-time {\r\n  color: #909399;\r\n  font-size: 14px;\r\n}\r\n\r\n.card-message {\r\n  margin: 0;\r\n  color: #606266;\r\n  line-height: 1.5;\r\n}\r\n\r\n.read-btn {\r\n  background: none;\r\n  border: none;\r\n  cursor: pointer;\r\n  font-size: 12px;\r\n  opacity: 0.6;\r\n  transition: opacity 0.3s;\r\n}\r\n\r\n.read-btn:hover {\r\n  opacity: 1;\r\n}\r\n\r\n.empty-state {\r\n  padding: 60px 0;\r\n  text-align: center;\r\n  color: #909399;\r\n}\r\n\r\n.empty-icon {\r\n  font-size: 48px;\r\n  margin-bottom: 20px;\r\n}\r\n\r\n.empty-state h3 {\r\n  margin: 0 0 10px 0;\r\n  font-weight: normal;\r\n  color: #606266;\r\n}\r\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}