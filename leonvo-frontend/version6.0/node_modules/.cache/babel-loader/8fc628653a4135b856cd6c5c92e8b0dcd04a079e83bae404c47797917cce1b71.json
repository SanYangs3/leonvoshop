{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.filter.js\";\nimport \"core-js/modules/es.iterator.for-each.js\";\nimport \"core-js/modules/es.iterator.map.js\";\nimport \"core-js/modules/es.iterator.reduce.js\";\nimport \"core-js/modules/esnext.json.parse.js\";\nimport { Chart, registerables } from 'chart.js';\nimport axios from 'axios';\nimport apiConfig from '@/config/api.config';\nChart.register(...registerables);\nexport default {\n  name: 'BusinessDashboard',\n  data() {\n    return {\n      loading: true,\n      salesRange: 'week',\n      dashboardData: {\n        totalSales: 0,\n        todaySales: 0,\n        activeProducts: 0,\n        pendingOrders: 0\n      },\n      salesChart: null,\n      topProducts: [],\n      recentOrders: []\n    };\n  },\n  mounted() {\n    this.loadDashboardData();\n  },\n  beforeDestroy() {\n    if (this.salesChart) {\n      this.salesChart.destroy();\n    }\n  },\n  methods: {\n    formatNumber(num) {\n      if (!num) return '0';\n      if (num >= 10000) {\n        return (num / 10000).toFixed(1) + 'ä¸‡';\n      }\n      return num.toLocaleString();\n    },\n    formatTime(time) {\n      if (!time) return '';\n      try {\n        const date = new Date(time);\n        return date.toLocaleDateString('zh-CN', {\n          month: '2-digit',\n          day: '2-digit',\n          hour: '2-digit',\n          minute: '2-digit'\n        });\n      } catch (e) {\n        return time;\n      }\n    },\n    getOrderStatusClass(status) {\n      const statusMap = {\n        0: 'pending',\n        1: 'shipped',\n        2: 'completed',\n        3: 'cancelled',\n        4: 'cancelled'\n      };\n      return statusMap[status] || 'pending';\n    },\n    getOrderStatusText(status) {\n      const statusMap = {\n        0: 'å¾…å‘è´§',\n        1: 'å·²å‘è´§',\n        2: 'å·²å®Œæˆ',\n        3: 'å·²å–æ¶ˆ',\n        4: 'å·²å–æ¶ˆ'\n      };\n      return statusMap[status] || 'æœªçŸ¥çŠ¶æ€';\n    },\n    async loadDashboardData() {\n      this.loading = true;\n      const businessInfo = JSON.parse(localStorage.getItem('businessInfo'));\n      const bid = businessInfo?.bid || businessInfo?.id;\n      if (!bid) {\n        console.error('æœªæ‰¾åˆ°å•†å®¶ä¿¡æ¯');\n        this.$router.push('/business/login');\n        return;\n      }\n      try {\n        // 1. è·å–å•†å“æ•°æ® - ä½¿ç”¨api.config.jsä¸­çš„é…ç½®\n        const productsResponse = await axios.get(apiConfig.business.getProducts(bid));\n        let products = [];\n        if (productsResponse.data.code === 1) {\n          products = productsResponse.data.data || [];\n        }\n\n        // 2. è·å–è®¢å•æ•°æ® - ä½¿ç”¨api.config.jsä¸­çš„é…ç½®\n        const ordersResponse = await axios.get(apiConfig.business.getOrders(bid));\n        let orders = [];\n        if (ordersResponse.data.code === 1) {\n          orders = ordersResponse.data.data || [];\n        }\n\n        // 2.1 å»ºç«‹å•†å“IDå’Œåç§°æ˜ å°„è¡¨\n        const productMap = {};\n        const nameToPidMap = {}; // æ–°å¢ï¼šåç§°åˆ°PIDçš„æ˜ å°„\n        products.forEach(p => {\n          if (p.pid) {\n            productMap[p.pid] = p;\n            if (p.name) nameToPidMap[p.name] = p.pid;\n          }\n        });\n\n        // 2.2 å‡†å¤‡è¡¥å…¨è®¢å•ä¿¡æ¯çš„é€»è¾‘\n        const detailPromises = [];\n\n        // å…ˆæ‰«æä¸€éï¼Œæ‰¾å‡ºéœ€è¦è¡¥å…¨è¯¦æƒ…çš„è®¢å•\n        orders.forEach(order => {\n          let hasValidInfo = false;\n\n          // æ£€æŸ¥æ˜¯å¦æœ‰æœ‰æ•ˆçš„å•†å“ä¿¡æ¯\n          if (order.items && Array.isArray(order.items) && order.items.length > 0) {\n            // åªè¦æœ‰ä¸€ä¸ªå•†å“æœ‰åå­—ä¸”ä¸æ˜¯å ä½ç¬¦ï¼Œå°±è®¤ä¸ºæœ‰æ•ˆ\n            const firstItem = order.items[0];\n            if (firstItem.name && firstItem.name !== 'å•†å“' && firstItem.name !== 'é»˜è®¤å•†å“' && firstItem.name !== 'æœªçŸ¥å•†å“') {\n              hasValidInfo = true;\n            }\n          } else if (order.product_name || order.productName) {\n            hasValidInfo = true;\n          }\n\n          // å¦‚æœä¿¡æ¯ä¸å…¨ï¼Œä¸”æœ‰OIDï¼ŒåŠ å…¥è¡¥å…¨é˜Ÿåˆ—\n          if (!hasValidInfo && (order.oid || order.id)) {\n            const oid = order.oid || order.id;\n            // å°è¯•ä»æœ¬åœ° productMap åæŸ¥ (å¦‚æœæœ‰ pid)\n            let foundInLocal = false;\n            if ((order.pid || order.productId) && productMap[order.pid || order.productId]) {\n              // å¦‚æœæœ¬åœ°æœ‰ï¼Œç›´æ¥è¡¥å…¨ï¼Œä¸ç”¨è¯·æ±‚æ¥å£\n              const p = productMap[order.pid || order.productId];\n              if (!order.items || !order.items.length) {\n                order.items = [{\n                  name: p.name,\n                  quantity: order.quantity || 1,\n                  pid: p.pid\n                }];\n              } else {\n                order.items[0].name = p.name;\n                order.items[0].pid = p.pid;\n              }\n              order.productName = p.name;\n              foundInLocal = true;\n            }\n\n            // å¦‚æœæœ¬åœ°ä¹Ÿæ²¡æ‰¾åˆ°ï¼Œè¯·æ±‚è¯¦æƒ…æ¥å£\n            if (!foundInLocal) {\n              detailPromises.push(axios.get(apiConfig.order.getOrderDetail(oid)).then(res => {\n                if (res.data.code === 1 && res.data.data) {\n                  const detail = res.data.data;\n                  // æå–å•†å“åå’ŒID\n                  let name = '';\n                  let pid = '';\n                  let price = 0;\n                  if (detail.items && detail.items.length) {\n                    name = detail.items[0].name;\n                    pid = detail.items[0].id || detail.items[0].pid;\n                    price = detail.items[0].price;\n                  } else if (detail.product_name) {\n                    name = detail.product_name;\n                  }\n                  if (name) {\n                    // æ›´æ–°è®¢å•å¯¹è±¡\n                    order.productName = name;\n                    if (!order.items || !order.items.length) {\n                      order.items = [{\n                        name: name,\n                        quantity: 1,\n                        pid: pid,\n                        price: price\n                      }];\n                    } else {\n                      order.items[0].name = name;\n                      if (pid) order.items[0].pid = pid;\n                      if (price) order.items[0].price = price;\n                    }\n                  }\n                }\n              }).catch(e => console.warn(`è¡¥å…¨è®¢å• ${oid} è¯¦æƒ…å¤±è´¥`, e)));\n            }\n          }\n        });\n\n        // ç­‰å¾…æ‰€æœ‰è¯¦æƒ…è¡¥å…¨å®Œæˆ\n        if (detailPromises.length > 0) {\n          console.log(`æ­£åœ¨è¡¥å…¨ ${detailPromises.length} ä¸ªè®¢å•çš„å•†å“ä¿¡æ¯...`);\n          await Promise.allSettled(detailPromises);\n          console.log('è®¢å•ä¿¡æ¯è¡¥å…¨å®Œæˆï¼Œå¼€å§‹è®¡ç®—é”€é‡');\n        }\n\n        // 2.3 è®¡ç®—æ¯ä¸ªå•†å“çš„é”€é‡ (ç¡®ä¿åœ¨è¡¥å…¨åæ‰§è¡Œ)\n        const salesMap = {};\n        orders.forEach(order => {\n          // å½’ä¸€åŒ–å¤„ç† items\n          let items = [];\n          if (order.items && Array.isArray(order.items)) {\n            items = order.items;\n          } else if (order.products && Array.isArray(order.products)) {\n            items = order.products;\n          } else if (order.pid || order.productName) {\n            // å•å•†å“ç»“æ„\n            items = [{\n              pid: order.pid,\n              name: order.productName,\n              quantity: order.quantity || 1\n            }];\n          }\n          items.forEach(item => {\n            const qty = parseInt(item.quantity || item.count || 1);\n\n            // 1. ä¼˜å…ˆä½¿ç”¨ PID åŒ¹é…\n            if (item.pid || item.id) {\n              const pidStr = String(item.pid || item.id);\n              salesMap[pidStr] = (salesMap[pidStr] || 0) + qty;\n            }\n            // 2. å…¶æ¬¡ä½¿ç”¨åç§°åŒ¹é… (å»é™¤ç©ºæ ¼ï¼Œå¿½ç•¥å¤§å°å†™)\n            else if (item.name) {\n              const cleanName = item.name.trim();\n              // å°è¯•ä» nameToPidMap æ‰¾ ID\n              if (nameToPidMap[cleanName]) {\n                const pidStr = String(nameToPidMap[cleanName]);\n                salesMap[pidStr] = (salesMap[pidStr] || 0) + qty;\n              } else {\n                // æ‰¾ä¸åˆ° ID å°±ç›´æ¥å­˜åå­—\n                salesMap[cleanName] = (salesMap[cleanName] || 0) + qty;\n              }\n            }\n          });\n        });\n        console.log('é”€é‡ç»Ÿè®¡ç»“æœ:', salesMap);\n\n        // å°†é”€é‡åˆå¹¶åˆ°å•†å“æ•°æ®ä¸­\n        products = products.map(p => {\n          const pidStr = String(p.pid);\n          // å°è¯•é€šè¿‡ ID è·å–\n          let totalSales = salesMap[pidStr] || 0;\n\n          // å°è¯•é€šè¿‡åç§°è·å– (é˜²æ­¢ ID ä¸åŒ¹é…çš„æƒ…å†µ)\n          if (p.name) {\n            totalSales += salesMap[p.name.trim()] || 0;\n          }\n          return {\n            ...p,\n            sales_count: totalSales || p.sales_count || 0\n          };\n        });\n\n        // 3. è®¡ç®—ç»Ÿè®¡ä¿¡æ¯\n        const totalSales = orders.reduce((sum, order) => sum + (order.amount || 0), 0);\n\n        // è®¡ç®—ä»Šæ—¥é”€å”®é¢\n        const today = new Date();\n        // Fix: Use local date string to match order dates correctly in local timezone\n        const todayStr = today.toLocaleDateString('zh-CN', {\n          year: 'numeric',\n          month: '2-digit',\n          day: '2-digit'\n        }).replace(/\\//g, '-');\n        const todaySales = orders.filter(order => {\n          const orderTime = order.order_time || order.orderTime;\n          if (!orderTime) return false;\n          const orderDate = new Date(orderTime);\n          const orderDateStr = orderDate.toLocaleDateString('zh-CN', {\n            year: 'numeric',\n            month: '2-digit',\n            day: '2-digit'\n          }).replace(/\\//g, '-');\n          return orderDateStr === todayStr;\n        }).reduce((sum, order) => sum + (order.amount || 0), 0);\n        const activeProducts = products.filter(p => p.status === 1).length;\n        const pendingOrders = orders.filter(order => order.status === 0).length;\n        this.dashboardData = {\n          totalSales,\n          todaySales,\n          activeProducts,\n          pendingOrders\n        };\n\n        // 5. è·å–çƒ­é—¨å•†å“ (æŒ‰é”€å”®é¢æ’åº: é”€é‡ * ä»·æ ¼)\n        this.topProducts = products\n        // .filter(p => p.status === 1) // ç”¨æˆ·å¸Œæœ›èƒ½çœ‹åˆ°æ‰€æœ‰çƒ­é—¨å•†å“ï¼Œå³ä½¿å·²ä¸‹æ¶\n        .sort((a, b) => {\n          const revenueA = (a.sales_count || 0) * (a.price || 0);\n          const revenueB = (b.sales_count || 0) * (b.price || 0);\n          return revenueB - revenueA;\n        }).slice(0, 4).map(p => ({\n          pid: p.pid,\n          name: p.name,\n          sales_count: p.sales_count || 0,\n          price: p.price || 0\n        }));\n\n        // 6. è·å–æœ€è¿‘è®¢å•\n        this.recentOrders = orders.sort((a, b) => {\n          const timeA = new Date(a.order_time || a.orderTime);\n          const timeB = new Date(b.order_time || b.orderTime);\n          return timeB - timeA;\n        }).slice(0, 5).map(order => {\n          // å°è¯•ä»ä¸åŒå­—æ®µè·å–å•†å“åˆ—è¡¨\n          let items = [];\n          if (order.items && order.items.length) items = order.items;else if (order.products && order.products.length) items = order.products;else if (order.orderItems && order.orderItems.length) items = order.orderItems;else if (order.order_items && order.order_items.length) items = order.order_items;else if (order.goods && order.goods.length) items = order.goods;else if (order.product) items = [order.product];\n\n          // å¦‚æœè¿˜æ˜¯æ²¡æœ‰ï¼Œå°è¯•ä»æ‰å¹³å­—æ®µæ„å»º\n          if (items.length === 0) {\n            // ä¼˜å…ˆä½¿ç”¨ PID åæŸ¥\n            if ((order.pid || order.productId) && productMap[order.pid || order.productId]) {\n              const product = productMap[order.pid || order.productId];\n              items = [{\n                name: product.name,\n                quantity: order.quantity || order.count || 1,\n                pid: product.pid\n              }];\n            }\n            // å…¶æ¬¡å°è¯•ä½¿ç”¨åç§°å­—æ®µ\n            else if (order.product_name || order.productName) {\n              items = [{\n                name: order.product_name || order.productName,\n                quantity: order.quantity || order.count || 1\n              }];\n            }\n          }\n          return {\n            oid: order.oid || order.id,\n            amount: order.amount || 0,\n            status: order.status || 0,\n            order_time: order.order_time || order.orderTime,\n            items: items.length ? items : [{\n              name: 'å•†å“',\n              quantity: 1\n            }]\n          };\n        });\n\n        // 4. è·å–è®¢å•è¶‹åŠ¿ (æ”¾åœ¨æœ€åæ¸²æŸ“ï¼Œç¡®ä¿DOMå‡†å¤‡å°±ç»ª)\n        // å¿…é¡»å…ˆç»“æŸloadingçŠ¶æ€ï¼Œè®©v-elseæ˜¾ç¤ºå‡ºæ¥ï¼Œæ‰èƒ½è·å–canvas context\n        this.loading = false;\n        this.$nextTick(() => {\n          const trendData = this.calculateOrderTrend(orders, this.salesRange);\n          this.renderSalesChart(trendData);\n        });\n      } catch (error) {\n        console.error('åŠ è½½ä»ªè¡¨ç›˜æ•°æ®å¤±è´¥:', error);\n        this.useMockData();\n        this.loading = false;\n      }\n      // finally {\n      //   this.loading = false; // Moved inside try/catch to handle render timing\n      // }\n    },\n    calculateOrderTrend(orders, rangeType) {\n      const today = new Date();\n      let startDate = new Date(today);\n      let endDate = new Date(today);\n      let labels = [];\n      let data = [];\n      let tooltips = []; // To store date and count for tooltip\n\n      if (rangeType === 'week') {\n        // Current Week (Monday to Sunday)\n        const day = startDate.getDay() || 7; // Get current day number, make Sunday 7\n        if (day !== 1) startDate.setHours(-24 * (day - 1)); // Go back to Monday\n        else startDate.setHours(0, 0, 0, 0);\n\n        // Generate labels for Mon-Sun\n        for (let i = 0; i < 7; i++) {\n          const d = new Date(startDate);\n          d.setDate(startDate.getDate() + i);\n          // Only up to today? User said \"Current week\", usually implies whole week view, but future days are 0\n          labels.push(d.toLocaleDateString('zh-CN', {\n            month: 'numeric',\n            day: 'numeric'\n          }));\n          const dateStr = d.toLocaleDateString('zh-CN', {\n            year: 'numeric',\n            month: '2-digit',\n            day: '2-digit'\n          }).replace(/\\//g, '-');\n          const count = orders.filter(o => {\n            const oTime = o.order_time || o.orderTime;\n            if (!oTime) return false;\n            const oDate = new Date(oTime);\n            const oDateStr = oDate.toLocaleDateString('zh-CN', {\n              year: 'numeric',\n              month: '2-digit',\n              day: '2-digit'\n            }).replace(/\\//g, '-');\n            return oDateStr === dateStr;\n          }).length;\n          data.push(count);\n          tooltips.push({\n            date: dateStr,\n            count: count\n          });\n        }\n      } else {\n        // Current Month\n        startDate.setDate(1); // 1st of month\n        const daysInMonth = new Date(today.getFullYear(), today.getMonth() + 1, 0).getDate();\n        for (let i = 1; i <= daysInMonth; i++) {\n          const d = new Date(today.getFullYear(), today.getMonth(), i);\n          labels.push(d.toLocaleDateString('zh-CN', {\n            month: 'numeric',\n            day: 'numeric'\n          }));\n          const dateStr = d.toLocaleDateString('zh-CN', {\n            year: 'numeric',\n            month: '2-digit',\n            day: '2-digit'\n          }).replace(/\\//g, '-');\n          const count = orders.filter(o => {\n            const oTime = o.order_time || o.orderTime;\n            if (!oTime) return false;\n            const oDate = new Date(oTime);\n            const oDateStr = oDate.toLocaleDateString('zh-CN', {\n              year: 'numeric',\n              month: '2-digit',\n              day: '2-digit'\n            }).replace(/\\//g, '-');\n            return oDateStr === dateStr;\n          }).length;\n          data.push(count);\n          tooltips.push({\n            date: dateStr,\n            count: count\n          });\n        }\n      }\n      return {\n        labels,\n        values: data,\n        tooltips\n      };\n    },\n    renderSalesChart(data) {\n      const ctx = this.$refs.salesChart;\n      if (!ctx) return;\n      if (this.salesChart) {\n        this.salesChart.destroy();\n      }\n      this.salesChart = new Chart(ctx, {\n        type: 'line',\n        data: {\n          labels: data.labels,\n          datasets: [{\n            label: 'è®¢å•æ•°',\n            data: data.values,\n            borderColor: '#3b82f6',\n            // Blue like the image\n            backgroundColor: context => {\n              const ctx = context.chart.ctx;\n              const gradient = ctx.createLinearGradient(0, 0, 0, 300);\n              gradient.addColorStop(0, 'rgba(59, 130, 246, 0.5)');\n              gradient.addColorStop(1, 'rgba(59, 130, 246, 0.0)');\n              return gradient;\n            },\n            borderWidth: 3,\n            fill: true,\n            tension: 0.4,\n            // Smooth curve\n            pointBackgroundColor: '#ffffff',\n            pointBorderColor: '#3b82f6',\n            pointBorderWidth: 2,\n            pointRadius: 4,\n            pointHoverRadius: 6\n          }]\n        },\n        options: {\n          responsive: true,\n          maintainAspectRatio: false,\n          interaction: {\n            intersect: false,\n            mode: 'index'\n          },\n          plugins: {\n            legend: {\n              display: false\n            },\n            tooltip: {\n              backgroundColor: '#3b82f6',\n              titleColor: '#fff',\n              bodyColor: '#fff',\n              displayColors: false,\n              callbacks: {\n                title: context => {\n                  return data.tooltips[context[0].dataIndex].date;\n                },\n                label: context => {\n                  return context.parsed.y + ' å•';\n                }\n              }\n            }\n          },\n          scales: {\n            y: {\n              beginAtZero: true,\n              grid: {\n                color: 'rgba(0, 0, 0, 0.05)',\n                drawBorder: false\n              },\n              ticks: {\n                stepSize: 1\n              }\n            },\n            x: {\n              grid: {\n                display: false,\n                drawBorder: false\n              }\n            }\n          }\n        }\n      });\n    },\n    getMockTrendData(days) {\n      const labels = [];\n      const sales = [];\n      for (let i = days - 1; i >= 0; i--) {\n        const date = new Date();\n        date.setDate(date.getDate() - i);\n        labels.push(`${date.getMonth() + 1}/${date.getDate()}`);\n        sales.push(Math.floor(Math.random() * 5000) + 1000);\n      }\n      return {\n        labels,\n        sales\n      };\n    },\n    useMockData() {\n      // åªæœ‰åœ¨APIè°ƒç”¨å¤±è´¥æ—¶ä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®\n      this.dashboardData = {\n        totalSales: 0,\n        todaySales: 0,\n        activeProducts: 0,\n        pendingOrders: 0\n      };\n      this.topProducts = [];\n      this.recentOrders = [];\n      this.$nextTick(() => {\n        this.renderSalesChart({\n          labels: ['å‘¨ä¸€', 'å‘¨äºŒ', 'å‘¨ä¸‰', 'å‘¨å››', 'å‘¨äº”', 'å‘¨å…­', 'å‘¨æ—¥'],\n          values: [0, 0, 0, 0, 0, 0, 0]\n        });\n      });\n    },\n    goToOrders() {\n      this.$router.push('/business/orders');\n    }\n  },\n  watch: {\n    salesRange() {\n      this.loadDashboardData();\n    }\n  }\n};","map":{"version":3,"names":["Chart","registerables","axios","apiConfig","register","name","data","loading","salesRange","dashboardData","totalSales","todaySales","activeProducts","pendingOrders","salesChart","topProducts","recentOrders","mounted","loadDashboardData","beforeDestroy","destroy","methods","formatNumber","num","toFixed","toLocaleString","formatTime","time","date","Date","toLocaleDateString","month","day","hour","minute","e","getOrderStatusClass","status","statusMap","getOrderStatusText","businessInfo","JSON","parse","localStorage","getItem","bid","id","console","error","$router","push","productsResponse","get","business","getProducts","products","code","ordersResponse","getOrders","orders","productMap","nameToPidMap","forEach","p","pid","detailPromises","order","hasValidInfo","items","Array","isArray","length","firstItem","product_name","productName","oid","foundInLocal","productId","quantity","getOrderDetail","then","res","detail","price","catch","warn","log","Promise","allSettled","salesMap","item","qty","parseInt","count","pidStr","String","cleanName","trim","map","sales_count","reduce","sum","amount","today","todayStr","year","replace","filter","orderTime","order_time","orderDate","orderDateStr","sort","a","b","revenueA","revenueB","slice","timeA","timeB","orderItems","order_items","goods","product","$nextTick","trendData","calculateOrderTrend","renderSalesChart","useMockData","rangeType","startDate","endDate","labels","tooltips","getDay","setHours","i","d","setDate","getDate","dateStr","o","oTime","oDate","oDateStr","daysInMonth","getFullYear","getMonth","values","ctx","$refs","type","datasets","label","borderColor","backgroundColor","context","chart","gradient","createLinearGradient","addColorStop","borderWidth","fill","tension","pointBackgroundColor","pointBorderColor","pointBorderWidth","pointRadius","pointHoverRadius","options","responsive","maintainAspectRatio","interaction","intersect","mode","plugins","legend","display","tooltip","titleColor","bodyColor","displayColors","callbacks","title","dataIndex","parsed","y","scales","beginAtZero","grid","color","drawBorder","ticks","stepSize","x","getMockTrendData","days","sales","Math","floor","random","goToOrders","watch"],"sources":["D:\\1_homework_file\\å¤§ä¸‰ä¸Š\\è½¯ä»¶å·¥ç¨‹\\é¡¹ç›®ç•™æ¡£\\1å‰ç«¯å¼€å‘_æˆ‘æ‰æ˜¯çœŸçš„\\version5.0\\src\\views\\business\\BusinessDashboard.vue"],"sourcesContent":["<template>\r\n  <div class=\"business-dashboard\">\r\n    <!-- ç»Ÿè®¡å¡ç‰‡ -->\r\n    <div class=\"stats-grid\">\r\n      <!-- æ€»é”€å”®é¢ -->\r\n      <div class=\"stat-card\">\r\n        <div class=\"stat-icon sales\">\r\n          <span>ğŸ’°</span>\r\n        </div>\r\n        <div class=\"stat-content\">\r\n          <div class=\"stat-value\">Â¥{{ formatNumber(dashboardData.totalSales) }}</div>\r\n          <div class=\"stat-label\">æ€»é”€å”®é¢</div>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- ä»Šæ—¥é”€å”®é¢ -->\r\n      <div class=\"stat-card\">\r\n        <div class=\"stat-icon today-sales\">\r\n          <span>ğŸ“ˆ</span>\r\n        </div>\r\n        <div class=\"stat-content\">\r\n          <div class=\"stat-value\">Â¥{{ formatNumber(dashboardData.todaySales) }}</div>\r\n          <div class=\"stat-label\">ä»Šæ—¥é”€å”®é¢</div>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- åœ¨å”®å•†å“ -->\r\n      <div class=\"stat-card\">\r\n        <div class=\"stat-icon products\">\r\n          <span>ğŸ“¦</span>\r\n        </div>\r\n        <div class=\"stat-content\">\r\n          <div class=\"stat-value\">{{ dashboardData.activeProducts }}</div>\r\n          <div class=\"stat-label\">åœ¨å”®å•†å“</div>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- å¾…å¤„ç†è®¢å• -->\r\n      <div class=\"stat-card\">\r\n        <div class=\"stat-icon orders\">\r\n          <span>ğŸ“‹</span>\r\n        </div>\r\n        <div class=\"stat-content\">\r\n          <div class=\"stat-value\">{{ dashboardData.pendingOrders }}</div>\r\n          <div class=\"stat-label\">å¾…å¤„ç†è®¢å•</div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- å›¾è¡¨åŒºåŸŸ -->\r\n    <div class=\"chart-area\">\r\n      <div class=\"chart-card\">\r\n        <div class=\"chart-header\">\r\n          <h3>è¿‘7æ—¥é”€å”®è¶‹åŠ¿</h3>\r\n          <select v-model=\"salesRange\" class=\"time-select\">\r\n            <option value=\"7\">è¿‘7å¤©</option>\r\n            <option value=\"30\">è¿‘30å¤©</option>\r\n          </select>\r\n        </div>\r\n        <div class=\"chart-container\">\r\n          <div v-if=\"loading\" class=\"loading-chart\">\r\n            åŠ è½½ä¸­...\r\n          </div>\r\n          <div v-else class=\"sales-chart\">\r\n            <canvas ref=\"salesChart\"></canvas>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <div class=\"chart-card\">\r\n        <div class=\"chart-header\">\r\n          <h3>çƒ­é—¨å•†å“</h3>\r\n        </div>\r\n        <div class=\"chart-container\">\r\n          <div v-if=\"loading\" class=\"loading-chart\">\r\n            åŠ è½½ä¸­...\r\n          </div>\r\n          <div v-else class=\"products-list\">\r\n            <div v-for=\"product in topProducts\" :key=\"product.pid\" class=\"product-item\">\r\n              <div class=\"product-icon\">ğŸ’»</div>\r\n              <div class=\"product-info\">\r\n                <div class=\"product-name\">{{ product.name }}</div>\r\n                <!-- <div class=\"product-sales\">é”€é‡: {{ product.sales_count || 0 }}ä»¶</div> -->\r\n              </div>\r\n              <div class=\"product-amount\">Â¥{{ product.price }}</div>\r\n            </div>\r\n            <div v-if=\"topProducts.length === 0\" class=\"empty-products\">\r\n              æš‚æ— é”€å”®æ•°æ®\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- æœ€è¿‘è®¢å• -->\r\n    <div class=\"recent-orders\">\r\n      <div class=\"section-header\">\r\n        <h3>æœ€è¿‘è®¢å•</h3>\r\n        <button class=\"view-all-btn\" @click=\"goToOrders\">æŸ¥çœ‹å…¨éƒ¨</button>\r\n      </div>\r\n      <div class=\"orders-table\">\r\n        <table>\r\n          <thead>\r\n          <tr>\r\n            <th>è®¢å•å·</th>\r\n            <th>å•†å“</th>\r\n            <th>é‡‘é¢</th>\r\n            <th>çŠ¶æ€</th>\r\n            <th>æ—¶é—´</th>\r\n          </tr>\r\n          </thead>\r\n          <tbody>\r\n          <tr v-for=\"order in recentOrders\" :key=\"order.oid\">\r\n            <td>#{{ order.oid }}</td>\r\n            <td>\r\n              <div class=\"order-product\">\r\n                {{ (order.items && order.items[0]) ? order.items[0].name : 'å•†å“' }}\r\n                <span v-if=\"order.items && order.items[0] && order.items[0].quantity > 1\" class=\"quantity\">Ã—{{ order.items[0].quantity }}</span>\r\n              </div>\r\n            </td>\r\n            <td>Â¥{{ order.amount }}</td>\r\n            <td>\r\n                <span :class=\"['status-badge', getOrderStatusClass(order.status)]\">\r\n                  {{ getOrderStatusText(order.status) }}\r\n                </span>\r\n            </td>\r\n            <td>{{ formatTime(order.order_time) }}</td>\r\n          </tr>\r\n          <tr v-if=\"recentOrders.length === 0\">\r\n            <td colspan=\"5\" class=\"no-orders\">æš‚æ— è®¢å•</td>\r\n          </tr>\r\n          </tbody>\r\n        </table>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { Chart, registerables } from 'chart.js';\r\nimport axios from 'axios';\r\nimport apiConfig from '@/config/api.config';\r\n\r\nChart.register(...registerables);\r\n\r\nexport default {\r\n  name: 'BusinessDashboard',\r\n  data() {\r\n    return {\r\n      loading: true,\r\n      salesRange: 'week',\r\n      dashboardData: {\r\n        totalSales: 0,\r\n        todaySales: 0,\r\n        activeProducts: 0,\r\n        pendingOrders: 0\r\n      },\r\n      salesChart: null,\r\n      topProducts: [],\r\n      recentOrders: []\r\n    }\r\n  },\r\n  mounted() {\r\n    this.loadDashboardData();\r\n  },\r\n  beforeDestroy() {\r\n    if (this.salesChart) {\r\n      this.salesChart.destroy();\r\n    }\r\n  },\r\n  methods: {\r\n    formatNumber(num) {\r\n      if (!num) return '0';\r\n      if (num >= 10000) {\r\n        return (num / 10000).toFixed(1) + 'ä¸‡';\r\n      }\r\n      return num.toLocaleString();\r\n    },\r\n\r\n    formatTime(time) {\r\n      if (!time) return '';\r\n      try {\r\n        const date = new Date(time);\r\n        return date.toLocaleDateString('zh-CN', {\r\n          month: '2-digit',\r\n          day: '2-digit',\r\n          hour: '2-digit',\r\n          minute: '2-digit'\r\n        });\r\n      } catch (e) {\r\n        return time;\r\n      }\r\n    },\r\n\r\n    getOrderStatusClass(status) {\r\n      const statusMap = {\r\n        0: 'pending',\r\n        1: 'shipped',\r\n        2: 'completed',\r\n        3: 'cancelled',\r\n        4: 'cancelled'\r\n      };\r\n      return statusMap[status] || 'pending';\r\n    },\r\n\r\n    getOrderStatusText(status) {\r\n      const statusMap = {\r\n        0: 'å¾…å‘è´§',\r\n        1: 'å·²å‘è´§',\r\n        2: 'å·²å®Œæˆ',\r\n        3: 'å·²å–æ¶ˆ',\r\n        4: 'å·²å–æ¶ˆ'\r\n      };\r\n      return statusMap[status] || 'æœªçŸ¥çŠ¶æ€';\r\n    },\r\n\r\n    async loadDashboardData() {\r\n      this.loading = true;\r\n      const businessInfo = JSON.parse(localStorage.getItem('businessInfo'));\r\n      const bid = businessInfo?.bid || businessInfo?.id;\r\n\r\n      if (!bid) {\r\n        console.error('æœªæ‰¾åˆ°å•†å®¶ä¿¡æ¯');\r\n        this.$router.push('/business/login');\r\n        return;\r\n      }\r\n\r\n      try {\r\n        // 1. è·å–å•†å“æ•°æ® - ä½¿ç”¨api.config.jsä¸­çš„é…ç½®\r\n        const productsResponse = await axios.get(apiConfig.business.getProducts(bid));\r\n        let products = [];\r\n        if (productsResponse.data.code === 1) {\r\n          products = productsResponse.data.data || [];\r\n        }\r\n\r\n        // 2. è·å–è®¢å•æ•°æ® - ä½¿ç”¨api.config.jsä¸­çš„é…ç½®\r\n        const ordersResponse = await axios.get(apiConfig.business.getOrders(bid));\r\n        let orders = [];\r\n        if (ordersResponse.data.code === 1) {\r\n          orders = ordersResponse.data.data || [];\r\n        }\r\n\r\n        // 2.1 å»ºç«‹å•†å“IDå’Œåç§°æ˜ å°„è¡¨\r\n        const productMap = {};\r\n        const nameToPidMap = {}; // æ–°å¢ï¼šåç§°åˆ°PIDçš„æ˜ å°„\r\n        products.forEach(p => {\r\n            if (p.pid) {\r\n                productMap[p.pid] = p;\r\n                if (p.name) nameToPidMap[p.name] = p.pid;\r\n            }\r\n        });\r\n\r\n        // 2.2 å‡†å¤‡è¡¥å…¨è®¢å•ä¿¡æ¯çš„é€»è¾‘\r\n        const detailPromises = [];\r\n\r\n        // å…ˆæ‰«æä¸€éï¼Œæ‰¾å‡ºéœ€è¦è¡¥å…¨è¯¦æƒ…çš„è®¢å•\r\n        orders.forEach(order => {\r\n            let hasValidInfo = false;\r\n            \r\n            // æ£€æŸ¥æ˜¯å¦æœ‰æœ‰æ•ˆçš„å•†å“ä¿¡æ¯\r\n            if (order.items && Array.isArray(order.items) && order.items.length > 0) {\r\n                 // åªè¦æœ‰ä¸€ä¸ªå•†å“æœ‰åå­—ä¸”ä¸æ˜¯å ä½ç¬¦ï¼Œå°±è®¤ä¸ºæœ‰æ•ˆ\r\n                 const firstItem = order.items[0];\r\n                 if (firstItem.name && firstItem.name !== 'å•†å“' && firstItem.name !== 'é»˜è®¤å•†å“' && firstItem.name !== 'æœªçŸ¥å•†å“') {\r\n                     hasValidInfo = true;\r\n                 }\r\n            } else if (order.product_name || order.productName) {\r\n                hasValidInfo = true;\r\n            }\r\n            \r\n            // å¦‚æœä¿¡æ¯ä¸å…¨ï¼Œä¸”æœ‰OIDï¼ŒåŠ å…¥è¡¥å…¨é˜Ÿåˆ—\r\n            if (!hasValidInfo && (order.oid || order.id)) {\r\n                const oid = order.oid || order.id;\r\n                // å°è¯•ä»æœ¬åœ° productMap åæŸ¥ (å¦‚æœæœ‰ pid)\r\n                let foundInLocal = false;\r\n                if ((order.pid || order.productId) && productMap[order.pid || order.productId]) {\r\n                    // å¦‚æœæœ¬åœ°æœ‰ï¼Œç›´æ¥è¡¥å…¨ï¼Œä¸ç”¨è¯·æ±‚æ¥å£\r\n                    const p = productMap[order.pid || order.productId];\r\n                    if (!order.items || !order.items.length) {\r\n                        order.items = [{ name: p.name, quantity: order.quantity || 1, pid: p.pid }];\r\n                    } else {\r\n                        order.items[0].name = p.name;\r\n                        order.items[0].pid = p.pid;\r\n                    }\r\n                    order.productName = p.name;\r\n                    foundInLocal = true;\r\n                }\r\n                \r\n                // å¦‚æœæœ¬åœ°ä¹Ÿæ²¡æ‰¾åˆ°ï¼Œè¯·æ±‚è¯¦æƒ…æ¥å£\r\n                if (!foundInLocal) {\r\n                    detailPromises.push(\r\n                        axios.get(apiConfig.order.getOrderDetail(oid))\r\n                            .then(res => {\r\n                                if (res.data.code === 1 && res.data.data) {\r\n                                    const detail = res.data.data;\r\n                                    // æå–å•†å“åå’ŒID\r\n                                    let name = '';\r\n                                    let pid = '';\r\n                                    let price = 0;\r\n                                    \r\n                                    if (detail.items && detail.items.length) {\r\n                                        name = detail.items[0].name;\r\n                                        pid = detail.items[0].id || detail.items[0].pid;\r\n                                        price = detail.items[0].price;\r\n                                    } else if (detail.product_name) {\r\n                                        name = detail.product_name;\r\n                                    }\r\n                                    \r\n                                    if (name) {\r\n                                        // æ›´æ–°è®¢å•å¯¹è±¡\r\n                                        order.productName = name;\r\n                                        if (!order.items || !order.items.length) {\r\n                                            order.items = [{ \r\n                                                name: name, \r\n                                                quantity: 1, \r\n                                                pid: pid, \r\n                                                price: price \r\n                                            }];\r\n                                        } else {\r\n                                            order.items[0].name = name;\r\n                                            if (pid) order.items[0].pid = pid;\r\n                                            if (price) order.items[0].price = price;\r\n                                        }\r\n                                    }\r\n                                }\r\n                            })\r\n                            .catch(e => console.warn(`è¡¥å…¨è®¢å• ${oid} è¯¦æƒ…å¤±è´¥`, e))\r\n                    );\r\n                }\r\n            }\r\n        });\r\n\r\n        // ç­‰å¾…æ‰€æœ‰è¯¦æƒ…è¡¥å…¨å®Œæˆ\r\n        if (detailPromises.length > 0) {\r\n            console.log(`æ­£åœ¨è¡¥å…¨ ${detailPromises.length} ä¸ªè®¢å•çš„å•†å“ä¿¡æ¯...`);\r\n            await Promise.allSettled(detailPromises);\r\n            console.log('è®¢å•ä¿¡æ¯è¡¥å…¨å®Œæˆï¼Œå¼€å§‹è®¡ç®—é”€é‡');\r\n        }\r\n\r\n        // 2.3 è®¡ç®—æ¯ä¸ªå•†å“çš„é”€é‡ (ç¡®ä¿åœ¨è¡¥å…¨åæ‰§è¡Œ)\r\n        const salesMap = {};\r\n        \r\n        orders.forEach(order => {\r\n            // å½’ä¸€åŒ–å¤„ç† items\r\n            let items = [];\r\n            if (order.items && Array.isArray(order.items)) {\r\n                items = order.items;\r\n            } else if (order.products && Array.isArray(order.products)) {\r\n                items = order.products;\r\n            } else if (order.pid || order.productName) {\r\n                // å•å•†å“ç»“æ„\r\n                items = [{\r\n                    pid: order.pid,\r\n                    name: order.productName,\r\n                    quantity: order.quantity || 1\r\n                }];\r\n            }\r\n\r\n            items.forEach(item => {\r\n                const qty = parseInt(item.quantity || item.count || 1);\r\n                \r\n                // 1. ä¼˜å…ˆä½¿ç”¨ PID åŒ¹é…\r\n                if (item.pid || item.id) {\r\n                    const pidStr = String(item.pid || item.id);\r\n                    salesMap[pidStr] = (salesMap[pidStr] || 0) + qty;\r\n                } \r\n                // 2. å…¶æ¬¡ä½¿ç”¨åç§°åŒ¹é… (å»é™¤ç©ºæ ¼ï¼Œå¿½ç•¥å¤§å°å†™)\r\n                else if (item.name) {\r\n                    const cleanName = item.name.trim();\r\n                    // å°è¯•ä» nameToPidMap æ‰¾ ID\r\n                    if (nameToPidMap[cleanName]) {\r\n                        const pidStr = String(nameToPidMap[cleanName]);\r\n                        salesMap[pidStr] = (salesMap[pidStr] || 0) + qty;\r\n                    } else {\r\n                        // æ‰¾ä¸åˆ° ID å°±ç›´æ¥å­˜åå­—\r\n                        salesMap[cleanName] = (salesMap[cleanName] || 0) + qty;\r\n                    }\r\n                }\r\n            });\r\n        });\r\n\r\n        console.log('é”€é‡ç»Ÿè®¡ç»“æœ:', salesMap);\r\n\r\n        // å°†é”€é‡åˆå¹¶åˆ°å•†å“æ•°æ®ä¸­\r\n        products = products.map(p => {\r\n            const pidStr = String(p.pid);\r\n            // å°è¯•é€šè¿‡ ID è·å–\r\n            let totalSales = salesMap[pidStr] || 0;\r\n            \r\n            // å°è¯•é€šè¿‡åç§°è·å– (é˜²æ­¢ ID ä¸åŒ¹é…çš„æƒ…å†µ)\r\n            if (p.name) {\r\n                totalSales += (salesMap[p.name.trim()] || 0);\r\n            }\r\n            \r\n            return {\r\n                ...p,\r\n                sales_count: totalSales || p.sales_count || 0\r\n            };\r\n        });\r\n\r\n        // 3. è®¡ç®—ç»Ÿè®¡ä¿¡æ¯\r\n        const totalSales = orders.reduce((sum, order) => sum + (order.amount || 0), 0);\r\n\r\n        // è®¡ç®—ä»Šæ—¥é”€å”®é¢\r\n        const today = new Date();\r\n        // Fix: Use local date string to match order dates correctly in local timezone\r\n        const todayStr = today.toLocaleDateString('zh-CN', { year: 'numeric', month: '2-digit', day: '2-digit' }).replace(/\\//g, '-');\r\n        \r\n        const todaySales = orders\r\n            .filter(order => {\r\n              const orderTime = order.order_time || order.orderTime;\r\n              if (!orderTime) return false;\r\n              const orderDate = new Date(orderTime);\r\n              const orderDateStr = orderDate.toLocaleDateString('zh-CN', { year: 'numeric', month: '2-digit', day: '2-digit' }).replace(/\\//g, '-');\r\n              return orderDateStr === todayStr;\r\n            })\r\n            .reduce((sum, order) => sum + (order.amount || 0), 0);\r\n\r\n        const activeProducts = products.filter(p => p.status === 1).length;\r\n        const pendingOrders = orders.filter(order => order.status === 0).length;\r\n\r\n        this.dashboardData = {\r\n          totalSales,\r\n          todaySales,\r\n          activeProducts,\r\n          pendingOrders\r\n        };\r\n\r\n        // 5. è·å–çƒ­é—¨å•†å“ (æŒ‰é”€å”®é¢æ’åº: é”€é‡ * ä»·æ ¼)\r\n        this.topProducts = products\r\n            // .filter(p => p.status === 1) // ç”¨æˆ·å¸Œæœ›èƒ½çœ‹åˆ°æ‰€æœ‰çƒ­é—¨å•†å“ï¼Œå³ä½¿å·²ä¸‹æ¶\r\n            .sort((a, b) => {\r\n               const revenueA = (a.sales_count || 0) * (a.price || 0);\r\n               const revenueB = (b.sales_count || 0) * (b.price || 0);\r\n               return revenueB - revenueA;\r\n            })\r\n            .slice(0, 4)\r\n            .map(p => ({\r\n              pid: p.pid,\r\n              name: p.name,\r\n              sales_count: p.sales_count || 0,\r\n              price: p.price || 0\r\n            }));\r\n\r\n        // 6. è·å–æœ€è¿‘è®¢å•\r\n        this.recentOrders = orders\r\n            .sort((a, b) => {\r\n              const timeA = new Date(a.order_time || a.orderTime);\r\n              const timeB = new Date(b.order_time || b.orderTime);\r\n              return timeB - timeA;\r\n            })\r\n            .slice(0, 5)\r\n            .map(order => {\r\n              // å°è¯•ä»ä¸åŒå­—æ®µè·å–å•†å“åˆ—è¡¨\r\n              let items = [];\r\n              if (order.items && order.items.length) items = order.items;\r\n              else if (order.products && order.products.length) items = order.products;\r\n              else if (order.orderItems && order.orderItems.length) items = order.orderItems;\r\n              else if (order.order_items && order.order_items.length) items = order.order_items;\r\n              else if (order.goods && order.goods.length) items = order.goods;\r\n              else if (order.product) items = [order.product];\r\n              \r\n              // å¦‚æœè¿˜æ˜¯æ²¡æœ‰ï¼Œå°è¯•ä»æ‰å¹³å­—æ®µæ„å»º\r\n              if (items.length === 0) {\r\n                  // ä¼˜å…ˆä½¿ç”¨ PID åæŸ¥\r\n                  if ((order.pid || order.productId) && productMap[order.pid || order.productId]) {\r\n                      const product = productMap[order.pid || order.productId];\r\n                      items = [{\r\n                          name: product.name,\r\n                          quantity: order.quantity || order.count || 1,\r\n                          pid: product.pid\r\n                      }];\r\n                  } \r\n                  // å…¶æ¬¡å°è¯•ä½¿ç”¨åç§°å­—æ®µ\r\n                  else if (order.product_name || order.productName) {\r\n                      items = [{\r\n                          name: order.product_name || order.productName,\r\n                          quantity: order.quantity || order.count || 1\r\n                      }];\r\n                  }\r\n              }\r\n\r\n              return {\r\n                  oid: order.oid || order.id,\r\n                  amount: order.amount || 0,\r\n                  status: order.status || 0,\r\n                  order_time: order.order_time || order.orderTime,\r\n                  items: items.length ? items : [{ name: 'å•†å“', quantity: 1 }]\r\n              };\r\n            });\r\n            \r\n        // 4. è·å–è®¢å•è¶‹åŠ¿ (æ”¾åœ¨æœ€åæ¸²æŸ“ï¼Œç¡®ä¿DOMå‡†å¤‡å°±ç»ª)\r\n        // å¿…é¡»å…ˆç»“æŸloadingçŠ¶æ€ï¼Œè®©v-elseæ˜¾ç¤ºå‡ºæ¥ï¼Œæ‰èƒ½è·å–canvas context\r\n        this.loading = false;\r\n        this.$nextTick(() => {\r\n            const trendData = this.calculateOrderTrend(orders, this.salesRange);\r\n            this.renderSalesChart(trendData);\r\n        });\r\n\r\n      } catch (error) {\r\n        console.error('åŠ è½½ä»ªè¡¨ç›˜æ•°æ®å¤±è´¥:', error);\r\n        this.useMockData();\r\n        this.loading = false;\r\n      } \r\n      // finally {\r\n      //   this.loading = false; // Moved inside try/catch to handle render timing\r\n      // }\r\n    },\r\n\r\n    calculateOrderTrend(orders, rangeType) {\r\n      const today = new Date();\r\n      let startDate = new Date(today);\r\n      let endDate = new Date(today);\r\n      let labels = [];\r\n      let data = [];\r\n      let tooltips = []; // To store date and count for tooltip\r\n\r\n      if (rangeType === 'week') {\r\n        // Current Week (Monday to Sunday)\r\n        const day = startDate.getDay() || 7; // Get current day number, make Sunday 7\r\n        if (day !== 1) startDate.setHours(-24 * (day - 1)); // Go back to Monday\r\n        else startDate.setHours(0,0,0,0);\r\n        \r\n        // Generate labels for Mon-Sun\r\n        for (let i = 0; i < 7; i++) {\r\n          const d = new Date(startDate);\r\n          d.setDate(startDate.getDate() + i);\r\n          // Only up to today? User said \"Current week\", usually implies whole week view, but future days are 0\r\n          labels.push(d.toLocaleDateString('zh-CN', { month: 'numeric', day: 'numeric' }));\r\n          \r\n          const dateStr = d.toLocaleDateString('zh-CN', { year: 'numeric', month: '2-digit', day: '2-digit' }).replace(/\\//g, '-');\r\n          \r\n          const count = orders.filter(o => {\r\n             const oTime = o.order_time || o.orderTime;\r\n             if(!oTime) return false;\r\n             const oDate = new Date(oTime);\r\n             const oDateStr = oDate.toLocaleDateString('zh-CN', { year: 'numeric', month: '2-digit', day: '2-digit' }).replace(/\\//g, '-');\r\n             return oDateStr === dateStr;\r\n          }).length;\r\n          \r\n          data.push(count);\r\n          tooltips.push({ date: dateStr, count: count });\r\n        }\r\n      } else {\r\n        // Current Month\r\n        startDate.setDate(1); // 1st of month\r\n        const daysInMonth = new Date(today.getFullYear(), today.getMonth() + 1, 0).getDate();\r\n        \r\n        for (let i = 1; i <= daysInMonth; i++) {\r\n          const d = new Date(today.getFullYear(), today.getMonth(), i);\r\n          labels.push(d.toLocaleDateString('zh-CN', { month: 'numeric', day: 'numeric' }));\r\n          \r\n          const dateStr = d.toLocaleDateString('zh-CN', { year: 'numeric', month: '2-digit', day: '2-digit' }).replace(/\\//g, '-');\r\n          \r\n           const count = orders.filter(o => {\r\n             const oTime = o.order_time || o.orderTime;\r\n             if(!oTime) return false;\r\n             const oDate = new Date(oTime);\r\n             const oDateStr = oDate.toLocaleDateString('zh-CN', { year: 'numeric', month: '2-digit', day: '2-digit' }).replace(/\\//g, '-');\r\n             return oDateStr === dateStr;\r\n          }).length;\r\n          \r\n          data.push(count);\r\n          tooltips.push({ date: dateStr, count: count });\r\n        }\r\n      }\r\n\r\n      return { labels, values: data, tooltips };\r\n    },\r\n\r\n    renderSalesChart(data) {\r\n      const ctx = this.$refs.salesChart;\r\n      if (!ctx) return;\r\n\r\n      if (this.salesChart) {\r\n        this.salesChart.destroy();\r\n      }\r\n\r\n      this.salesChart = new Chart(ctx, {\r\n        type: 'line',\r\n        data: {\r\n          labels: data.labels,\r\n          datasets: [{\r\n            label: 'è®¢å•æ•°',\r\n            data: data.values,\r\n            borderColor: '#3b82f6', // Blue like the image\r\n            backgroundColor: (context) => {\r\n              const ctx = context.chart.ctx;\r\n              const gradient = ctx.createLinearGradient(0, 0, 0, 300);\r\n              gradient.addColorStop(0, 'rgba(59, 130, 246, 0.5)');\r\n              gradient.addColorStop(1, 'rgba(59, 130, 246, 0.0)');\r\n              return gradient;\r\n            },\r\n            borderWidth: 3,\r\n            fill: true,\r\n            tension: 0.4, // Smooth curve\r\n            pointBackgroundColor: '#ffffff',\r\n            pointBorderColor: '#3b82f6',\r\n            pointBorderWidth: 2,\r\n            pointRadius: 4,\r\n            pointHoverRadius: 6\r\n          }]\r\n        },\r\n        options: {\r\n          responsive: true,\r\n          maintainAspectRatio: false,\r\n          interaction: {\r\n            intersect: false,\r\n            mode: 'index',\r\n          },\r\n          plugins: {\r\n            legend: {\r\n              display: false\r\n            },\r\n            tooltip: {\r\n              backgroundColor: '#3b82f6',\r\n              titleColor: '#fff',\r\n              bodyColor: '#fff',\r\n              displayColors: false,\r\n              callbacks: {\r\n                title: (context) => {\r\n                   return data.tooltips[context[0].dataIndex].date;\r\n                },\r\n                label: (context) => {\r\n                   return context.parsed.y + ' å•';\r\n                }\r\n              }\r\n            }\r\n          },\r\n          scales: {\r\n            y: {\r\n              beginAtZero: true,\r\n              grid: {\r\n                color: 'rgba(0, 0, 0, 0.05)',\r\n                drawBorder: false\r\n              },\r\n              ticks: {\r\n                stepSize: 1\r\n              }\r\n            },\r\n            x: {\r\n              grid: {\r\n                display: false,\r\n                drawBorder: false\r\n              }\r\n            }\r\n          }\r\n        }\r\n      });\r\n    },\r\n\r\n    getMockTrendData(days) {\r\n      const labels = [];\r\n      const sales = [];\r\n\r\n      for (let i = days - 1; i >= 0; i--) {\r\n        const date = new Date();\r\n        date.setDate(date.getDate() - i);\r\n        labels.push(`${date.getMonth() + 1}/${date.getDate()}`);\r\n        sales.push(Math.floor(Math.random() * 5000) + 1000);\r\n      }\r\n\r\n      return { labels, sales };\r\n    },\r\n\r\n    useMockData() {\r\n      // åªæœ‰åœ¨APIè°ƒç”¨å¤±è´¥æ—¶ä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®\r\n      this.dashboardData = {\r\n        totalSales: 0,\r\n        todaySales: 0,\r\n        activeProducts: 0,\r\n        pendingOrders: 0\r\n      };\r\n      this.topProducts = [];\r\n      this.recentOrders = [];\r\n\r\n      this.$nextTick(() => {\r\n        this.renderSalesChart({\r\n          labels: ['å‘¨ä¸€', 'å‘¨äºŒ', 'å‘¨ä¸‰', 'å‘¨å››', 'å‘¨äº”', 'å‘¨å…­', 'å‘¨æ—¥'],\r\n          values: [0, 0, 0, 0, 0, 0, 0]\r\n        });\r\n      });\r\n    },\r\n\r\n    goToOrders() {\r\n      this.$router.push('/business/orders');\r\n    }\r\n  },\r\n  watch: {\r\n    salesRange() {\r\n      this.loadDashboardData();\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n/* æ ·å¼ä¿æŒä¸å˜ */\r\n.business-dashboard {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 24px;\r\n}\r\n\r\n.stats-grid {\r\n  display: grid;\r\n  grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));\r\n  gap: 20px;\r\n}\r\n\r\n.stat-card {\r\n  background: white;\r\n  border-radius: 0;\r\n  padding: 24px;\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 20px;\r\n  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);\r\n  border: 1px solid #e2e8f0;\r\n  transition: all 0.3s;\r\n}\r\n\r\n.stat-card:hover {\r\n  transform: translateY(-4px);\r\n  box-shadow: 0 8px 15px rgba(0, 0, 0, 0.1);\r\n}\r\n\r\n.stat-icon {\r\n  width: 64px;\r\n  height: 64px;\r\n  border-radius: 0;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  font-size: 28px;\r\n}\r\n\r\n.stat-icon.sales {\r\n  background: linear-gradient(135deg, #4299e1, #3182ce);\r\n  color: white;\r\n}\r\n\r\n.stat-icon.today-sales {\r\n  background: linear-gradient(135deg, #48bb78, #38a169);\r\n  color: white;\r\n}\r\n\r\n.stat-icon.products {\r\n  background: linear-gradient(135deg, #ed8936, #dd6b20);\r\n  color: white;\r\n}\r\n\r\n.stat-icon.orders {\r\n  background: linear-gradient(135deg, #9f7aea, #805ad5);\r\n  color: white;\r\n}\r\n\r\n.stat-content {\r\n  flex: 1;\r\n}\r\n\r\n.stat-value {\r\n  font-size: 28px;\r\n  font-weight: 700;\r\n  color: #2d3748;\r\n  margin-bottom: 4px;\r\n}\r\n\r\n.stat-label {\r\n  font-size: 14px;\r\n  color: #718096;\r\n}\r\n\r\n.chart-area {\r\n  display: grid;\r\n  grid-template-columns: 2fr 1fr;\r\n  gap: 24px;\r\n}\r\n\r\n@media (max-width: 1024px) {\r\n  .chart-area {\r\n    grid-template-columns: 1fr;\r\n  }\r\n}\r\n\r\n.chart-card {\r\n  background: white;\r\n  border-radius: 0;\r\n  padding: 24px;\r\n  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);\r\n  border: 1px solid #e2e8f0;\r\n}\r\n\r\n.chart-header {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  margin-bottom: 20px;\r\n}\r\n\r\n.chart-header h3 {\r\n  margin: 0;\r\n  font-size: 18px;\r\n  color: #2d3748;\r\n  font-weight: 600;\r\n}\r\n\r\n.time-select {\r\n  padding: 6px 12px;\r\n  border: 1px solid #e2e8f0;\r\n  border-radius: 0;\r\n  background: white;\r\n  color: #4a5568;\r\n  font-size: 14px;\r\n}\r\n\r\n.chart-container {\r\n  height: 300px;\r\n}\r\n\r\n.loading-chart {\r\n  height: 100%;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  color: #718096;\r\n}\r\n\r\n.sales-chart {\r\n  height: 100%;\r\n}\r\n\r\n.products-list {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 12px;\r\n}\r\n\r\n.product-item {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 12px;\r\n  padding: 12px;\r\n  background: #f8fafc;\r\n  border-radius: 0;\r\n  transition: background 0.3s;\r\n}\r\n\r\n.product-item:hover {\r\n  background: #edf2f7;\r\n}\r\n\r\n.product-icon {\r\n  font-size: 20px;\r\n  width: 40px;\r\n  height: 40px;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  background: white;\r\n  border-radius: 0;\r\n}\r\n\r\n.product-info {\r\n  flex: 1;\r\n}\r\n\r\n.product-name {\r\n  font-weight: 500;\r\n  color: #2d3748;\r\n  margin-bottom: 2px;\r\n}\r\n\r\n.product-sales {\r\n  font-size: 12px;\r\n  color: #718096;\r\n}\r\n\r\n.product-amount {\r\n  font-weight: 600;\r\n  color: #667eea;\r\n}\r\n\r\n.empty-products {\r\n  text-align: center;\r\n  color: #a0aec0;\r\n  padding: 40px 0;\r\n}\r\n\r\n.recent-orders {\r\n  background: white;\r\n  border-radius: 0;\r\n  padding: 24px;\r\n  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);\r\n  border: 1px solid #e2e8f0;\r\n}\r\n\r\n.section-header {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  margin-bottom: 20px;\r\n}\r\n\r\n.section-header h3 {\r\n  margin: 0;\r\n  font-size: 18px;\r\n  color: #2d3748;\r\n  font-weight: 600;\r\n}\r\n\r\n.view-all-btn {\r\n  padding: 8px 16px;\r\n  background: #667eea;\r\n  color: white;\r\n  border: none;\r\n  border-radius: 0;\r\n  cursor: pointer;\r\n  font-size: 14px;\r\n  transition: background 0.3s;\r\n}\r\n\r\n.view-all-btn:hover {\r\n  background: #5a67d8;\r\n}\r\n\r\n.orders-table {\r\n  overflow-x: auto;\r\n}\r\n\r\n.orders-table table {\r\n  width: 100%;\r\n  border-collapse: collapse;\r\n}\r\n\r\n.orders-table th {\r\n  background: #f8fafc;\r\n  padding: 12px;\r\n  text-align: left;\r\n  font-weight: 600;\r\n  color: #4a5568;\r\n  border-bottom: 1px solid #e2e8f0;\r\n  white-space: nowrap;\r\n}\r\n\r\n.orders-table td {\r\n  padding: 12px;\r\n  border-bottom: 1px solid #f7fafc;\r\n}\r\n\r\n.orders-table tbody tr:hover {\r\n  background: #f8fafc;\r\n}\r\n\r\n.order-product {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 4px;\r\n}\r\n\r\n.quantity {\r\n  font-size: 12px;\r\n  color: #718096;\r\n}\r\n\r\n.status-badge {\r\n  padding: 4px 8px;\r\n  font-size: 12px;\r\n  border-radius: 0;\r\n  font-weight: 500;\r\n}\r\n\r\n.status-badge.pending {\r\n  background: #fffaf0;\r\n  color: #c05621;\r\n}\r\n\r\n.status-badge.shipped {\r\n  background: #ebf8ff;\r\n  color: #2b6cb0;\r\n}\r\n\r\n.status-badge.completed {\r\n  background: #f0fff4;\r\n  color: #276749;\r\n}\r\n\r\n.status-badge.cancelled {\r\n  background: #fff5f5;\r\n  color: #c53030;\r\n}\r\n\r\n.no-orders {\r\n  text-align: center;\r\n  color: #a0aec0;\r\n  padding: 40px 0;\r\n}\r\n\r\n@media (max-width: 768px) {\r\n  .stats-grid {\r\n    grid-template-columns: 1fr;\r\n  }\r\n\r\n  .orders-table {\r\n    font-size: 14px;\r\n  }\r\n}\r\n</style>"],"mappings":";;;;;;;AA2IA,SAASA,KAAK,EAAEC,aAAY,QAAS,UAAU;AAC/C,OAAOC,KAAI,MAAO,OAAO;AACzB,OAAOC,SAAQ,MAAO,qBAAqB;AAE3CH,KAAK,CAACI,QAAQ,CAAC,GAAGH,aAAa,CAAC;AAEhC,eAAe;EACbI,IAAI,EAAE,mBAAmB;EACzBC,IAAIA,CAAA,EAAG;IACL,OAAO;MACLC,OAAO,EAAE,IAAI;MACbC,UAAU,EAAE,MAAM;MAClBC,aAAa,EAAE;QACbC,UAAU,EAAE,CAAC;QACbC,UAAU,EAAE,CAAC;QACbC,cAAc,EAAE,CAAC;QACjBC,aAAa,EAAE;MACjB,CAAC;MACDC,UAAU,EAAE,IAAI;MAChBC,WAAW,EAAE,EAAE;MACfC,YAAY,EAAE;IAChB;EACF,CAAC;EACDC,OAAOA,CAAA,EAAG;IACR,IAAI,CAACC,iBAAiB,CAAC,CAAC;EAC1B,CAAC;EACDC,aAAaA,CAAA,EAAG;IACd,IAAI,IAAI,CAACL,UAAU,EAAE;MACnB,IAAI,CAACA,UAAU,CAACM,OAAO,CAAC,CAAC;IAC3B;EACF,CAAC;EACDC,OAAO,EAAE;IACPC,YAAYA,CAACC,GAAG,EAAE;MAChB,IAAI,CAACA,GAAG,EAAE,OAAO,GAAG;MACpB,IAAIA,GAAE,IAAK,KAAK,EAAE;QAChB,OAAO,CAACA,GAAE,GAAI,KAAK,EAAEC,OAAO,CAAC,CAAC,IAAI,GAAG;MACvC;MACA,OAAOD,GAAG,CAACE,cAAc,CAAC,CAAC;IAC7B,CAAC;IAEDC,UAAUA,CAACC,IAAI,EAAE;MACf,IAAI,CAACA,IAAI,EAAE,OAAO,EAAE;MACpB,IAAI;QACF,MAAMC,IAAG,GAAI,IAAIC,IAAI,CAACF,IAAI,CAAC;QAC3B,OAAOC,IAAI,CAACE,kBAAkB,CAAC,OAAO,EAAE;UACtCC,KAAK,EAAE,SAAS;UAChBC,GAAG,EAAE,SAAS;UACdC,IAAI,EAAE,SAAS;UACfC,MAAM,EAAE;QACV,CAAC,CAAC;MACJ,EAAE,OAAOC,CAAC,EAAE;QACV,OAAOR,IAAI;MACb;IACF,CAAC;IAEDS,mBAAmBA,CAACC,MAAM,EAAE;MAC1B,MAAMC,SAAQ,GAAI;QAChB,CAAC,EAAE,SAAS;QACZ,CAAC,EAAE,SAAS;QACZ,CAAC,EAAE,WAAW;QACd,CAAC,EAAE,WAAW;QACd,CAAC,EAAE;MACL,CAAC;MACD,OAAOA,SAAS,CAACD,MAAM,KAAK,SAAS;IACvC,CAAC;IAEDE,kBAAkBA,CAACF,MAAM,EAAE;MACzB,MAAMC,SAAQ,GAAI;QAChB,CAAC,EAAE,KAAK;QACR,CAAC,EAAE,KAAK;QACR,CAAC,EAAE,KAAK;QACR,CAAC,EAAE,KAAK;QACR,CAAC,EAAE;MACL,CAAC;MACD,OAAOA,SAAS,CAACD,MAAM,KAAK,MAAM;IACpC,CAAC;IAED,MAAMnB,iBAAiBA,CAAA,EAAG;MACxB,IAAI,CAACX,OAAM,GAAI,IAAI;MACnB,MAAMiC,YAAW,GAAIC,IAAI,CAACC,KAAK,CAACC,YAAY,CAACC,OAAO,CAAC,cAAc,CAAC,CAAC;MACrE,MAAMC,GAAE,GAAIL,YAAY,EAAEK,GAAE,IAAKL,YAAY,EAAEM,EAAE;MAEjD,IAAI,CAACD,GAAG,EAAE;QACRE,OAAO,CAACC,KAAK,CAAC,SAAS,CAAC;QACxB,IAAI,CAACC,OAAO,CAACC,IAAI,CAAC,iBAAiB,CAAC;QACpC;MACF;MAEA,IAAI;QACF;QACA,MAAMC,gBAAe,GAAI,MAAMjD,KAAK,CAACkD,GAAG,CAACjD,SAAS,CAACkD,QAAQ,CAACC,WAAW,CAACT,GAAG,CAAC,CAAC;QAC7E,IAAIU,QAAO,GAAI,EAAE;QACjB,IAAIJ,gBAAgB,CAAC7C,IAAI,CAACkD,IAAG,KAAM,CAAC,EAAE;UACpCD,QAAO,GAAIJ,gBAAgB,CAAC7C,IAAI,CAACA,IAAG,IAAK,EAAE;QAC7C;;QAEA;QACA,MAAMmD,cAAa,GAAI,MAAMvD,KAAK,CAACkD,GAAG,CAACjD,SAAS,CAACkD,QAAQ,CAACK,SAAS,CAACb,GAAG,CAAC,CAAC;QACzE,IAAIc,MAAK,GAAI,EAAE;QACf,IAAIF,cAAc,CAACnD,IAAI,CAACkD,IAAG,KAAM,CAAC,EAAE;UAClCG,MAAK,GAAIF,cAAc,CAACnD,IAAI,CAACA,IAAG,IAAK,EAAE;QACzC;;QAEA;QACA,MAAMsD,UAAS,GAAI,CAAC,CAAC;QACrB,MAAMC,YAAW,GAAI,CAAC,CAAC,EAAE;QACzBN,QAAQ,CAACO,OAAO,CAACC,CAAA,IAAK;UAClB,IAAIA,CAAC,CAACC,GAAG,EAAE;YACPJ,UAAU,CAACG,CAAC,CAACC,GAAG,IAAID,CAAC;YACrB,IAAIA,CAAC,CAAC1D,IAAI,EAAEwD,YAAY,CAACE,CAAC,CAAC1D,IAAI,IAAI0D,CAAC,CAACC,GAAG;UAC5C;QACJ,CAAC,CAAC;;QAEF;QACA,MAAMC,cAAa,GAAI,EAAE;;QAEzB;QACAN,MAAM,CAACG,OAAO,CAACI,KAAI,IAAK;UACpB,IAAIC,YAAW,GAAI,KAAK;;UAExB;UACA,IAAID,KAAK,CAACE,KAAI,IAAKC,KAAK,CAACC,OAAO,CAACJ,KAAK,CAACE,KAAK,KAAKF,KAAK,CAACE,KAAK,CAACG,MAAK,GAAI,CAAC,EAAE;YACpE;YACA,MAAMC,SAAQ,GAAIN,KAAK,CAACE,KAAK,CAAC,CAAC,CAAC;YAChC,IAAII,SAAS,CAACnE,IAAG,IAAKmE,SAAS,CAACnE,IAAG,KAAM,IAAG,IAAKmE,SAAS,CAACnE,IAAG,KAAM,MAAK,IAAKmE,SAAS,CAACnE,IAAG,KAAM,MAAM,EAAE;cACrG8D,YAAW,GAAI,IAAI;YACvB;UACL,OAAO,IAAID,KAAK,CAACO,YAAW,IAAKP,KAAK,CAACQ,WAAW,EAAE;YAChDP,YAAW,GAAI,IAAI;UACvB;;UAEA;UACA,IAAI,CAACA,YAAW,KAAMD,KAAK,CAACS,GAAE,IAAKT,KAAK,CAACpB,EAAE,CAAC,EAAE;YAC1C,MAAM6B,GAAE,GAAIT,KAAK,CAACS,GAAE,IAAKT,KAAK,CAACpB,EAAE;YACjC;YACA,IAAI8B,YAAW,GAAI,KAAK;YACxB,IAAI,CAACV,KAAK,CAACF,GAAE,IAAKE,KAAK,CAACW,SAAS,KAAKjB,UAAU,CAACM,KAAK,CAACF,GAAE,IAAKE,KAAK,CAACW,SAAS,CAAC,EAAE;cAC5E;cACA,MAAMd,CAAA,GAAIH,UAAU,CAACM,KAAK,CAACF,GAAE,IAAKE,KAAK,CAACW,SAAS,CAAC;cAClD,IAAI,CAACX,KAAK,CAACE,KAAI,IAAK,CAACF,KAAK,CAACE,KAAK,CAACG,MAAM,EAAE;gBACrCL,KAAK,CAACE,KAAI,GAAI,CAAC;kBAAE/D,IAAI,EAAE0D,CAAC,CAAC1D,IAAI;kBAAEyE,QAAQ,EAAEZ,KAAK,CAACY,QAAO,IAAK,CAAC;kBAAEd,GAAG,EAAED,CAAC,CAACC;gBAAI,CAAC,CAAC;cAC/E,OAAO;gBACHE,KAAK,CAACE,KAAK,CAAC,CAAC,CAAC,CAAC/D,IAAG,GAAI0D,CAAC,CAAC1D,IAAI;gBAC5B6D,KAAK,CAACE,KAAK,CAAC,CAAC,CAAC,CAACJ,GAAE,GAAID,CAAC,CAACC,GAAG;cAC9B;cACAE,KAAK,CAACQ,WAAU,GAAIX,CAAC,CAAC1D,IAAI;cAC1BuE,YAAW,GAAI,IAAI;YACvB;;YAEA;YACA,IAAI,CAACA,YAAY,EAAE;cACfX,cAAc,CAACf,IAAI,CACfhD,KAAK,CAACkD,GAAG,CAACjD,SAAS,CAAC+D,KAAK,CAACa,cAAc,CAACJ,GAAG,CAAC,EACxCK,IAAI,CAACC,GAAE,IAAK;gBACT,IAAIA,GAAG,CAAC3E,IAAI,CAACkD,IAAG,KAAM,KAAKyB,GAAG,CAAC3E,IAAI,CAACA,IAAI,EAAE;kBACtC,MAAM4E,MAAK,GAAID,GAAG,CAAC3E,IAAI,CAACA,IAAI;kBAC5B;kBACA,IAAID,IAAG,GAAI,EAAE;kBACb,IAAI2D,GAAE,GAAI,EAAE;kBACZ,IAAImB,KAAI,GAAI,CAAC;kBAEb,IAAID,MAAM,CAACd,KAAI,IAAKc,MAAM,CAACd,KAAK,CAACG,MAAM,EAAE;oBACrClE,IAAG,GAAI6E,MAAM,CAACd,KAAK,CAAC,CAAC,CAAC,CAAC/D,IAAI;oBAC3B2D,GAAE,GAAIkB,MAAM,CAACd,KAAK,CAAC,CAAC,CAAC,CAACtB,EAAC,IAAKoC,MAAM,CAACd,KAAK,CAAC,CAAC,CAAC,CAACJ,GAAG;oBAC/CmB,KAAI,GAAID,MAAM,CAACd,KAAK,CAAC,CAAC,CAAC,CAACe,KAAK;kBACjC,OAAO,IAAID,MAAM,CAACT,YAAY,EAAE;oBAC5BpE,IAAG,GAAI6E,MAAM,CAACT,YAAY;kBAC9B;kBAEA,IAAIpE,IAAI,EAAE;oBACN;oBACA6D,KAAK,CAACQ,WAAU,GAAIrE,IAAI;oBACxB,IAAI,CAAC6D,KAAK,CAACE,KAAI,IAAK,CAACF,KAAK,CAACE,KAAK,CAACG,MAAM,EAAE;sBACrCL,KAAK,CAACE,KAAI,GAAI,CAAC;wBACX/D,IAAI,EAAEA,IAAI;wBACVyE,QAAQ,EAAE,CAAC;wBACXd,GAAG,EAAEA,GAAG;wBACRmB,KAAK,EAAEA;sBACX,CAAC,CAAC;oBACN,OAAO;sBACHjB,KAAK,CAACE,KAAK,CAAC,CAAC,CAAC,CAAC/D,IAAG,GAAIA,IAAI;sBAC1B,IAAI2D,GAAG,EAAEE,KAAK,CAACE,KAAK,CAAC,CAAC,CAAC,CAACJ,GAAE,GAAIA,GAAG;sBACjC,IAAImB,KAAK,EAAEjB,KAAK,CAACE,KAAK,CAAC,CAAC,CAAC,CAACe,KAAI,GAAIA,KAAK;oBAC3C;kBACJ;gBACJ;cACJ,CAAC,EACAC,KAAK,CAACjD,CAAA,IAAKY,OAAO,CAACsC,IAAI,CAAC,QAAQV,GAAG,OAAO,EAAExC,CAAC,CAAC,CACvD,CAAC;YACL;UACJ;QACJ,CAAC,CAAC;;QAEF;QACA,IAAI8B,cAAc,CAACM,MAAK,GAAI,CAAC,EAAE;UAC3BxB,OAAO,CAACuC,GAAG,CAAC,QAAQrB,cAAc,CAACM,MAAM,cAAc,CAAC;UACxD,MAAMgB,OAAO,CAACC,UAAU,CAACvB,cAAc,CAAC;UACxClB,OAAO,CAACuC,GAAG,CAAC,iBAAiB,CAAC;QAClC;;QAEA;QACA,MAAMG,QAAO,GAAI,CAAC,CAAC;QAEnB9B,MAAM,CAACG,OAAO,CAACI,KAAI,IAAK;UACpB;UACA,IAAIE,KAAI,GAAI,EAAE;UACd,IAAIF,KAAK,CAACE,KAAI,IAAKC,KAAK,CAACC,OAAO,CAACJ,KAAK,CAACE,KAAK,CAAC,EAAE;YAC3CA,KAAI,GAAIF,KAAK,CAACE,KAAK;UACvB,OAAO,IAAIF,KAAK,CAACX,QAAO,IAAKc,KAAK,CAACC,OAAO,CAACJ,KAAK,CAACX,QAAQ,CAAC,EAAE;YACxDa,KAAI,GAAIF,KAAK,CAACX,QAAQ;UAC1B,OAAO,IAAIW,KAAK,CAACF,GAAE,IAAKE,KAAK,CAACQ,WAAW,EAAE;YACvC;YACAN,KAAI,GAAI,CAAC;cACLJ,GAAG,EAAEE,KAAK,CAACF,GAAG;cACd3D,IAAI,EAAE6D,KAAK,CAACQ,WAAW;cACvBI,QAAQ,EAAEZ,KAAK,CAACY,QAAO,IAAK;YAChC,CAAC,CAAC;UACN;UAEAV,KAAK,CAACN,OAAO,CAAC4B,IAAG,IAAK;YAClB,MAAMC,GAAE,GAAIC,QAAQ,CAACF,IAAI,CAACZ,QAAO,IAAKY,IAAI,CAACG,KAAI,IAAK,CAAC,CAAC;;YAEtD;YACA,IAAIH,IAAI,CAAC1B,GAAE,IAAK0B,IAAI,CAAC5C,EAAE,EAAE;cACrB,MAAMgD,MAAK,GAAIC,MAAM,CAACL,IAAI,CAAC1B,GAAE,IAAK0B,IAAI,CAAC5C,EAAE,CAAC;cAC1C2C,QAAQ,CAACK,MAAM,IAAI,CAACL,QAAQ,CAACK,MAAM,KAAK,CAAC,IAAIH,GAAG;YACpD;YACA;YAAA,KACK,IAAID,IAAI,CAACrF,IAAI,EAAE;cAChB,MAAM2F,SAAQ,GAAIN,IAAI,CAACrF,IAAI,CAAC4F,IAAI,CAAC,CAAC;cAClC;cACA,IAAIpC,YAAY,CAACmC,SAAS,CAAC,EAAE;gBACzB,MAAMF,MAAK,GAAIC,MAAM,CAAClC,YAAY,CAACmC,SAAS,CAAC,CAAC;gBAC9CP,QAAQ,CAACK,MAAM,IAAI,CAACL,QAAQ,CAACK,MAAM,KAAK,CAAC,IAAIH,GAAG;cACpD,OAAO;gBACH;gBACAF,QAAQ,CAACO,SAAS,IAAI,CAACP,QAAQ,CAACO,SAAS,KAAK,CAAC,IAAIL,GAAG;cAC1D;YACJ;UACJ,CAAC,CAAC;QACN,CAAC,CAAC;QAEF5C,OAAO,CAACuC,GAAG,CAAC,SAAS,EAAEG,QAAQ,CAAC;;QAEhC;QACAlC,QAAO,GAAIA,QAAQ,CAAC2C,GAAG,CAACnC,CAAA,IAAK;UACzB,MAAM+B,MAAK,GAAIC,MAAM,CAAChC,CAAC,CAACC,GAAG,CAAC;UAC5B;UACA,IAAItD,UAAS,GAAI+E,QAAQ,CAACK,MAAM,KAAK,CAAC;;UAEtC;UACA,IAAI/B,CAAC,CAAC1D,IAAI,EAAE;YACRK,UAAS,IAAM+E,QAAQ,CAAC1B,CAAC,CAAC1D,IAAI,CAAC4F,IAAI,CAAC,CAAC,KAAK,CAAE;UAChD;UAEA,OAAO;YACH,GAAGlC,CAAC;YACJoC,WAAW,EAAEzF,UAAS,IAAKqD,CAAC,CAACoC,WAAU,IAAK;UAChD,CAAC;QACL,CAAC,CAAC;;QAEF;QACA,MAAMzF,UAAS,GAAIiD,MAAM,CAACyC,MAAM,CAAC,CAACC,GAAG,EAAEnC,KAAK,KAAKmC,GAAE,IAAKnC,KAAK,CAACoC,MAAK,IAAK,CAAC,CAAC,EAAE,CAAC,CAAC;;QAE9E;QACA,MAAMC,KAAI,GAAI,IAAI1E,IAAI,CAAC,CAAC;QACxB;QACA,MAAM2E,QAAO,GAAID,KAAK,CAACzE,kBAAkB,CAAC,OAAO,EAAE;UAAE2E,IAAI,EAAE,SAAS;UAAE1E,KAAK,EAAE,SAAS;UAAEC,GAAG,EAAE;QAAU,CAAC,CAAC,CAAC0E,OAAO,CAAC,KAAK,EAAE,GAAG,CAAC;QAE7H,MAAM/F,UAAS,GAAIgD,MAAK,CACnBgD,MAAM,CAACzC,KAAI,IAAK;UACf,MAAM0C,SAAQ,GAAI1C,KAAK,CAAC2C,UAAS,IAAK3C,KAAK,CAAC0C,SAAS;UACrD,IAAI,CAACA,SAAS,EAAE,OAAO,KAAK;UAC5B,MAAME,SAAQ,GAAI,IAAIjF,IAAI,CAAC+E,SAAS,CAAC;UACrC,MAAMG,YAAW,GAAID,SAAS,CAAChF,kBAAkB,CAAC,OAAO,EAAE;YAAE2E,IAAI,EAAE,SAAS;YAAE1E,KAAK,EAAE,SAAS;YAAEC,GAAG,EAAE;UAAU,CAAC,CAAC,CAAC0E,OAAO,CAAC,KAAK,EAAE,GAAG,CAAC;UACrI,OAAOK,YAAW,KAAMP,QAAQ;QAClC,CAAC,EACAJ,MAAM,CAAC,CAACC,GAAG,EAAEnC,KAAK,KAAKmC,GAAE,IAAKnC,KAAK,CAACoC,MAAK,IAAK,CAAC,CAAC,EAAE,CAAC,CAAC;QAEzD,MAAM1F,cAAa,GAAI2C,QAAQ,CAACoD,MAAM,CAAC5C,CAAA,IAAKA,CAAC,CAAC1B,MAAK,KAAM,CAAC,CAAC,CAACkC,MAAM;QAClE,MAAM1D,aAAY,GAAI8C,MAAM,CAACgD,MAAM,CAACzC,KAAI,IAAKA,KAAK,CAAC7B,MAAK,KAAM,CAAC,CAAC,CAACkC,MAAM;QAEvE,IAAI,CAAC9D,aAAY,GAAI;UACnBC,UAAU;UACVC,UAAU;UACVC,cAAc;UACdC;QACF,CAAC;;QAED;QACA,IAAI,CAACE,WAAU,GAAIwC;QACf;QAAA,CACCyD,IAAI,CAAC,CAACC,CAAC,EAAEC,CAAC,KAAK;UACb,MAAMC,QAAO,GAAI,CAACF,CAAC,CAACd,WAAU,IAAK,CAAC,KAAKc,CAAC,CAAC9B,KAAI,IAAK,CAAC,CAAC;UACtD,MAAMiC,QAAO,GAAI,CAACF,CAAC,CAACf,WAAU,IAAK,CAAC,KAAKe,CAAC,CAAC/B,KAAI,IAAK,CAAC,CAAC;UACtD,OAAOiC,QAAO,GAAID,QAAQ;QAC7B,CAAC,EACAE,KAAK,CAAC,CAAC,EAAE,CAAC,EACVnB,GAAG,CAACnC,CAAA,KAAM;UACTC,GAAG,EAAED,CAAC,CAACC,GAAG;UACV3D,IAAI,EAAE0D,CAAC,CAAC1D,IAAI;UACZ8F,WAAW,EAAEpC,CAAC,CAACoC,WAAU,IAAK,CAAC;UAC/BhB,KAAK,EAAEpB,CAAC,CAACoB,KAAI,IAAK;QACpB,CAAC,CAAC,CAAC;;QAEP;QACA,IAAI,CAACnE,YAAW,GAAI2C,MAAK,CACpBqD,IAAI,CAAC,CAACC,CAAC,EAAEC,CAAC,KAAK;UACd,MAAMI,KAAI,GAAI,IAAIzF,IAAI,CAACoF,CAAC,CAACJ,UAAS,IAAKI,CAAC,CAACL,SAAS,CAAC;UACnD,MAAMW,KAAI,GAAI,IAAI1F,IAAI,CAACqF,CAAC,CAACL,UAAS,IAAKK,CAAC,CAACN,SAAS,CAAC;UACnD,OAAOW,KAAI,GAAID,KAAK;QACtB,CAAC,EACAD,KAAK,CAAC,CAAC,EAAE,CAAC,EACVnB,GAAG,CAAChC,KAAI,IAAK;UACZ;UACA,IAAIE,KAAI,GAAI,EAAE;UACd,IAAIF,KAAK,CAACE,KAAI,IAAKF,KAAK,CAACE,KAAK,CAACG,MAAM,EAAEH,KAAI,GAAIF,KAAK,CAACE,KAAK,MACrD,IAAIF,KAAK,CAACX,QAAO,IAAKW,KAAK,CAACX,QAAQ,CAACgB,MAAM,EAAEH,KAAI,GAAIF,KAAK,CAACX,QAAQ,MACnE,IAAIW,KAAK,CAACsD,UAAS,IAAKtD,KAAK,CAACsD,UAAU,CAACjD,MAAM,EAAEH,KAAI,GAAIF,KAAK,CAACsD,UAAU,MACzE,IAAItD,KAAK,CAACuD,WAAU,IAAKvD,KAAK,CAACuD,WAAW,CAAClD,MAAM,EAAEH,KAAI,GAAIF,KAAK,CAACuD,WAAW,MAC5E,IAAIvD,KAAK,CAACwD,KAAI,IAAKxD,KAAK,CAACwD,KAAK,CAACnD,MAAM,EAAEH,KAAI,GAAIF,KAAK,CAACwD,KAAK,MAC1D,IAAIxD,KAAK,CAACyD,OAAO,EAAEvD,KAAI,GAAI,CAACF,KAAK,CAACyD,OAAO,CAAC;;UAE/C;UACA,IAAIvD,KAAK,CAACG,MAAK,KAAM,CAAC,EAAE;YACpB;YACA,IAAI,CAACL,KAAK,CAACF,GAAE,IAAKE,KAAK,CAACW,SAAS,KAAKjB,UAAU,CAACM,KAAK,CAACF,GAAE,IAAKE,KAAK,CAACW,SAAS,CAAC,EAAE;cAC5E,MAAM8C,OAAM,GAAI/D,UAAU,CAACM,KAAK,CAACF,GAAE,IAAKE,KAAK,CAACW,SAAS,CAAC;cACxDT,KAAI,GAAI,CAAC;gBACL/D,IAAI,EAAEsH,OAAO,CAACtH,IAAI;gBAClByE,QAAQ,EAAEZ,KAAK,CAACY,QAAO,IAAKZ,KAAK,CAAC2B,KAAI,IAAK,CAAC;gBAC5C7B,GAAG,EAAE2D,OAAO,CAAC3D;cACjB,CAAC,CAAC;YACN;YACA;YAAA,KACK,IAAIE,KAAK,CAACO,YAAW,IAAKP,KAAK,CAACQ,WAAW,EAAE;cAC9CN,KAAI,GAAI,CAAC;gBACL/D,IAAI,EAAE6D,KAAK,CAACO,YAAW,IAAKP,KAAK,CAACQ,WAAW;gBAC7CI,QAAQ,EAAEZ,KAAK,CAACY,QAAO,IAAKZ,KAAK,CAAC2B,KAAI,IAAK;cAC/C,CAAC,CAAC;YACN;UACJ;UAEA,OAAO;YACHlB,GAAG,EAAET,KAAK,CAACS,GAAE,IAAKT,KAAK,CAACpB,EAAE;YAC1BwD,MAAM,EAAEpC,KAAK,CAACoC,MAAK,IAAK,CAAC;YACzBjE,MAAM,EAAE6B,KAAK,CAAC7B,MAAK,IAAK,CAAC;YACzBwE,UAAU,EAAE3C,KAAK,CAAC2C,UAAS,IAAK3C,KAAK,CAAC0C,SAAS;YAC/CxC,KAAK,EAAEA,KAAK,CAACG,MAAK,GAAIH,KAAI,GAAI,CAAC;cAAE/D,IAAI,EAAE,IAAI;cAAEyE,QAAQ,EAAE;YAAE,CAAC;UAC9D,CAAC;QACH,CAAC,CAAC;;QAEN;QACA;QACA,IAAI,CAACvE,OAAM,GAAI,KAAK;QACpB,IAAI,CAACqH,SAAS,CAAC,MAAM;UACjB,MAAMC,SAAQ,GAAI,IAAI,CAACC,mBAAmB,CAACnE,MAAM,EAAE,IAAI,CAACnD,UAAU,CAAC;UACnE,IAAI,CAACuH,gBAAgB,CAACF,SAAS,CAAC;QACpC,CAAC,CAAC;MAEJ,EAAE,OAAO7E,KAAK,EAAE;QACdD,OAAO,CAACC,KAAK,CAAC,YAAY,EAAEA,KAAK,CAAC;QAClC,IAAI,CAACgF,WAAW,CAAC,CAAC;QAClB,IAAI,CAACzH,OAAM,GAAI,KAAK;MACtB;MACA;MACA;MACA;IACF,CAAC;IAEDuH,mBAAmBA,CAACnE,MAAM,EAAEsE,SAAS,EAAE;MACrC,MAAM1B,KAAI,GAAI,IAAI1E,IAAI,CAAC,CAAC;MACxB,IAAIqG,SAAQ,GAAI,IAAIrG,IAAI,CAAC0E,KAAK,CAAC;MAC/B,IAAI4B,OAAM,GAAI,IAAItG,IAAI,CAAC0E,KAAK,CAAC;MAC7B,IAAI6B,MAAK,GAAI,EAAE;MACf,IAAI9H,IAAG,GAAI,EAAE;MACb,IAAI+H,QAAO,GAAI,EAAE,EAAE;;MAEnB,IAAIJ,SAAQ,KAAM,MAAM,EAAE;QACxB;QACA,MAAMjG,GAAE,GAAIkG,SAAS,CAACI,MAAM,CAAC,KAAK,CAAC,EAAE;QACrC,IAAItG,GAAE,KAAM,CAAC,EAAEkG,SAAS,CAACK,QAAQ,CAAC,CAAC,EAAC,IAAKvG,GAAE,GAAI,CAAC,CAAC,CAAC,EAAE;QAAA,KAC/CkG,SAAS,CAACK,QAAQ,CAAC,CAAC,EAAC,CAAC,EAAC,CAAC,EAAC,CAAC,CAAC;;QAEhC;QACA,KAAK,IAAIC,CAAA,GAAI,CAAC,EAAEA,CAAA,GAAI,CAAC,EAAEA,CAAC,EAAE,EAAE;UAC1B,MAAMC,CAAA,GAAI,IAAI5G,IAAI,CAACqG,SAAS,CAAC;UAC7BO,CAAC,CAACC,OAAO,CAACR,SAAS,CAACS,OAAO,CAAC,IAAIH,CAAC,CAAC;UAClC;UACAJ,MAAM,CAAClF,IAAI,CAACuF,CAAC,CAAC3G,kBAAkB,CAAC,OAAO,EAAE;YAAEC,KAAK,EAAE,SAAS;YAAEC,GAAG,EAAE;UAAU,CAAC,CAAC,CAAC;UAEhF,MAAM4G,OAAM,GAAIH,CAAC,CAAC3G,kBAAkB,CAAC,OAAO,EAAE;YAAE2E,IAAI,EAAE,SAAS;YAAE1E,KAAK,EAAE,SAAS;YAAEC,GAAG,EAAE;UAAU,CAAC,CAAC,CAAC0E,OAAO,CAAC,KAAK,EAAE,GAAG,CAAC;UAExH,MAAMb,KAAI,GAAIlC,MAAM,CAACgD,MAAM,CAACkC,CAAA,IAAK;YAC9B,MAAMC,KAAI,GAAID,CAAC,CAAChC,UAAS,IAAKgC,CAAC,CAACjC,SAAS;YACzC,IAAG,CAACkC,KAAK,EAAE,OAAO,KAAK;YACvB,MAAMC,KAAI,GAAI,IAAIlH,IAAI,CAACiH,KAAK,CAAC;YAC7B,MAAME,QAAO,GAAID,KAAK,CAACjH,kBAAkB,CAAC,OAAO,EAAE;cAAE2E,IAAI,EAAE,SAAS;cAAE1E,KAAK,EAAE,SAAS;cAAEC,GAAG,EAAE;YAAU,CAAC,CAAC,CAAC0E,OAAO,CAAC,KAAK,EAAE,GAAG,CAAC;YAC7H,OAAOsC,QAAO,KAAMJ,OAAO;UAC9B,CAAC,CAAC,CAACrE,MAAM;UAETjE,IAAI,CAAC4C,IAAI,CAAC2C,KAAK,CAAC;UAChBwC,QAAQ,CAACnF,IAAI,CAAC;YAAEtB,IAAI,EAAEgH,OAAO;YAAE/C,KAAK,EAAEA;UAAM,CAAC,CAAC;QAChD;MACF,OAAO;QACL;QACAqC,SAAS,CAACQ,OAAO,CAAC,CAAC,CAAC,EAAE;QACtB,MAAMO,WAAU,GAAI,IAAIpH,IAAI,CAAC0E,KAAK,CAAC2C,WAAW,CAAC,CAAC,EAAE3C,KAAK,CAAC4C,QAAQ,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC,CAACR,OAAO,CAAC,CAAC;QAEpF,KAAK,IAAIH,CAAA,GAAI,CAAC,EAAEA,CAAA,IAAKS,WAAW,EAAET,CAAC,EAAE,EAAE;UACrC,MAAMC,CAAA,GAAI,IAAI5G,IAAI,CAAC0E,KAAK,CAAC2C,WAAW,CAAC,CAAC,EAAE3C,KAAK,CAAC4C,QAAQ,CAAC,CAAC,EAAEX,CAAC,CAAC;UAC5DJ,MAAM,CAAClF,IAAI,CAACuF,CAAC,CAAC3G,kBAAkB,CAAC,OAAO,EAAE;YAAEC,KAAK,EAAE,SAAS;YAAEC,GAAG,EAAE;UAAU,CAAC,CAAC,CAAC;UAEhF,MAAM4G,OAAM,GAAIH,CAAC,CAAC3G,kBAAkB,CAAC,OAAO,EAAE;YAAE2E,IAAI,EAAE,SAAS;YAAE1E,KAAK,EAAE,SAAS;YAAEC,GAAG,EAAE;UAAU,CAAC,CAAC,CAAC0E,OAAO,CAAC,KAAK,EAAE,GAAG,CAAC;UAEvH,MAAMb,KAAI,GAAIlC,MAAM,CAACgD,MAAM,CAACkC,CAAA,IAAK;YAC/B,MAAMC,KAAI,GAAID,CAAC,CAAChC,UAAS,IAAKgC,CAAC,CAACjC,SAAS;YACzC,IAAG,CAACkC,KAAK,EAAE,OAAO,KAAK;YACvB,MAAMC,KAAI,GAAI,IAAIlH,IAAI,CAACiH,KAAK,CAAC;YAC7B,MAAME,QAAO,GAAID,KAAK,CAACjH,kBAAkB,CAAC,OAAO,EAAE;cAAE2E,IAAI,EAAE,SAAS;cAAE1E,KAAK,EAAE,SAAS;cAAEC,GAAG,EAAE;YAAU,CAAC,CAAC,CAAC0E,OAAO,CAAC,KAAK,EAAE,GAAG,CAAC;YAC7H,OAAOsC,QAAO,KAAMJ,OAAO;UAC9B,CAAC,CAAC,CAACrE,MAAM;UAETjE,IAAI,CAAC4C,IAAI,CAAC2C,KAAK,CAAC;UAChBwC,QAAQ,CAACnF,IAAI,CAAC;YAAEtB,IAAI,EAAEgH,OAAO;YAAE/C,KAAK,EAAEA;UAAM,CAAC,CAAC;QAChD;MACF;MAEA,OAAO;QAAEuC,MAAM;QAAEgB,MAAM,EAAE9I,IAAI;QAAE+H;MAAS,CAAC;IAC3C,CAAC;IAEDN,gBAAgBA,CAACzH,IAAI,EAAE;MACrB,MAAM+I,GAAE,GAAI,IAAI,CAACC,KAAK,CAACxI,UAAU;MACjC,IAAI,CAACuI,GAAG,EAAE;MAEV,IAAI,IAAI,CAACvI,UAAU,EAAE;QACnB,IAAI,CAACA,UAAU,CAACM,OAAO,CAAC,CAAC;MAC3B;MAEA,IAAI,CAACN,UAAS,GAAI,IAAId,KAAK,CAACqJ,GAAG,EAAE;QAC/BE,IAAI,EAAE,MAAM;QACZjJ,IAAI,EAAE;UACJ8H,MAAM,EAAE9H,IAAI,CAAC8H,MAAM;UACnBoB,QAAQ,EAAE,CAAC;YACTC,KAAK,EAAE,KAAK;YACZnJ,IAAI,EAAEA,IAAI,CAAC8I,MAAM;YACjBM,WAAW,EAAE,SAAS;YAAE;YACxBC,eAAe,EAAGC,OAAO,IAAK;cAC5B,MAAMP,GAAE,GAAIO,OAAO,CAACC,KAAK,CAACR,GAAG;cAC7B,MAAMS,QAAO,GAAIT,GAAG,CAACU,oBAAoB,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,GAAG,CAAC;cACvDD,QAAQ,CAACE,YAAY,CAAC,CAAC,EAAE,yBAAyB,CAAC;cACnDF,QAAQ,CAACE,YAAY,CAAC,CAAC,EAAE,yBAAyB,CAAC;cACnD,OAAOF,QAAQ;YACjB,CAAC;YACDG,WAAW,EAAE,CAAC;YACdC,IAAI,EAAE,IAAI;YACVC,OAAO,EAAE,GAAG;YAAE;YACdC,oBAAoB,EAAE,SAAS;YAC/BC,gBAAgB,EAAE,SAAS;YAC3BC,gBAAgB,EAAE,CAAC;YACnBC,WAAW,EAAE,CAAC;YACdC,gBAAgB,EAAE;UACpB,CAAC;QACH,CAAC;QACDC,OAAO,EAAE;UACPC,UAAU,EAAE,IAAI;UAChBC,mBAAmB,EAAE,KAAK;UAC1BC,WAAW,EAAE;YACXC,SAAS,EAAE,KAAK;YAChBC,IAAI,EAAE;UACR,CAAC;UACDC,OAAO,EAAE;YACPC,MAAM,EAAE;cACNC,OAAO,EAAE;YACX,CAAC;YACDC,OAAO,EAAE;cACPvB,eAAe,EAAE,SAAS;cAC1BwB,UAAU,EAAE,MAAM;cAClBC,SAAS,EAAE,MAAM;cACjBC,aAAa,EAAE,KAAK;cACpBC,SAAS,EAAE;gBACTC,KAAK,EAAG3B,OAAO,IAAK;kBACjB,OAAOtJ,IAAI,CAAC+H,QAAQ,CAACuB,OAAO,CAAC,CAAC,CAAC,CAAC4B,SAAS,CAAC,CAAC5J,IAAI;gBAClD,CAAC;gBACD6H,KAAK,EAAGG,OAAO,IAAK;kBACjB,OAAOA,OAAO,CAAC6B,MAAM,CAACC,CAAA,GAAI,IAAI;gBACjC;cACF;YACF;UACF,CAAC;UACDC,MAAM,EAAE;YACND,CAAC,EAAE;cACDE,WAAW,EAAE,IAAI;cACjBC,IAAI,EAAE;gBACJC,KAAK,EAAE,qBAAqB;gBAC5BC,UAAU,EAAE;cACd,CAAC;cACDC,KAAK,EAAE;gBACLC,QAAQ,EAAE;cACZ;YACF,CAAC;YACDC,CAAC,EAAE;cACDL,IAAI,EAAE;gBACJZ,OAAO,EAAE,KAAK;gBACdc,UAAU,EAAE;cACd;YACF;UACF;QACF;MACF,CAAC,CAAC;IACJ,CAAC;IAEDI,gBAAgBA,CAACC,IAAI,EAAE;MACrB,MAAMhE,MAAK,GAAI,EAAE;MACjB,MAAMiE,KAAI,GAAI,EAAE;MAEhB,KAAK,IAAI7D,CAAA,GAAI4D,IAAG,GAAI,CAAC,EAAE5D,CAAA,IAAK,CAAC,EAAEA,CAAC,EAAE,EAAE;QAClC,MAAM5G,IAAG,GAAI,IAAIC,IAAI,CAAC,CAAC;QACvBD,IAAI,CAAC8G,OAAO,CAAC9G,IAAI,CAAC+G,OAAO,CAAC,IAAIH,CAAC,CAAC;QAChCJ,MAAM,CAAClF,IAAI,CAAC,GAAGtB,IAAI,CAACuH,QAAQ,CAAC,IAAI,CAAC,IAAIvH,IAAI,CAAC+G,OAAO,CAAC,CAAC,EAAE,CAAC;QACvD0D,KAAK,CAACnJ,IAAI,CAACoJ,IAAI,CAACC,KAAK,CAACD,IAAI,CAACE,MAAM,CAAC,IAAI,IAAI,IAAI,IAAI,CAAC;MACrD;MAEA,OAAO;QAAEpE,MAAM;QAAEiE;MAAM,CAAC;IAC1B,CAAC;IAEDrE,WAAWA,CAAA,EAAG;MACZ;MACA,IAAI,CAACvH,aAAY,GAAI;QACnBC,UAAU,EAAE,CAAC;QACbC,UAAU,EAAE,CAAC;QACbC,cAAc,EAAE,CAAC;QACjBC,aAAa,EAAE;MACjB,CAAC;MACD,IAAI,CAACE,WAAU,GAAI,EAAE;MACrB,IAAI,CAACC,YAAW,GAAI,EAAE;MAEtB,IAAI,CAAC4G,SAAS,CAAC,MAAM;QACnB,IAAI,CAACG,gBAAgB,CAAC;UACpBK,MAAM,EAAE,CAAC,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,CAAC;UAClDgB,MAAM,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC;QAC9B,CAAC,CAAC;MACJ,CAAC,CAAC;IACJ,CAAC;IAEDqD,UAAUA,CAAA,EAAG;MACX,IAAI,CAACxJ,OAAO,CAACC,IAAI,CAAC,kBAAkB,CAAC;IACvC;EACF,CAAC;EACDwJ,KAAK,EAAE;IACLlM,UAAUA,CAAA,EAAG;MACX,IAAI,CAACU,iBAAiB,CAAC,CAAC;IAC1B;EACF;AACF","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}