{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.filter.js\";\nimport \"core-js/modules/es.iterator.for-each.js\";\nimport \"core-js/modules/es.iterator.map.js\";\nimport \"core-js/modules/es.iterator.reduce.js\";\nimport \"core-js/modules/es.iterator.some.js\";\nimport axios from 'axios';\nimport apiConfig from '@/config/api.config';\nimport * as echarts from 'echarts/core';\nimport { MapChart, LineChart } from 'echarts/charts';\nimport { TitleComponent, TooltipComponent, VisualMapComponent, GridComponent, LegendComponent } from 'echarts/components';\nimport { CanvasRenderer } from 'echarts/renderers';\nimport { LabelLayout } from 'echarts/features';\necharts.use([MapChart, LineChart, TitleComponent, TooltipComponent, VisualMapComponent, GridComponent, LegendComponent, CanvasRenderer, LabelLayout]);\nconst API_ENDPOINTS = {\n  totalSales: apiConfig.statistics.getTotalSales,\n  totalOrders: apiConfig.statistics.getOrderCount,\n  totalProducts: apiConfig.statistics.getProductCount,\n  todaySales: apiConfig.statistics.getSalesComparison,\n  todayOrders: apiConfig.statistics.getOrderComparison,\n  lowStockProducts: apiConfig.statistics.getLowStockCount,\n  // 修正：使用正确的省份统计接口 (所有订单，非今日)\n  userDistribution: apiConfig.order.countOrdersByProvince,\n  salesTrend: apiConfig.statistics.getSalesTrend || apiConfig.order.getSalesTrend,\n  userGrowthTrend: apiConfig.statistics.getUserGrowthTrend,\n  totalUsers: apiConfig.user.getTotalUsers,\n  newUsers: apiConfig.user.getUserComparison,\n  // 改为使用对比接口\n  recentActivities: null\n};\nconst MOCK_DATA = {\n  totalSales: {\n    value: 1284500,\n    trend: {\n      value: '+12.5%',\n      type: 'up'\n    }\n  },\n  totalUsers: {\n    value: 3542\n  },\n  totalProducts: {\n    value: 287,\n    trend: {\n      value: '±0%',\n      type: 'neutral'\n    }\n  },\n  totalOrders: {\n    value: 5642,\n    trend: {\n      value: '+5.7%',\n      type: 'up'\n    }\n  },\n  todaySales: {\n    value: 28450,\n    trend: {\n      value: '+18.2%',\n      type: 'up'\n    }\n  },\n  newUsers: {\n    value: 42\n  },\n  todayOrders: {\n    value: 124,\n    trend: {\n      value: '+8.7%',\n      type: 'up'\n    }\n  },\n  lowStockProducts: {\n    value: 7\n  },\n  salesTrend: [{\n    month: '1月',\n    sales: 120000\n  }, {\n    month: '2月',\n    sales: 180000\n  }, {\n    month: '3月',\n    sales: 150000\n  }, {\n    month: '4月',\n    sales: 220000\n  }, {\n    month: '5月',\n    sales: 210000\n  }, {\n    month: '6月',\n    sales: 280000\n  }],\n  userGrowth: [{\n    date: '01-01',\n    users: 3200\n  }, {\n    date: '01-02',\n    users: 3250\n  }, {\n    date: '01-03',\n    users: 3310\n  }, {\n    date: '01-04',\n    users: 3380\n  }, {\n    date: '01-05',\n    users: 3420\n  }, {\n    date: '01-06',\n    users: 3480\n  }, {\n    date: '01-07',\n    users: 3542\n  }],\n  userDistribution: [{\n    province: '广东',\n    users: 560\n  }, {\n    province: '北京',\n    users: 420\n  }, {\n    province: '上海',\n    users: 380\n  }],\n  recentActivities: [{\n    id: 1,\n    type: 'order',\n    text: '用户张三购买联想小新Pro16一台',\n    time: '10分钟前',\n    color: '#00c0ef'\n  }, {\n    id: 2,\n    type: 'product',\n    text: '商品\"联想拯救者Y9000P\"库存不足',\n    time: '25分钟前',\n    color: '#dd4b39'\n  }, {\n    id: 3,\n    type: 'user',\n    text: '新用户李四完成注册',\n    time: '1小时前',\n    color: '#00a65a'\n  }]\n};\nasync function fetchData(endpoint, mockData, dataKey = null, defaultValue = null) {\n  if (!endpoint) return {\n    data: mockData,\n    isMock: false,\n    noApi: true,\n    value: defaultValue || mockData?.value || mockData\n  };\n  try {\n    const response = await axios.get(endpoint);\n    if (response.data.code === 1) {\n      let apiData = dataKey ? response.data.data[dataKey] : response.data.data;\n      if (dataKey && typeof apiData === 'undefined') apiData = response.data.data;\n      return {\n        data: apiData,\n        isMock: false,\n        noApi: false,\n        value: apiData || defaultValue\n      };\n    }\n    return {\n      data: mockData,\n      isMock: true,\n      noApi: false,\n      value: defaultValue || mockData?.value || mockData\n    };\n  } catch (error) {\n    return {\n      data: mockData,\n      isMock: true,\n      noApi: false,\n      value: defaultValue || mockData?.value || mockData\n    };\n  }\n}\nasync function fetchUserDistribution() {\n  try {\n    // 优先尝试从后端获取聚合统计数据 (使用您提供的 countOrdersByProvince 接口)\n    const response = await axios.get(API_ENDPOINTS.userDistribution);\n    if (response.data.code === 1 && Array.isArray(response.data.data)) {\n      // 假设后端返回的是 [{province: \"广东\", count: 10}, ...] 或 Map 列表\n      const apiData = response.data.data.map(item => ({\n        // 兼容不同的字段名：province/name, count/value/orderCount\n        // 不在这里移除后缀，而是交给 loadUserDistribution 中的 normalizeProvinceName 处理\n        name: item.province || item.name || '',\n        value: item.orderCount || item.count || item.value || 0\n      })).filter(item => item.name); // 过滤掉空名称\n\n      return {\n        data: apiData,\n        isMock: false,\n        noApi: false,\n        value: apiData\n      };\n    }\n\n    // 如果聚合接口没数据，才尝试降级方案：获取所有订单并前端聚合\n    // ... (之前的降级逻辑保留作为保险)\n    const ordersResponse = await axios.get(apiConfig.order.getAllOrders);\n    if (ordersResponse.data.code === 1 && Array.isArray(ordersResponse.data.data)) {\n      const orders = ordersResponse.data.data;\n      const provinceMap = {};\n      orders.forEach(order => {\n        const province = order.province || order.receiverProvince || order.address?.substring(0, 2) || '未知';\n        // 不在这里移除后缀\n        if (province && province !== '未知') {\n          provinceMap[province] = (provinceMap[province] || 0) + 1;\n        }\n      });\n      const apiData = Object.keys(provinceMap).map(key => ({\n        name: key,\n        value: provinceMap[key]\n      }));\n      return {\n        data: apiData,\n        isMock: false,\n        noApi: false,\n        value: apiData\n      };\n    }\n    throw new Error('Data format error or empty data');\n  } catch (error) {\n    console.warn('Failed to fetch/aggregate province data, using mock:', error);\n    return {\n      data: MOCK_DATA.userDistribution,\n      isMock: true,\n      noApi: false,\n      value: MOCK_DATA.userDistribution\n    };\n  }\n}\nasync function fetchSalesTrend() {\n  try {\n    const endpoint = API_ENDPOINTS.salesTrend;\n    if (!endpoint) return {\n      data: MOCK_DATA.salesTrend,\n      isMock: true,\n      noApi: true,\n      value: MOCK_DATA.salesTrend\n    };\n    const response = await axios.get(endpoint);\n    if (response.data && response.data.code === 1 && Array.isArray(response.data.data)) {\n      return {\n        data: response.data.data.map(item => ({\n          month: item.month || item.date || '',\n          sales: item.sales || item.amount || 0\n        })),\n        isMock: false,\n        noApi: false,\n        value: response.data.data\n      };\n    }\n    return {\n      data: MOCK_DATA.salesTrend,\n      isMock: true,\n      noApi: false,\n      value: MOCK_DATA.salesTrend\n    };\n  } catch (error) {\n    return {\n      data: MOCK_DATA.salesTrend,\n      isMock: true,\n      noApi: false,\n      value: MOCK_DATA.salesTrend\n    };\n  }\n}\nasync function fetchUserComparison() {\n  try {\n    const endpoint = API_ENDPOINTS.userGrowthTrend || API_ENDPOINTS.userGrowth;\n    if (!endpoint) return {\n      data: MOCK_DATA.userGrowth,\n      isMock: true,\n      noApi: true,\n      value: MOCK_DATA.userGrowth\n    };\n    const response = await axios.get(endpoint);\n    if (response.data && response.data.code === 1) {\n      let growthData = Array.isArray(response.data.data) ? response.data.data : response.data.data?.data || [];\n      if (growthData.length > 0) return {\n        data: growthData.map(item => ({\n          date: item.date || item.day || '',\n          users: item.users || item.count || 0\n        })),\n        isMock: false,\n        noApi: false,\n        value: growthData\n      };\n    }\n    return {\n      data: MOCK_DATA.userGrowth,\n      isMock: true,\n      noApi: false,\n      value: MOCK_DATA.userGrowth\n    };\n  } catch (error) {\n    return {\n      data: MOCK_DATA.userGrowth,\n      isMock: true,\n      noApi: false,\n      value: MOCK_DATA.userGrowth\n    };\n  }\n}\nexport default {\n  name: 'AdminDashboard',\n  data() {\n    return {\n      orderTrendRange: 'week',\n      userGrowthRange: 'week',\n      chinaMapChart: null,\n      orderTrendChart: null,\n      userGrowthChart: null,\n      provinceOrders: [],\n      allOrders: [],\n      allUsers: [],\n      allProducts: [],\n      // 新增：保存所有商品用于生成推广活动\n\n      dashboardData: {\n        totalSales: {\n          value: 0\n        },\n        totalUsers: {\n          value: 0\n        },\n        totalProducts: {\n          value: 0\n        },\n        totalOrders: {\n          value: 0\n        },\n        todaySales: {\n          value: 0\n        },\n        newUsers: {\n          value: 0\n        },\n        todayOrders: {\n          value: 0\n        },\n        lowStockProducts: {\n          value: 0\n        },\n        orderTrend: {\n          isMock: false\n        },\n        userGrowth: {\n          isMock: false\n        },\n        userDistribution: {\n          data: []\n        },\n        recentActivities: {\n          data: []\n        }\n      }\n    };\n  },\n  mounted() {\n    this.loadAllData().then(() => {\n      this.$nextTick(() => {\n        this.initChinaMap();\n        this.updateOrderTrendChart();\n        this.updateUserGrowthChart();\n      });\n    });\n    window.addEventListener('resize', this.handleResize);\n  },\n  beforeDestroy() {\n    if (this.chinaMapChart) {\n      this.chinaMapChart.dispose();\n      this.chinaMapChart = null;\n    }\n    if (this.orderTrendChart) {\n      this.orderTrendChart.dispose();\n      this.orderTrendChart = null;\n    }\n    if (this.userGrowthChart) {\n      this.userGrowthChart.dispose();\n      this.userGrowthChart = null;\n    }\n    window.removeEventListener('resize', this.handleResize);\n  },\n  methods: {\n    handleResize() {\n      if (this.chinaMapChart) this.chinaMapChart.resize();\n      if (this.orderTrendChart) this.orderTrendChart.resize();\n      if (this.userGrowthChart) this.userGrowthChart.resize();\n    },\n    formatNumber(num) {\n      if (num === undefined || num === null) return '0';\n      const n = Number(num);\n      if (isNaN(n)) return '0';\n      if (n >= 10000) return (n / 10000).toFixed(1) + '万';\n      return n.toLocaleString();\n    },\n    async loadAllData() {\n      // 1. 先获取基础数据：所有订单、用户和商品\n      await Promise.all([this.fetchAllOrders(), this.fetchAllUsers(), this.loadTotalProducts() // 这会填充 allProducts (需要修改 loadTotalProducts)\n      ]);\n\n      // 2. 基于基础数据计算或加载其他统计\n      await Promise.all([this.loadTotalSales(), this.loadTotalUsers(),\n      // this.loadTotalProducts(), // 移到上面了\n      this.loadTotalOrders(), this.loadTodaySales(), this.loadNewUsers(), this.loadTodayOrders(), this.loadLowStockProducts(), this.loadUserDistribution(), this.loadRecentActivities()]);\n    },\n    async fetchAllOrders() {\n      try {\n        const response = await axios.get(apiConfig.order.getAllOrders);\n        if (response.data.code === 1) {\n          this.allOrders = response.data.data || [];\n        }\n      } catch (e) {\n        console.error(\"Failed to fetch orders\", e);\n        this.allOrders = []; // Use empty array, load functions will handle mocks if needed\n      }\n    },\n    async fetchAllUsers() {\n      try {\n        const response = await axios.get(apiConfig.user.getAllUsers);\n        if (response.data.code === 1) {\n          // 兼容不同的返回结构\n          let users = response.data.data;\n          if (users && users.list) users = users.list;\n          this.allUsers = Array.isArray(users) ? users : [];\n        }\n      } catch (e) {\n        console.error(\"Failed to fetch users\", e);\n        this.allUsers = [];\n      }\n    },\n    async loadTotalSales() {\n      // 优先使用后端接口，失败则前端计算\n      const result = await fetchData(API_ENDPOINTS.totalSales, MOCK_DATA.totalSales, null, 0);\n      if (!result.isMock && !result.noApi) {\n        let value = result.value;\n        if (typeof value === 'object' && value !== null) value = value.totalSales || value.value || value.total || 0;\n        this.dashboardData.totalSales = {\n          value,\n          isMock: false\n        };\n      } else {\n        // 前端计算\n        const total = this.allOrders.reduce((sum, order) => sum + (order.amount || 0), 0);\n        this.dashboardData.totalSales = {\n          value: total,\n          isMock: this.allOrders.length === 0\n        };\n      }\n    },\n    async loadTotalUsers() {\n      this.dashboardData.totalUsers = {\n        value: this.allUsers.length || MOCK_DATA.totalUsers.value,\n        isMock: this.allUsers.length === 0\n      };\n    },\n    async loadTotalOrders() {\n      this.dashboardData.totalOrders = {\n        value: this.allOrders.length || MOCK_DATA.totalOrders.value,\n        isMock: this.allOrders.length === 0\n      };\n    },\n    async loadTotalProducts() {\n      try {\n        const res = await axios.get(apiConfig.product.getAllProducts);\n        if (res.data.code === 1) {\n          const products = res.data.data || [];\n          this.allProducts = products; // 保存所有商品数据\n          this.dashboardData.totalProducts = {\n            value: products.length,\n            isMock: false\n          };\n        }\n      } catch (error) {\n        console.error('加载商品总数失败:', error);\n      }\n    },\n    async loadTodaySales() {\n      // 前端计算今日销售额\n      if (this.allOrders.length > 0) {\n        const todayStr = new Date().toLocaleDateString('zh-CN', {\n          year: 'numeric',\n          month: '2-digit',\n          day: '2-digit'\n        }).replace(/\\//g, '-');\n        const todaySales = this.allOrders.filter(order => {\n          const orderTime = order.orderTime || order.createTime;\n          if (!orderTime) return false;\n          const orderDate = new Date(orderTime).toLocaleDateString('zh-CN', {\n            year: 'numeric',\n            month: '2-digit',\n            day: '2-digit'\n          }).replace(/\\//g, '-');\n          return orderDate === todayStr;\n        }).reduce((sum, order) => sum + (order.amount || 0), 0);\n        this.dashboardData.todaySales = {\n          value: todaySales,\n          isMock: false\n        };\n      } else {\n        // Fallback to mock\n        this.dashboardData.todaySales = {\n          value: MOCK_DATA.todaySales.value,\n          isMock: true\n        };\n      }\n    },\n    async loadNewUsers() {\n      // 前端计算今日新增用户\n      if (this.allUsers.length > 0) {\n        const todayStr = new Date().toLocaleDateString('zh-CN', {\n          year: 'numeric',\n          month: '2-digit',\n          day: '2-digit'\n        }).replace(/\\//g, '-');\n        const count = this.allUsers.filter(user => {\n          const time = user.createTime || user.registerTime;\n          if (!time) return false;\n          const date = new Date(time).toLocaleDateString('zh-CN', {\n            year: 'numeric',\n            month: '2-digit',\n            day: '2-digit'\n          }).replace(/\\//g, '-');\n          return date === todayStr;\n        }).length;\n        this.dashboardData.newUsers = {\n          value: count,\n          isMock: false\n        };\n      } else {\n        this.dashboardData.newUsers = {\n          value: MOCK_DATA.newUsers.value,\n          isMock: true\n        };\n      }\n    },\n    async loadTodayOrders() {\n      // 前端计算\n      if (this.allOrders.length > 0) {\n        const todayStr = new Date().toLocaleDateString('zh-CN', {\n          year: 'numeric',\n          month: '2-digit',\n          day: '2-digit'\n        }).replace(/\\//g, '-');\n        const count = this.allOrders.filter(order => {\n          const orderTime = order.orderTime || order.createTime;\n          if (!orderTime) return false;\n          const orderDate = new Date(orderTime).toLocaleDateString('zh-CN', {\n            year: 'numeric',\n            month: '2-digit',\n            day: '2-digit'\n          }).replace(/\\//g, '-');\n          return orderDate === todayStr;\n        }).length;\n        this.dashboardData.todayOrders = {\n          value: count,\n          isMock: false\n        };\n      } else {\n        this.dashboardData.todayOrders = {\n          value: MOCK_DATA.todayOrders.value,\n          isMock: true\n        };\n      }\n    },\n    async loadLowStockProducts() {\n      const result = await fetchData(API_ENDPOINTS.lowStockProducts, MOCK_DATA.lowStockProducts, null, 0);\n      this.dashboardData.lowStockProducts = {\n        value: result.value,\n        isMock: result.isMock\n      };\n    },\n    // 计算订单趋势数据 (已改为从API获取)\n    async calculateOrderTrendData(range) {\n      // 使用真实API\n      try {\n        const url = range === 'week' ? apiConfig.order.getOrderTrendWeekly : apiConfig.order.getOrderTrendMonthly;\n        const response = await axios.get(url);\n        if (response.data.code === 1 && Array.isArray(response.data.data)) {\n          const labels = [];\n          const values = [];\n          response.data.data.forEach(item => {\n            // item.date 格式为 \"2026-01-01\"\n            // 格式化日期显示，例如 \"01-01\" 或 \"1日\"\n            const dateObj = new Date(item.date);\n            const label = dateObj.toLocaleDateString('zh-CN', {\n              month: 'numeric',\n              day: 'numeric'\n            });\n            labels.push(label);\n            values.push(item.daily_count || 0);\n          });\n          return {\n            labels,\n            values\n          };\n        }\n      } catch (error) {\n        console.error(\"Failed to fetch order trend:\", error);\n      }\n\n      // 如果API失败，回退到前端计算 (保留原有逻辑作为兜底)\n      console.warn(\"Falling back to frontend calculation for order trend\");\n      const now = new Date();\n      const labels = [];\n      const values = [];\n      const dateMap = new Map();\n      if (range === 'week') {\n        // 本周 (周一到周日)\n        const day = now.getDay() || 7; // Sunday is 0 -> 7\n        const startOfWeek = new Date(now);\n        startOfWeek.setDate(now.getDate() - day + 1); // Monday\n        startOfWeek.setHours(0, 0, 0, 0);\n        for (let i = 0; i < 7; i++) {\n          const d = new Date(startOfWeek);\n          d.setDate(startOfWeek.getDate() + i);\n          const label = d.toLocaleDateString('zh-CN', {\n            month: 'numeric',\n            day: 'numeric'\n          });\n          const key = d.toLocaleDateString('zh-CN', {\n            year: 'numeric',\n            month: '2-digit',\n            day: '2-digit'\n          }).replace(/\\//g, '-');\n          labels.push(label);\n          dateMap.set(key, 0);\n        }\n      } else {\n        // 本月 (1号到今天/月底)\n        const startOfMonth = new Date(now.getFullYear(), now.getMonth(), 1);\n        const daysInMonth = new Date(now.getFullYear(), now.getMonth() + 1, 0).getDate();\n        for (let i = 1; i <= daysInMonth; i++) {\n          const d = new Date(now.getFullYear(), now.getMonth(), i);\n          const label = d.toLocaleDateString('zh-CN', {\n            month: 'numeric',\n            day: 'numeric'\n          });\n          const key = d.toLocaleDateString('zh-CN', {\n            year: 'numeric',\n            month: '2-digit',\n            day: '2-digit'\n          }).replace(/\\//g, '-');\n          labels.push(label);\n          dateMap.set(key, 0);\n        }\n      }\n\n      // 填充数据\n      this.allOrders.forEach(order => {\n        const time = order.orderTime || order.createTime;\n        if (time) {\n          const d = new Date(time);\n          const key = d.toLocaleDateString('zh-CN', {\n            year: 'numeric',\n            month: '2-digit',\n            day: '2-digit'\n          }).replace(/\\//g, '-');\n          if (dateMap.has(key)) {\n            dateMap.set(key, dateMap.get(key) + 1);\n          }\n        }\n      });\n      return {\n        labels,\n        values: Array.from(dateMap.values())\n      };\n    },\n    // 计算用户增长数据 (已改为从API获取)\n    async calculateUserGrowthData(range) {\n      // 使用真实API\n      try {\n        const url = range === 'week' ? apiConfig.user.getUserGrowthWeekly : apiConfig.user.getUserGrowthMonthly;\n        const response = await axios.get(url);\n        if (response.data.code === 1 && Array.isArray(response.data.data)) {\n          const labels = [];\n          const values = [];\n          response.data.data.forEach(item => {\n            const dateObj = new Date(item.date);\n            const label = dateObj.toLocaleDateString('zh-CN', {\n              month: 'numeric',\n              day: 'numeric'\n            });\n            labels.push(label);\n            values.push(item.userCount || 0);\n          });\n          return {\n            labels,\n            values\n          };\n        }\n      } catch (error) {\n        console.error(\"Failed to fetch user growth trend:\", error);\n      }\n\n      // 如果API失败，回退到前端计算\n      console.warn(\"Falling back to frontend calculation for user growth\");\n      const now = new Date();\n      const labels = [];\n      const dateMap = new Map();\n      if (range === 'week') {\n        const day = now.getDay() || 7;\n        const startOfWeek = new Date(now);\n        startOfWeek.setDate(now.getDate() - day + 1);\n        startOfWeek.setHours(0, 0, 0, 0);\n        for (let i = 0; i < 7; i++) {\n          const d = new Date(startOfWeek);\n          d.setDate(startOfWeek.getDate() + i);\n          const label = d.toLocaleDateString('zh-CN', {\n            month: 'numeric',\n            day: 'numeric'\n          });\n          const key = d.toLocaleDateString('zh-CN', {\n            year: 'numeric',\n            month: '2-digit',\n            day: '2-digit'\n          }).replace(/\\//g, '-');\n          labels.push(label);\n          dateMap.set(key, 0);\n        }\n      } else {\n        const daysInMonth = new Date(now.getFullYear(), now.getMonth() + 1, 0).getDate();\n        for (let i = 1; i <= daysInMonth; i++) {\n          const d = new Date(now.getFullYear(), now.getMonth(), i);\n          const label = d.toLocaleDateString('zh-CN', {\n            month: 'numeric',\n            day: 'numeric'\n          });\n          const key = d.toLocaleDateString('zh-CN', {\n            year: 'numeric',\n            month: '2-digit',\n            day: '2-digit'\n          }).replace(/\\//g, '-');\n          labels.push(label);\n          dateMap.set(key, 0);\n        }\n      }\n      this.allUsers.forEach(user => {\n        const time = user.createTime || user.registerTime;\n        if (time) {\n          const d = new Date(time);\n          const key = d.toLocaleDateString('zh-CN', {\n            year: 'numeric',\n            month: '2-digit',\n            day: '2-digit'\n          }).replace(/\\//g, '-');\n          if (dateMap.has(key)) {\n            dateMap.set(key, dateMap.get(key) + 1);\n          }\n        }\n      });\n      return {\n        labels,\n        values: Array.from(dateMap.values())\n      };\n    },\n    async updateOrderTrendChart() {\n      const data = await this.calculateOrderTrendData(this.orderTrendRange);\n      if (!data || !data.labels || !data.values) {\n        console.warn('Order trend data is missing or invalid');\n        return;\n      }\n      if (!this.orderTrendChart) {\n        const dom = document.getElementById('order-trend-chart');\n        if (!dom) return;\n        // Ensure we dispose old instance if any (though this.orderTrendChart check handles most cases)\n        const existingInstance = echarts.getInstanceByDom(dom);\n        if (existingInstance) existingInstance.dispose();\n        this.orderTrendChart = echarts.init(dom);\n      }\n      const option = {\n        tooltip: {\n          trigger: 'axis',\n          formatter: '{b}<br />订单数: {c}'\n        },\n        grid: {\n          left: '3%',\n          right: '4%',\n          bottom: '3%',\n          containLabel: true\n        },\n        xAxis: {\n          type: 'category',\n          boundaryGap: false,\n          data: data.labels,\n          axisLine: {\n            show: false\n          },\n          axisTick: {\n            show: false\n          }\n        },\n        yAxis: {\n          type: 'value',\n          splitLine: {\n            lineStyle: {\n              type: 'dashed'\n            }\n          }\n        },\n        series: [{\n          name: '订单数',\n          type: 'line',\n          smooth: true,\n          // 平滑曲线\n          data: data.values,\n          areaStyle: {\n            color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [{\n              offset: 0,\n              color: 'rgba(59, 130, 246, 0.5)'\n            }, {\n              offset: 1,\n              color: 'rgba(59, 130, 246, 0.0)'\n            }])\n          },\n          itemStyle: {\n            color: '#3b82f6'\n          }\n        }]\n      };\n      // Ensure data is valid before setting option to avoid \"Cannot read properties of undefined (reading 'type')\"\n      if (data.values.some(v => v === undefined || v === null)) {\n        console.warn('Order trend values contain null/undefined', data.values);\n        // Fill with 0\n        option.series[0].data = data.values.map(v => v || 0);\n      }\n      this.orderTrendChart.setOption(option);\n    },\n    async updateUserGrowthChart() {\n      const data = await this.calculateUserGrowthData(this.userGrowthRange);\n      if (!data || !data.labels || !data.values) {\n        console.warn('User growth data is missing or invalid');\n        return;\n      }\n      if (!this.userGrowthChart) {\n        const dom = document.getElementById('user-growth-chart');\n        if (!dom) return;\n        const existingInstance = echarts.getInstanceByDom(dom);\n        if (existingInstance) existingInstance.dispose();\n        this.userGrowthChart = echarts.init(dom);\n      }\n      const option = {\n        tooltip: {\n          trigger: 'axis',\n          formatter: '{b}<br />新增用户: {c}'\n        },\n        grid: {\n          left: '3%',\n          right: '4%',\n          bottom: '3%',\n          containLabel: true\n        },\n        xAxis: {\n          type: 'category',\n          boundaryGap: false,\n          data: data.labels,\n          axisLine: {\n            show: false\n          },\n          axisTick: {\n            show: false\n          }\n        },\n        yAxis: {\n          type: 'value',\n          splitLine: {\n            lineStyle: {\n              type: 'dashed'\n            }\n          }\n        },\n        series: [{\n          name: '新增用户',\n          type: 'line',\n          smooth: true,\n          data: data.values,\n          areaStyle: {\n            color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [{\n              offset: 0,\n              color: 'rgba(0, 166, 90, 0.5)'\n            }, {\n              offset: 1,\n              color: 'rgba(0, 166, 90, 0.0)'\n            }])\n          },\n          itemStyle: {\n            color: '#00a65a'\n          }\n        }]\n      };\n      if (data.values.some(v => v === undefined || v === null)) {\n        option.series[0].data = data.values.map(v => v || 0);\n      }\n      this.userGrowthChart.setOption(option);\n    },\n    // Standardize province name\n    normalizeProvinceName(name) {\n      if (!name) return '';\n      let normalized = name.trim();\n      const provinceMap = {\n        '北京': '北京市',\n        '天津': '天津市',\n        '上海': '上海市',\n        '重庆': '重庆市',\n        '河北': '河北省',\n        '山西': '山西省',\n        '辽宁': '辽宁省',\n        '吉林': '吉林省',\n        '黑龙江': '黑龙江省',\n        '江苏': '江苏省',\n        '浙江': '浙江省',\n        '安徽': '安徽省',\n        '福建': '福建省',\n        '江西': '江西省',\n        '山东': '山东省',\n        '河南': '河南省',\n        '湖北': '湖北省',\n        '湖南': '湖南省',\n        '广东': '广东省',\n        '海南': '海南省',\n        '四川': '四川省',\n        '贵州': '贵州省',\n        '云南': '云南省',\n        '陕西': '陕西省',\n        '甘肃': '甘肃省',\n        '青海': '青海省',\n        '台湾': '台湾省',\n        '内蒙古': '内蒙古自治区',\n        '广西': '广西壮族自治区',\n        '西藏': '西藏自治区',\n        '宁夏': '宁夏回族自治区',\n        '新疆': '新疆维吾尔自治区',\n        '香港': '香港特别行政区',\n        '澳门': '澳门特别行政区'\n      };\n      if (Object.values(provinceMap).includes(normalized)) return normalized;\n      if (provinceMap[normalized]) return provinceMap[normalized];\n      for (const [key, value] of Object.entries(provinceMap)) {\n        if (normalized.startsWith(key)) return value;\n      }\n      return normalized;\n    },\n    async loadUserDistribution() {\n      // 使用前端统计所有订单\n      const provinceMap = {};\n      this.allOrders.forEach(order => {\n        const province = order.province || order.receiverProvince || (order.receiverAddress || '').substring(0, 2);\n        if (province) {\n          const normalized = this.normalizeProvinceName(province);\n          if (normalized) {\n            provinceMap[normalized] = (provinceMap[normalized] || 0) + 1;\n          }\n        }\n      });\n      const data = Object.keys(provinceMap).map(key => ({\n        name: key,\n        value: provinceMap[key]\n      }));\n      this.provinceOrders = data;\n      this.dashboardData.userDistribution = {\n        data,\n        isMock: false\n      };\n      this.$nextTick(() => {\n        this.initChinaMap();\n      });\n    },\n    async loadRecentActivities() {\n      let activities = [];\n\n      // Orders\n      this.allOrders.forEach(order => {\n        activities.push({\n          id: 'order-' + order.oid,\n          type: 'order',\n          text: `用户 ${order.receiverName || '未知'} 下单 ¥${order.amount}`,\n          timestamp: new Date(order.orderTime || order.createTime).getTime(),\n          color: '#00c0ef'\n        });\n      });\n\n      // Users\n      this.allUsers.forEach(user => {\n        activities.push({\n          id: 'user-' + user.uid,\n          type: 'user',\n          text: `新用户 ${user.username} 注册`,\n          timestamp: new Date(user.createTime).getTime(),\n          color: '#00a65a'\n        });\n      });\n\n      // Products Promotion\n      if (this.allProducts && this.allProducts.length > 0) {\n        this.allProducts.forEach(product => {\n          const points = (product.rating || product.heat || 100) - 100;\n          if (points > 0) {\n            activities.push({\n              id: 'promo-' + product.pid,\n              type: 'promotion',\n              text: `商家为 [${product.name}] 投入了 ${points} 推广积分`,\n              timestamp: new Date(product.updateTime || Date.now()).getTime(),\n              color: '#f39c12'\n            });\n          }\n        });\n      }\n\n      // Sort\n      activities.sort((a, b) => b.timestamp - a.timestamp);\n      activities = activities.slice(0, 20);\n\n      // Format time\n      const now = Date.now();\n      activities.forEach(item => {\n        const diff = now - item.timestamp;\n        if (diff < 60000) item.time = '刚刚';else if (diff < 3600000) item.time = Math.floor(diff / 60000) + '分钟前';else if (diff < 86400000) item.time = Math.floor(diff / 3600000) + '小时前';else item.time = new Date(item.timestamp).toLocaleDateString();\n      });\n      this.dashboardData.recentActivities = {\n        data: activities,\n        isMock: false\n      };\n    },\n    async initChinaMap() {\n      try {\n        const mapDataUrl = 'https://geo.datav.aliyun.com/areas_v3/bound/100000_full.json';\n        const response = await axios.get(mapDataUrl);\n        echarts.registerMap('china', response.data);\n        const chartDom = document.getElementById('china-map-chart');\n        if (!chartDom) return;\n        this.chinaMapChart = echarts.init(chartDom);\n        const option = {\n          tooltip: {\n            trigger: 'item',\n            formatter: '{b}<br/>订单数: {c}'\n          },\n          visualMap: {\n            min: 0,\n            max: Math.max(...this.provinceOrders.map(p => p.value), 10),\n            left: '30',\n            bottom: '30',\n            text: ['高', '低'],\n            itemWidth: 10,\n            itemHeight: 50,\n            calculable: true,\n            inRange: {\n              color: ['#e0f3f8', '#ffffbf', '#fee090', '#fdae61', '#f46d43', '#d73027', '#a50026']\n            }\n          },\n          series: [{\n            name: '订单数量',\n            type: 'map',\n            map: 'china',\n            roam: false,\n            zoom: 1.75,\n            center: [105, 36],\n            label: {\n              show: true,\n              fontSize: 10\n            },\n            data: this.provinceOrders,\n            itemStyle: {\n              areaColor: '#f3f3f3',\n              borderColor: '#ccc'\n            },\n            emphasis: {\n              itemStyle: {\n                areaColor: '#f39c12'\n              }\n            }\n          }]\n        };\n        this.chinaMapChart.setOption(option);\n      } catch (error) {\n        console.error('Map init error:', error);\n      }\n    }\n  }\n};","map":{"version":3,"names":["axios","apiConfig","echarts","MapChart","LineChart","TitleComponent","TooltipComponent","VisualMapComponent","GridComponent","LegendComponent","CanvasRenderer","LabelLayout","use","API_ENDPOINTS","totalSales","statistics","getTotalSales","totalOrders","getOrderCount","totalProducts","getProductCount","todaySales","getSalesComparison","todayOrders","getOrderComparison","lowStockProducts","getLowStockCount","userDistribution","order","countOrdersByProvince","salesTrend","getSalesTrend","userGrowthTrend","getUserGrowthTrend","totalUsers","user","getTotalUsers","newUsers","getUserComparison","recentActivities","MOCK_DATA","value","trend","type","month","sales","userGrowth","date","users","province","id","text","time","color","fetchData","endpoint","mockData","dataKey","defaultValue","data","isMock","noApi","response","get","code","apiData","error","fetchUserDistribution","Array","isArray","map","item","name","orderCount","count","filter","ordersResponse","getAllOrders","orders","provinceMap","forEach","receiverProvince","address","substring","Object","keys","key","Error","console","warn","fetchSalesTrend","amount","fetchUserComparison","growthData","length","day","orderTrendRange","userGrowthRange","chinaMapChart","orderTrendChart","userGrowthChart","provinceOrders","allOrders","allUsers","allProducts","dashboardData","orderTrend","mounted","loadAllData","then","$nextTick","initChinaMap","updateOrderTrendChart","updateUserGrowthChart","window","addEventListener","handleResize","beforeDestroy","dispose","removeEventListener","methods","resize","formatNumber","num","undefined","n","Number","isNaN","toFixed","toLocaleString","Promise","all","fetchAllOrders","fetchAllUsers","loadTotalProducts","loadTotalSales","loadTotalUsers","loadTotalOrders","loadTodaySales","loadNewUsers","loadTodayOrders","loadLowStockProducts","loadUserDistribution","loadRecentActivities","e","getAllUsers","list","result","total","reduce","sum","res","product","getAllProducts","products","todayStr","Date","toLocaleDateString","year","replace","orderTime","createTime","orderDate","registerTime","calculateOrderTrendData","range","url","getOrderTrendWeekly","getOrderTrendMonthly","labels","values","dateObj","label","push","daily_count","now","dateMap","Map","getDay","startOfWeek","setDate","getDate","setHours","i","d","set","startOfMonth","getFullYear","getMonth","daysInMonth","has","from","calculateUserGrowthData","getUserGrowthWeekly","getUserGrowthMonthly","userCount","dom","document","getElementById","existingInstance","getInstanceByDom","init","option","tooltip","trigger","formatter","grid","left","right","bottom","containLabel","xAxis","boundaryGap","axisLine","show","axisTick","yAxis","splitLine","lineStyle","series","smooth","areaStyle","graphic","LinearGradient","offset","itemStyle","some","v","setOption","normalizeProvinceName","normalized","trim","includes","entries","startsWith","receiverAddress","activities","oid","receiverName","timestamp","getTime","uid","username","points","rating","heat","pid","updateTime","sort","a","b","slice","diff","Math","floor","mapDataUrl","registerMap","chartDom","visualMap","min","max","p","itemWidth","itemHeight","calculable","inRange","roam","zoom","center","fontSize","areaColor","borderColor","emphasis"],"sources":["D:\\1_homework_file\\大三上\\软件工程\\项目留档\\1前端开发_我才是真的\\version5.0\\src\\views\\admin\\Admin1Dashboard.vue"],"sourcesContent":["<template>\r\n  <div class=\"admin-dashboard\">\r\n    <!-- 第一排统计卡片 -->\r\n    <div class=\"row\">\r\n      <!-- 总销售额 -->\r\n      <div class=\"col-md-3 col-sm-6 col-xs-12\">\r\n        <div class=\"info-box\">\r\n          <span class=\"info-box-icon bg-aqua\">\r\n            <svg viewBox=\"0 0 24 24\" width=\"30\" height=\"30\" fill=\"white\"><path d=\"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z\"/></svg>\r\n          </span>\r\n          <div class=\"info-box-content\">\r\n            <span class=\"info-box-text\">总销售额 <span v-if=\"dashboardData.totalSales.isMock\" class=\"mock-badge\">(模拟数据)</span></span>\r\n            <span class=\"info-box-number\">¥{{ formatNumber(dashboardData.totalSales.value) }}</span>\r\n            <div v-if=\"dashboardData.totalSales.trend\" class=\"progress-description\" :class=\"dashboardData.totalSales.trend.type\">\r\n              {{ dashboardData.totalSales.trend.value }}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- 总用户数 -->\r\n      <div class=\"col-md-3 col-sm-6 col-xs-12\">\r\n        <div class=\"info-box\">\r\n          <span class=\"info-box-icon bg-red\">\r\n            <svg viewBox=\"0 0 24 24\" width=\"30\" height=\"30\" fill=\"white\"><path d=\"M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5c-1.66 0-3 1.34-3 3s1.34 3 3 3zm-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5C6.34 5 5 6.34 5 8s1.34 3 3 3zm0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5zm8 0c-.29 0-.62.02-.97.05 1.16.84 1.97 1.97 1.97 3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5z\"/></svg>\r\n          </span>\r\n          <div class=\"info-box-content\">\r\n            <span class=\"info-box-text\">总用户数 <span v-if=\"dashboardData.totalUsers.isMock\" class=\"mock-badge\">(模拟数据)</span></span>\r\n            <span class=\"info-box-number\">\r\n              <span v-if=\"!dashboardData.totalUsers.noApi\">{{ formatNumber(dashboardData.totalUsers.value) }}</span>\r\n              <span v-else>--</span>\r\n            </span>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- 总商品数 -->\r\n      <div class=\"col-md-3 col-sm-6 col-xs-12\">\r\n        <div class=\"info-box\">\r\n          <span class=\"info-box-icon bg-green\">\r\n            <svg viewBox=\"0 0 24 24\" width=\"30\" height=\"30\" fill=\"white\"><path d=\"M20 6h-4V4c0-1.11-.89-2-2-2h-4c-1.11 0-2 .89-2 2v2H4c-1.11 0-1.99.89-1.99 2L2 19c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V8c0-1.11-.89-2-2-2zm-6 0h-4V4h4v2z\"/></svg>\r\n          </span>\r\n          <div class=\"info-box-content\">\r\n            <span class=\"info-box-text\">总商品数 <span v-if=\"dashboardData.totalProducts.isMock\" class=\"mock-badge\">(模拟数据)</span></span>\r\n            <span class=\"info-box-number\">{{ formatNumber(dashboardData.totalProducts.value) }}</span>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- 总订单数 -->\r\n      <div class=\"col-md-3 col-sm-6 col-xs-12\">\r\n        <div class=\"info-box\">\r\n          <span class=\"info-box-icon bg-yellow\">\r\n            <svg viewBox=\"0 0 24 24\" width=\"30\" height=\"30\" fill=\"white\"><path d=\"M7 18c-1.1 0-1.99.9-1.99 2S5.9 22 7 22s2-.9 2-2-.9-2-2-2zM1 2v2h2l3.6 7.59-1.35 2.45c-.16.28-.25.61-.25.96 0 1.1.9 2 2 2h12v-2H7.42c-.14 0-.25-.11-.25-.25l.03-.12.9-1.63h7.45c.75 0 1.41-.41 1.75-1.03l3.58-6.49c.08-.14.12-.31.12-.48 0-.55-.45-1-1-1H5.21l-.94-2H1zm16 16c-1.1 0-1.99.9-1.99 2s.89 2 1.99 2 2-.9 2-2-.9-2-2-2z\"/></svg>\r\n          </span>\r\n          <div class=\"info-box-content\">\r\n            <span class=\"info-box-text\">总订单数 <span v-if=\"dashboardData.totalOrders.isMock\" class=\"mock-badge\">(模拟数据)</span></span>\r\n            <span class=\"info-box-number\">{{ formatNumber(dashboardData.totalOrders.value) }}</span>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- 第二排统计卡片 -->\r\n    <div class=\"row\">\r\n      <!-- 今日销售额 -->\r\n      <div class=\"col-md-3 col-sm-6 col-xs-12\">\r\n        <div class=\"info-box\">\r\n          <span class=\"info-box-icon bg-aqua\">\r\n            <svg viewBox=\"0 0 24 24\" width=\"30\" height=\"30\" fill=\"white\"><path d=\"M16 6l2.29 2.29-4.88 4.88-4-4L2 16.59 3.41 18l6-6 4 4 6.3-6.29L22 12V6z\"/></svg>\r\n          </span>\r\n          <div class=\"info-box-content\">\r\n            <span class=\"info-box-text\">今日销售额 <span v-if=\"dashboardData.todaySales.isMock\" class=\"mock-badge\">(模拟数据)</span></span>\r\n            <span class=\"info-box-number\">¥{{ formatNumber(dashboardData.todaySales.value) }}</span>\r\n            <div v-if=\"dashboardData.todaySales.trend\" class=\"progress-description\" :class=\"dashboardData.todaySales.trend.type\">\r\n              {{ dashboardData.todaySales.trend.value }}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- 今日新增用户 -->\r\n      <div class=\"col-md-3 col-sm-6 col-xs-12\">\r\n        <div class=\"info-box\">\r\n          <span class=\"info-box-icon bg-red\">\r\n            <svg viewBox=\"0 0 24 24\" width=\"30\" height=\"30\" fill=\"white\"><path d=\"M15 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm-9-2V7H4v3H1v2h3v3h2v-3h3v-2H6zm9 4c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z\"/></svg>\r\n          </span>\r\n          <div class=\"info-box-content\">\r\n            <span class=\"info-box-text\">今日新增用户 <span v-if=\"dashboardData.newUsers.isMock\" class=\"mock-badge\">(模拟数据)</span></span>\r\n            <span class=\"info-box-number\">{{ dashboardData.newUsers.value }}</span>\r\n            <div v-if=\"dashboardData.newUsers.trend\" class=\"progress-description\" :class=\"dashboardData.newUsers.trend.type\">\r\n              {{ dashboardData.newUsers.trend.value }}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- 低库存商品 -->\r\n      <div class=\"col-md-3 col-sm-6 col-xs-12\">\r\n        <div class=\"info-box\">\r\n          <span class=\"info-box-icon bg-green\">\r\n            <svg viewBox=\"0 0 24 24\" width=\"30\" height=\"30\" fill=\"white\"><path d=\"M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z\"/></svg>\r\n          </span>\r\n          <div class=\"info-box-content\">\r\n            <span class=\"info-box-text\">低库存商品 <span v-if=\"dashboardData.lowStockProducts.isMock\" class=\"mock-badge\">(模拟数据)</span></span>\r\n            <span class=\"info-box-number\">{{ dashboardData.lowStockProducts.value }}</span>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- 今日订单数 -->\r\n      <div class=\"col-md-3 col-sm-6 col-xs-12\">\r\n        <div class=\"info-box\">\r\n          <span class=\"info-box-icon bg-yellow\">\r\n            <svg viewBox=\"0 0 24 24\" width=\"30\" height=\"30\" fill=\"white\"><path d=\"M19 3h-4.18C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-7 0c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm2 14H7v-2h7v2zm3-4H7v-2h10v2zm0-4H7V7h10v2z\"/></svg>\r\n          </span>\r\n          <div class=\"info-box-content\">\r\n            <span class=\"info-box-text\">今日订单数 <span v-if=\"dashboardData.todayOrders.isMock\" class=\"mock-badge\">(模拟数据)</span></span>\r\n            <span class=\"info-box-number\">{{ dashboardData.todayOrders.value }}</span>\r\n             <div v-if=\"dashboardData.todayOrders.trend\" class=\"progress-description\" :class=\"dashboardData.todayOrders.trend.type\">\r\n              {{ dashboardData.todayOrders.trend.value }}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- 第二排：订单地域分布（独占一行） -->\r\n    <div class=\"row\">\r\n      <div class=\"col-xs-12\">\r\n        <div class=\"box\">\r\n          <div class=\"box-header with-border header-highlight-map\">\r\n            <h3 class=\"box-title\">订单地域分布 <span v-if=\"dashboardData.userDistribution.isMock\" class=\"mock-badge\">(模拟数据)</span></h3>\r\n          </div>\r\n          <div class=\"box-body\">\r\n            <div class=\"chart-container map-container-large\">\r\n              <div id=\"china-map-chart\" style=\"width: 100%; height: 100%;\"></div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- 第三排：销售趋势 + 用户增长趋势（并列） -->\r\n    <div class=\"row equal-height-row\">\r\n      <!-- 订单数趋势 -->\r\n      <div class=\"col-md-6 col-xs-12\">\r\n        <div class=\"box\">\r\n          <div class=\"box-header with-border\">\r\n            <h3 class=\"box-title\">订单数趋势 <span v-if=\"dashboardData.orderTrend.isMock\" class=\"mock-badge\">(模拟数据)</span></h3>\r\n            <div class=\"box-tools pull-right\">\r\n              <select v-model=\"orderTrendRange\" class=\"time-select\" @change=\"updateOrderTrendChart\">\r\n                <option value=\"week\">本周</option>\r\n                <option value=\"month\">本月</option>\r\n              </select>\r\n            </div>\r\n          </div>\r\n          <div class=\"box-body\">\r\n            <div class=\"chart-container\">\r\n               <div id=\"order-trend-chart\" style=\"width: 100%; height: 100%;\"></div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- 用户增长趋势 -->\r\n      <div class=\"col-md-6 col-xs-12\">\r\n        <div class=\"box\">\r\n          <div class=\"box-header with-border\">\r\n            <h3 class=\"box-title\">用户增长趋势 <span v-if=\"dashboardData.userGrowth.isMock\" class=\"mock-badge\">(模拟数据)</span></h3>\r\n            <div class=\"box-tools pull-right\">\r\n              <select v-model=\"userGrowthRange\" class=\"time-select\" @change=\"updateUserGrowthChart\">\r\n                <option value=\"week\">本周</option>\r\n                <option value=\"month\">本月</option>\r\n              </select>\r\n            </div>\r\n          </div>\r\n          <div class=\"box-body\">\r\n            <div class=\"chart-container\">\r\n               <div id=\"user-growth-chart\" style=\"width: 100%; height: 100%;\"></div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- 第四排：最近活动（独占一行） -->\r\n    <div class=\"row\">\r\n      <div class=\"col-xs-12\">\r\n        <div class=\"box\">\r\n          <div class=\"box-header with-border header-highlight-activity\">\r\n            <h3 class=\"box-title\">最近活动 <span v-if=\"dashboardData.recentActivities.isMock\" class=\"mock-badge\">(模拟数据)</span></h3>\r\n            <div class=\"box-tools pull-right\">\r\n              <button class=\"btn btn-box-tool\" @click=\"refreshActivities\" v-if=\"!dashboardData.recentActivities.noApi\">\r\n                刷新\r\n              </button>\r\n            </div>\r\n          </div>\r\n          <div class=\"box-body p-0\">\r\n            <div class=\"activity-list activity-list-large\">\r\n              <div v-for=\"activity in dashboardData.recentActivities.data\" :key=\"activity.id\" class=\"activity-item\">\r\n                <div class=\"activity-icon-wrapper\">\r\n                  <!-- 使用简单的形状代替复杂图标，或复用SVG -->\r\n                  <div class=\"simple-dot\" :style=\"{ backgroundColor: activity.color }\"></div>\r\n                </div>\r\n                <div class=\"activity-content\">\r\n                  <div class=\"activity-text\">{{ activity.text }}</div>\r\n                  <div class=\"activity-time\">{{ activity.time }}</div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport axios from 'axios';\r\nimport apiConfig from '@/config/api.config'\r\nimport * as echarts from 'echarts/core';\r\nimport { MapChart, LineChart } from 'echarts/charts';\r\nimport { TitleComponent, TooltipComponent, VisualMapComponent, GridComponent, LegendComponent } from 'echarts/components';\r\nimport { CanvasRenderer } from 'echarts/renderers';\r\nimport { LabelLayout } from 'echarts/features';\r\n\r\necharts.use([MapChart, LineChart, TitleComponent, TooltipComponent, VisualMapComponent, GridComponent, LegendComponent, CanvasRenderer, LabelLayout]);\r\n\r\nconst API_ENDPOINTS = {\r\n  totalSales: apiConfig.statistics.getTotalSales,\r\n  totalOrders: apiConfig.statistics.getOrderCount,\r\n  totalProducts: apiConfig.statistics.getProductCount,\r\n  todaySales: apiConfig.statistics.getSalesComparison,\r\n  todayOrders: apiConfig.statistics.getOrderComparison,\r\n  lowStockProducts: apiConfig.statistics.getLowStockCount,\r\n  // 修正：使用正确的省份统计接口 (所有订单，非今日)\r\n  userDistribution: apiConfig.order.countOrdersByProvince,\r\n  salesTrend: apiConfig.statistics.getSalesTrend || apiConfig.order.getSalesTrend,\r\n  userGrowthTrend: apiConfig.statistics.getUserGrowthTrend,\r\n  totalUsers: apiConfig.user.getTotalUsers,\r\n  newUsers: apiConfig.user.getUserComparison, // 改为使用对比接口\r\n  recentActivities: null\r\n};\r\n\r\nconst MOCK_DATA = {\r\n  totalSales: { value: 1284500, trend: { value: '+12.5%', type: 'up' } },\r\n  totalUsers: { value: 3542 },\r\n  totalProducts: { value: 287, trend: { value: '±0%', type: 'neutral' } },\r\n  totalOrders: { value: 5642, trend: { value: '+5.7%', type: 'up' } },\r\n  todaySales: { value: 28450, trend: { value: '+18.2%', type: 'up' } },\r\n  newUsers: { value: 42 },\r\n  todayOrders: { value: 124, trend: { value: '+8.7%', type: 'up' } },\r\n  lowStockProducts: { value: 7 },\r\n  salesTrend: [{ month: '1月', sales: 120000 }, { month: '2月', sales: 180000 }, { month: '3月', sales: 150000 }, { month: '4月', sales: 220000 }, { month: '5月', sales: 210000 }, { month: '6月', sales: 280000 }],\r\n  userGrowth: [{ date: '01-01', users: 3200 }, { date: '01-02', users: 3250 }, { date: '01-03', users: 3310 }, { date: '01-04', users: 3380 }, { date: '01-05', users: 3420 }, { date: '01-06', users: 3480 }, { date: '01-07', users: 3542 }],\r\n  userDistribution: [{ province: '广东', users: 560 }, { province: '北京', users: 420 }, { province: '上海', users: 380 }],\r\n  recentActivities: [\r\n    { id: 1, type: 'order', text: '用户张三购买联想小新Pro16一台', time: '10分钟前', color: '#00c0ef' },\r\n    { id: 2, type: 'product', text: '商品\"联想拯救者Y9000P\"库存不足', time: '25分钟前', color: '#dd4b39' },\r\n    { id: 3, type: 'user', text: '新用户李四完成注册', time: '1小时前', color: '#00a65a' }\r\n  ]\r\n};\r\n\r\nasync function fetchData(endpoint, mockData, dataKey = null, defaultValue = null) {\r\n  if (!endpoint) return { data: mockData, isMock: false, noApi: true, value: defaultValue || mockData?.value || mockData };\r\n  try {\r\n    const response = await axios.get(endpoint);\r\n    if (response.data.code === 1) {\r\n      let apiData = dataKey ? response.data.data[dataKey] : response.data.data;\r\n      if (dataKey && typeof apiData === 'undefined') apiData = response.data.data;\r\n      return { data: apiData, isMock: false, noApi: false, value: apiData || defaultValue };\r\n    }\r\n    return { data: mockData, isMock: true, noApi: false, value: defaultValue || mockData?.value || mockData };\r\n  } catch (error) {\r\n    return { data: mockData, isMock: true, noApi: false, value: defaultValue || mockData?.value || mockData };\r\n  }\r\n}\r\n\r\nasync function fetchUserDistribution() {\r\n  try {\r\n    // 优先尝试从后端获取聚合统计数据 (使用您提供的 countOrdersByProvince 接口)\r\n    const response = await axios.get(API_ENDPOINTS.userDistribution);\r\n    \r\n    if (response.data.code === 1 && Array.isArray(response.data.data)) {\r\n      // 假设后端返回的是 [{province: \"广东\", count: 10}, ...] 或 Map 列表\r\n      const apiData = response.data.data.map(item => ({\r\n        // 兼容不同的字段名：province/name, count/value/orderCount\r\n        // 不在这里移除后缀，而是交给 loadUserDistribution 中的 normalizeProvinceName 处理\r\n        name: (item.province || item.name || ''), \r\n        value: item.orderCount || item.count || item.value || 0 \r\n      })).filter(item => item.name); // 过滤掉空名称\r\n\r\n      return { data: apiData, isMock: false, noApi: false, value: apiData };\r\n    }\r\n    \r\n    // 如果聚合接口没数据，才尝试降级方案：获取所有订单并前端聚合\r\n    // ... (之前的降级逻辑保留作为保险)\r\n    const ordersResponse = await axios.get(apiConfig.order.getAllOrders);\r\n    \r\n    if (ordersResponse.data.code === 1 && Array.isArray(ordersResponse.data.data)) {\r\n      const orders = ordersResponse.data.data;\r\n      const provinceMap = {};\r\n      orders.forEach(order => {\r\n        const province = order.province || order.receiverProvince || order.address?.substring(0, 2) || '未知';\r\n        // 不在这里移除后缀\r\n        if (province && province !== '未知') {\r\n          provinceMap[province] = (provinceMap[province] || 0) + 1;\r\n        }\r\n      });\r\n      const apiData = Object.keys(provinceMap).map(key => ({ name: key, value: provinceMap[key] }));\r\n      return { data: apiData, isMock: false, noApi: false, value: apiData };\r\n    }\r\n\r\n    throw new Error('Data format error or empty data');\r\n  } catch (error) {\r\n    console.warn('Failed to fetch/aggregate province data, using mock:', error);\r\n    return { data: MOCK_DATA.userDistribution, isMock: true, noApi: false, value: MOCK_DATA.userDistribution };\r\n  }\r\n}\r\n\r\nasync function fetchSalesTrend() {\r\n  try {\r\n    const endpoint = API_ENDPOINTS.salesTrend;\r\n    if (!endpoint) return { data: MOCK_DATA.salesTrend, isMock: true, noApi: true, value: MOCK_DATA.salesTrend };\r\n    const response = await axios.get(endpoint);\r\n    if (response.data && response.data.code === 1 && Array.isArray(response.data.data)) {\r\n      return { data: response.data.data.map(item => ({ month: item.month || item.date || '', sales: item.sales || item.amount || 0 })), isMock: false, noApi: false, value: response.data.data };\r\n    }\r\n    return { data: MOCK_DATA.salesTrend, isMock: true, noApi: false, value: MOCK_DATA.salesTrend };\r\n  } catch (error) {\r\n    return { data: MOCK_DATA.salesTrend, isMock: true, noApi: false, value: MOCK_DATA.salesTrend };\r\n  }\r\n}\r\n\r\nasync function fetchUserComparison() {\r\n  try {\r\n    const endpoint = API_ENDPOINTS.userGrowthTrend || API_ENDPOINTS.userGrowth;\r\n    if (!endpoint) return { data: MOCK_DATA.userGrowth, isMock: true, noApi: true, value: MOCK_DATA.userGrowth };\r\n    const response = await axios.get(endpoint);\r\n    if (response.data && response.data.code === 1) {\r\n      let growthData = Array.isArray(response.data.data) ? response.data.data : (response.data.data?.data || []);\r\n      if (growthData.length > 0) return { data: growthData.map(item => ({ date: item.date || item.day || '', users: item.users || item.count || 0 })), isMock: false, noApi: false, value: growthData };\r\n    }\r\n    return { data: MOCK_DATA.userGrowth, isMock: true, noApi: false, value: MOCK_DATA.userGrowth };\r\n  } catch (error) {\r\n    return { data: MOCK_DATA.userGrowth, isMock: true, noApi: false, value: MOCK_DATA.userGrowth };\r\n  }\r\n}\r\n\r\nexport default {\r\n  name: 'AdminDashboard',\r\n  data() {\r\n    return {\r\n      orderTrendRange: 'week',\r\n      userGrowthRange: 'week',\r\n      \r\n      chinaMapChart: null,\r\n      orderTrendChart: null,\r\n      userGrowthChart: null,\r\n      \r\n      provinceOrders: [],\r\n      \r\n      allOrders: [],\r\n      allUsers: [],\r\n      allProducts: [], // 新增：保存所有商品用于生成推广活动\r\n      \r\n      dashboardData: {\r\n        totalSales: { value: 0 }, totalUsers: { value: 0 }, totalProducts: { value: 0 }, totalOrders: { value: 0 },\r\n        todaySales: { value: 0 }, newUsers: { value: 0 }, todayOrders: { value: 0 }, lowStockProducts: { value: 0 },\r\n        orderTrend: { isMock: false }, userGrowth: { isMock: false }, userDistribution: { data: [] }, recentActivities: { data: [] }\r\n      }\r\n    };\r\n  },\r\n  mounted() {\r\n    this.loadAllData().then(() => {\r\n      this.$nextTick(() => { \r\n        this.initChinaMap();\r\n        this.updateOrderTrendChart();\r\n        this.updateUserGrowthChart();\r\n      });\r\n    });\r\n    window.addEventListener('resize', this.handleResize);\r\n  },\r\n  beforeDestroy() {\r\n    if (this.chinaMapChart) {\r\n      this.chinaMapChart.dispose();\r\n      this.chinaMapChart = null;\r\n    }\r\n    if (this.orderTrendChart) {\r\n      this.orderTrendChart.dispose();\r\n      this.orderTrendChart = null;\r\n    }\r\n    if (this.userGrowthChart) {\r\n      this.userGrowthChart.dispose();\r\n      this.userGrowthChart = null;\r\n    }\r\n    window.removeEventListener('resize', this.handleResize);\r\n  },\r\n  methods: {\r\n    handleResize() {\r\n      if (this.chinaMapChart) this.chinaMapChart.resize();\r\n      if (this.orderTrendChart) this.orderTrendChart.resize();\r\n      if (this.userGrowthChart) this.userGrowthChart.resize();\r\n    },\r\n    formatNumber(num) {\r\n      if (num === undefined || num === null) return '0';\r\n      const n = Number(num);\r\n      if (isNaN(n)) return '0';\r\n      if (n >= 10000) return (n / 10000).toFixed(1) + '万';\r\n      return n.toLocaleString();\r\n    },\r\n    \r\n    async loadAllData() {\r\n      // 1. 先获取基础数据：所有订单、用户和商品\r\n      await Promise.all([\r\n        this.fetchAllOrders(), \r\n        this.fetchAllUsers(),\r\n        this.loadTotalProducts() // 这会填充 allProducts (需要修改 loadTotalProducts)\r\n      ]);\r\n      \r\n      // 2. 基于基础数据计算或加载其他统计\r\n      await Promise.all([\r\n        this.loadTotalSales(), \r\n        this.loadTotalUsers(), \r\n        // this.loadTotalProducts(), // 移到上面了\r\n        this.loadTotalOrders(),\r\n        this.loadTodaySales(), \r\n        this.loadNewUsers(), \r\n        this.loadTodayOrders(), \r\n        this.loadLowStockProducts(),\r\n        this.loadUserDistribution(), \r\n        this.loadRecentActivities()\r\n      ]);\r\n    },\r\n\r\n    async fetchAllOrders() {\r\n      try {\r\n        const response = await axios.get(apiConfig.order.getAllOrders);\r\n        if (response.data.code === 1) {\r\n          this.allOrders = response.data.data || [];\r\n        }\r\n      } catch (e) {\r\n        console.error(\"Failed to fetch orders\", e);\r\n        this.allOrders = []; // Use empty array, load functions will handle mocks if needed\r\n      }\r\n    },\r\n\r\n    async fetchAllUsers() {\r\n      try {\r\n        const response = await axios.get(apiConfig.user.getAllUsers);\r\n        if (response.data.code === 1) {\r\n          // 兼容不同的返回结构\r\n          let users = response.data.data;\r\n          if (users && users.list) users = users.list;\r\n          this.allUsers = Array.isArray(users) ? users : [];\r\n        }\r\n      } catch (e) {\r\n        console.error(\"Failed to fetch users\", e);\r\n        this.allUsers = [];\r\n      }\r\n    },\r\n\r\n    async loadTotalSales() {\r\n        // 优先使用后端接口，失败则前端计算\r\n        const result = await fetchData(API_ENDPOINTS.totalSales, MOCK_DATA.totalSales, null, 0);\r\n        if (!result.isMock && !result.noApi) {\r\n             let value = result.value;\r\n             if (typeof value === 'object' && value !== null) value = value.totalSales || value.value || value.total || 0;\r\n             this.dashboardData.totalSales = { value, isMock: false };\r\n        } else {\r\n            // 前端计算\r\n            const total = this.allOrders.reduce((sum, order) => sum + (order.amount || 0), 0);\r\n            this.dashboardData.totalSales = { value: total, isMock: this.allOrders.length === 0 };\r\n        }\r\n    },\r\n    \r\n    async loadTotalUsers() {\r\n        this.dashboardData.totalUsers = { value: this.allUsers.length || MOCK_DATA.totalUsers.value, isMock: this.allUsers.length === 0 };\r\n    },\r\n\r\n    async loadTotalOrders() {\r\n        this.dashboardData.totalOrders = { value: this.allOrders.length || MOCK_DATA.totalOrders.value, isMock: this.allOrders.length === 0 };\r\n    },\r\n    \r\n    async loadTotalProducts() {\r\n      try {\r\n        const res = await axios.get(apiConfig.product.getAllProducts);\r\n        if (res.data.code === 1) {\r\n          const products = res.data.data || [];\r\n          this.allProducts = products; // 保存所有商品数据\r\n          this.dashboardData.totalProducts = { value: products.length, isMock: false };\r\n        }\r\n      } catch (error) {\r\n        console.error('加载商品总数失败:', error);\r\n      }\r\n    },\r\n\r\n    async loadTodaySales() {\r\n      // 前端计算今日销售额\r\n      if (this.allOrders.length > 0) {\r\n        const todayStr = new Date().toLocaleDateString('zh-CN', { year: 'numeric', month: '2-digit', day: '2-digit' }).replace(/\\//g, '-');\r\n        \r\n        const todaySales = this.allOrders\r\n            .filter(order => {\r\n              const orderTime = order.orderTime || order.createTime;\r\n              if (!orderTime) return false;\r\n              const orderDate = new Date(orderTime).toLocaleDateString('zh-CN', { year: 'numeric', month: '2-digit', day: '2-digit' }).replace(/\\//g, '-');\r\n              return orderDate === todayStr;\r\n            })\r\n            .reduce((sum, order) => sum + (order.amount || 0), 0);\r\n            \r\n        this.dashboardData.todaySales = { value: todaySales, isMock: false };\r\n      } else {\r\n        // Fallback to mock\r\n         this.dashboardData.todaySales = { value: MOCK_DATA.todaySales.value, isMock: true };\r\n      }\r\n    },\r\n\r\n    async loadNewUsers() {\r\n       // 前端计算今日新增用户\r\n       if (this.allUsers.length > 0) {\r\n        const todayStr = new Date().toLocaleDateString('zh-CN', { year: 'numeric', month: '2-digit', day: '2-digit' }).replace(/\\//g, '-');\r\n        \r\n        const count = this.allUsers.filter(user => {\r\n            const time = user.createTime || user.registerTime;\r\n            if (!time) return false;\r\n            const date = new Date(time).toLocaleDateString('zh-CN', { year: 'numeric', month: '2-digit', day: '2-digit' }).replace(/\\//g, '-');\r\n            return date === todayStr;\r\n        }).length;\r\n        \r\n        this.dashboardData.newUsers = { value: count, isMock: false };\r\n       } else {\r\n         this.dashboardData.newUsers = { value: MOCK_DATA.newUsers.value, isMock: true };\r\n       }\r\n    },\r\n\r\n    async loadTodayOrders() {\r\n      // 前端计算\r\n      if (this.allOrders.length > 0) {\r\n        const todayStr = new Date().toLocaleDateString('zh-CN', { year: 'numeric', month: '2-digit', day: '2-digit' }).replace(/\\//g, '-');\r\n        \r\n        const count = this.allOrders.filter(order => {\r\n            const orderTime = order.orderTime || order.createTime;\r\n            if (!orderTime) return false;\r\n            const orderDate = new Date(orderTime).toLocaleDateString('zh-CN', { year: 'numeric', month: '2-digit', day: '2-digit' }).replace(/\\//g, '-');\r\n            return orderDate === todayStr;\r\n        }).length;\r\n        \r\n        this.dashboardData.todayOrders = { value: count, isMock: false };\r\n      } else {\r\n         this.dashboardData.todayOrders = { value: MOCK_DATA.todayOrders.value, isMock: true };\r\n      }\r\n    },\r\n\r\n    async loadLowStockProducts() {\r\n      const result = await fetchData(API_ENDPOINTS.lowStockProducts, MOCK_DATA.lowStockProducts, null, 0);\r\n      this.dashboardData.lowStockProducts = { value: result.value, isMock: result.isMock };\r\n    },\r\n\r\n    // 计算订单趋势数据 (已改为从API获取)\r\n    async calculateOrderTrendData(range) {\r\n        // 使用真实API\r\n        try {\r\n            const url = range === 'week' ? apiConfig.order.getOrderTrendWeekly : apiConfig.order.getOrderTrendMonthly;\r\n            const response = await axios.get(url);\r\n            \r\n            if (response.data.code === 1 && Array.isArray(response.data.data)) {\r\n                const labels = [];\r\n                const values = [];\r\n                \r\n                response.data.data.forEach(item => {\r\n                    // item.date 格式为 \"2026-01-01\"\r\n                    // 格式化日期显示，例如 \"01-01\" 或 \"1日\"\r\n                    const dateObj = new Date(item.date);\r\n                    const label = dateObj.toLocaleDateString('zh-CN', { month: 'numeric', day: 'numeric' });\r\n                    \r\n                    labels.push(label);\r\n                    values.push(item.daily_count || 0);\r\n                });\r\n                \r\n                return { labels, values };\r\n            }\r\n        } catch (error) {\r\n            console.error(\"Failed to fetch order trend:\", error);\r\n        }\r\n\r\n        // 如果API失败，回退到前端计算 (保留原有逻辑作为兜底)\r\n        console.warn(\"Falling back to frontend calculation for order trend\");\r\n        const now = new Date();\r\n        const labels = [];\r\n        const values = [];\r\n        const dateMap = new Map();\r\n        \r\n        if (range === 'week') {\r\n            // 本周 (周一到周日)\r\n            const day = now.getDay() || 7; // Sunday is 0 -> 7\r\n            const startOfWeek = new Date(now);\r\n            startOfWeek.setDate(now.getDate() - day + 1); // Monday\r\n            startOfWeek.setHours(0,0,0,0);\r\n            \r\n            for (let i = 0; i < 7; i++) {\r\n                const d = new Date(startOfWeek);\r\n                d.setDate(startOfWeek.getDate() + i);\r\n                const label = d.toLocaleDateString('zh-CN', { month: 'numeric', day: 'numeric' });\r\n                const key = d.toLocaleDateString('zh-CN', { year: 'numeric', month: '2-digit', day: '2-digit' }).replace(/\\//g, '-');\r\n                labels.push(label);\r\n                dateMap.set(key, 0);\r\n            }\r\n        } else {\r\n            // 本月 (1号到今天/月底)\r\n            const startOfMonth = new Date(now.getFullYear(), now.getMonth(), 1);\r\n            const daysInMonth = new Date(now.getFullYear(), now.getMonth() + 1, 0).getDate();\r\n            \r\n            for (let i = 1; i <= daysInMonth; i++) {\r\n                 const d = new Date(now.getFullYear(), now.getMonth(), i);\r\n                 const label = d.toLocaleDateString('zh-CN', { month: 'numeric', day: 'numeric' });\r\n                 const key = d.toLocaleDateString('zh-CN', { year: 'numeric', month: '2-digit', day: '2-digit' }).replace(/\\//g, '-');\r\n                 labels.push(label);\r\n                 dateMap.set(key, 0);\r\n            }\r\n        }\r\n        \r\n        // 填充数据\r\n        this.allOrders.forEach(order => {\r\n            const time = order.orderTime || order.createTime;\r\n            if (time) {\r\n                const d = new Date(time);\r\n                const key = d.toLocaleDateString('zh-CN', { year: 'numeric', month: '2-digit', day: '2-digit' }).replace(/\\//g, '-');\r\n                if (dateMap.has(key)) {\r\n                    dateMap.set(key, dateMap.get(key) + 1);\r\n                }\r\n            }\r\n        });\r\n        \r\n        return { labels, values: Array.from(dateMap.values()) };\r\n    },\r\n\r\n    // 计算用户增长数据 (已改为从API获取)\r\n    async calculateUserGrowthData(range) {\r\n        // 使用真实API\r\n        try {\r\n            const url = range === 'week' ? apiConfig.user.getUserGrowthWeekly : apiConfig.user.getUserGrowthMonthly;\r\n            const response = await axios.get(url);\r\n            \r\n            if (response.data.code === 1 && Array.isArray(response.data.data)) {\r\n                const labels = [];\r\n                const values = [];\r\n                \r\n                response.data.data.forEach(item => {\r\n                    const dateObj = new Date(item.date);\r\n                    const label = dateObj.toLocaleDateString('zh-CN', { month: 'numeric', day: 'numeric' });\r\n                    \r\n                    labels.push(label);\r\n                    values.push(item.userCount || 0);\r\n                });\r\n                \r\n                return { labels, values };\r\n            }\r\n        } catch (error) {\r\n            console.error(\"Failed to fetch user growth trend:\", error);\r\n        }\r\n\r\n        // 如果API失败，回退到前端计算\r\n        console.warn(\"Falling back to frontend calculation for user growth\");\r\n        const now = new Date();\r\n        const labels = [];\r\n        const dateMap = new Map();\r\n        \r\n        if (range === 'week') {\r\n            const day = now.getDay() || 7;\r\n            const startOfWeek = new Date(now);\r\n            startOfWeek.setDate(now.getDate() - day + 1);\r\n            startOfWeek.setHours(0,0,0,0);\r\n            \r\n            for (let i = 0; i < 7; i++) {\r\n                const d = new Date(startOfWeek);\r\n                d.setDate(startOfWeek.getDate() + i);\r\n                const label = d.toLocaleDateString('zh-CN', { month: 'numeric', day: 'numeric' });\r\n                const key = d.toLocaleDateString('zh-CN', { year: 'numeric', month: '2-digit', day: '2-digit' }).replace(/\\//g, '-');\r\n                labels.push(label);\r\n                dateMap.set(key, 0);\r\n            }\r\n        } else {\r\n            const daysInMonth = new Date(now.getFullYear(), now.getMonth() + 1, 0).getDate();\r\n            for (let i = 1; i <= daysInMonth; i++) {\r\n                 const d = new Date(now.getFullYear(), now.getMonth(), i);\r\n                 const label = d.toLocaleDateString('zh-CN', { month: 'numeric', day: 'numeric' });\r\n                 const key = d.toLocaleDateString('zh-CN', { year: 'numeric', month: '2-digit', day: '2-digit' }).replace(/\\//g, '-');\r\n                 labels.push(label);\r\n                 dateMap.set(key, 0);\r\n            }\r\n        }\r\n        \r\n        this.allUsers.forEach(user => {\r\n            const time = user.createTime || user.registerTime;\r\n            if (time) {\r\n                const d = new Date(time);\r\n                const key = d.toLocaleDateString('zh-CN', { year: 'numeric', month: '2-digit', day: '2-digit' }).replace(/\\//g, '-');\r\n                if (dateMap.has(key)) {\r\n                    dateMap.set(key, dateMap.get(key) + 1);\r\n                }\r\n            }\r\n        });\r\n        \r\n        return { labels, values: Array.from(dateMap.values()) };\r\n    },\r\n\r\n    async updateOrderTrendChart() {\r\n        const data = await this.calculateOrderTrendData(this.orderTrendRange);\r\n        \r\n        if (!data || !data.labels || !data.values) {\r\n            console.warn('Order trend data is missing or invalid');\r\n            return;\r\n        }\r\n\r\n        if (!this.orderTrendChart) {\r\n             const dom = document.getElementById('order-trend-chart');\r\n             if (!dom) return;\r\n             // Ensure we dispose old instance if any (though this.orderTrendChart check handles most cases)\r\n             const existingInstance = echarts.getInstanceByDom(dom);\r\n             if (existingInstance) existingInstance.dispose();\r\n             this.orderTrendChart = echarts.init(dom);\r\n        }\r\n        \r\n        const option = {\r\n            tooltip: {\r\n                trigger: 'axis',\r\n                formatter: '{b}<br />订单数: {c}'\r\n            },\r\n            grid: { left: '3%', right: '4%', bottom: '3%', containLabel: true },\r\n            xAxis: {\r\n                type: 'category',\r\n                boundaryGap: false,\r\n                data: data.labels,\r\n                axisLine: { show: false },\r\n                axisTick: { show: false }\r\n            },\r\n            yAxis: {\r\n                type: 'value',\r\n                splitLine: { lineStyle: { type: 'dashed' } }\r\n            },\r\n            series: [{\r\n                name: '订单数',\r\n                type: 'line',\r\n                smooth: true, // 平滑曲线\r\n                data: data.values,\r\n                areaStyle: {\r\n                    color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [\r\n                      { offset: 0, color: 'rgba(59, 130, 246, 0.5)' },\r\n                      { offset: 1, color: 'rgba(59, 130, 246, 0.0)' }\r\n                    ])\r\n                },\r\n                itemStyle: { color: '#3b82f6' }\r\n            }]\r\n        };\r\n        // Ensure data is valid before setting option to avoid \"Cannot read properties of undefined (reading 'type')\"\r\n        if (data.values.some(v => v === undefined || v === null)) {\r\n             console.warn('Order trend values contain null/undefined', data.values);\r\n             // Fill with 0\r\n             option.series[0].data = data.values.map(v => v || 0);\r\n        }\r\n        \r\n        this.orderTrendChart.setOption(option);\r\n    },\r\n\r\n    async updateUserGrowthChart() {\r\n        const data = await this.calculateUserGrowthData(this.userGrowthRange);\r\n        \r\n        if (!data || !data.labels || !data.values) {\r\n             console.warn('User growth data is missing or invalid');\r\n             return;\r\n        }\r\n        \r\n        if (!this.userGrowthChart) {\r\n             const dom = document.getElementById('user-growth-chart');\r\n             if (!dom) return;\r\n             const existingInstance = echarts.getInstanceByDom(dom);\r\n             if (existingInstance) existingInstance.dispose();\r\n             this.userGrowthChart = echarts.init(dom);\r\n        }\r\n        \r\n        const option = {\r\n            tooltip: {\r\n                trigger: 'axis',\r\n                formatter: '{b}<br />新增用户: {c}'\r\n            },\r\n            grid: { left: '3%', right: '4%', bottom: '3%', containLabel: true },\r\n            xAxis: {\r\n                type: 'category',\r\n                boundaryGap: false,\r\n                data: data.labels,\r\n                axisLine: { show: false },\r\n                axisTick: { show: false }\r\n            },\r\n            yAxis: {\r\n                type: 'value',\r\n                splitLine: { lineStyle: { type: 'dashed' } }\r\n            },\r\n            series: [{\r\n                name: '新增用户',\r\n                type: 'line',\r\n                smooth: true,\r\n                data: data.values,\r\n                areaStyle: {\r\n                    color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [\r\n                      { offset: 0, color: 'rgba(0, 166, 90, 0.5)' },\r\n                      { offset: 1, color: 'rgba(0, 166, 90, 0.0)' }\r\n                    ])\r\n                },\r\n                itemStyle: { color: '#00a65a' }\r\n            }]\r\n        };\r\n        \r\n        if (data.values.some(v => v === undefined || v === null)) {\r\n             option.series[0].data = data.values.map(v => v || 0);\r\n        }\r\n\r\n        this.userGrowthChart.setOption(option);\r\n    },\r\n\r\n    // Standardize province name\r\n    normalizeProvinceName(name) {\r\n      if (!name) return '';\r\n      let normalized = name.trim();\r\n      const provinceMap = {\r\n        '北京': '北京市', '天津': '天津市', '上海': '上海市', '重庆': '重庆市',\r\n        '河北': '河北省', '山西': '山西省', '辽宁': '辽宁省', '吉林': '吉林省', '黑龙江': '黑龙江省',\r\n        '江苏': '江苏省', '浙江': '浙江省', '安徽': '安徽省', '福建': '福建省', '江西': '江西省', '山东': '山东省',\r\n        '河南': '河南省', '湖北': '湖北省', '湖南': '湖南省', '广东': '广东省', '海南': '海南省',\r\n        '四川': '四川省', '贵州': '贵州省', '云南': '云南省', '陕西': '陕西省', '甘肃': '甘肃省', '青海': '青海省', '台湾': '台湾省',\r\n        '内蒙古': '内蒙古自治区', '广西': '广西壮族自治区', '西藏': '西藏自治区', '宁夏': '宁夏回族自治区', '新疆': '新疆维吾尔自治区',\r\n        '香港': '香港特别行政区', '澳门': '澳门特别行政区'\r\n      };\r\n      if (Object.values(provinceMap).includes(normalized)) return normalized;\r\n      if (provinceMap[normalized]) return provinceMap[normalized];\r\n      for (const [key, value] of Object.entries(provinceMap)) {\r\n        if (normalized.startsWith(key)) return value;\r\n      }\r\n      return normalized;\r\n    },\r\n\r\n    async loadUserDistribution() {\r\n        // 使用前端统计所有订单\r\n        const provinceMap = {};\r\n        this.allOrders.forEach(order => {\r\n             const province = order.province || order.receiverProvince || (order.receiverAddress || '').substring(0, 2);\r\n             if (province) {\r\n                 const normalized = this.normalizeProvinceName(province);\r\n                 if (normalized) {\r\n                     provinceMap[normalized] = (provinceMap[normalized] || 0) + 1;\r\n                 }\r\n             }\r\n        });\r\n        \r\n        const data = Object.keys(provinceMap).map(key => ({ name: key, value: provinceMap[key] }));\r\n        this.provinceOrders = data;\r\n        this.dashboardData.userDistribution = { data, isMock: false };\r\n        \r\n        this.$nextTick(() => { this.initChinaMap(); });\r\n    },\r\n    \r\n    async loadRecentActivities() {\r\n        let activities = [];\r\n        \r\n        // Orders\r\n        this.allOrders.forEach(order => {\r\n             activities.push({\r\n                 id: 'order-' + order.oid,\r\n                 type: 'order',\r\n                 text: `用户 ${order.receiverName || '未知'} 下单 ¥${order.amount}`,\r\n                 timestamp: new Date(order.orderTime || order.createTime).getTime(),\r\n                 color: '#00c0ef'\r\n             });\r\n        });\r\n        \r\n        // Users\r\n        this.allUsers.forEach(user => {\r\n             activities.push({\r\n                 id: 'user-' + user.uid,\r\n                 type: 'user',\r\n                 text: `新用户 ${user.username} 注册`,\r\n                 timestamp: new Date(user.createTime).getTime(),\r\n                 color: '#00a65a'\r\n             });\r\n        });\r\n\r\n        // Products Promotion\r\n        if (this.allProducts && this.allProducts.length > 0) {\r\n            this.allProducts.forEach(product => {\r\n                 const points = (product.rating || product.heat || 100) - 100;\r\n                 if (points > 0) {\r\n                     activities.push({\r\n                         id: 'promo-' + product.pid,\r\n                         type: 'promotion',\r\n                         text: `商家为 [${product.name}] 投入了 ${points} 推广积分`,\r\n                         timestamp: new Date(product.updateTime || Date.now()).getTime(),\r\n                         color: '#f39c12'\r\n                     });\r\n                 }\r\n            });\r\n        }\r\n        \r\n        // Sort\r\n        activities.sort((a, b) => b.timestamp - a.timestamp);\r\n        activities = activities.slice(0, 20);\r\n        \r\n        // Format time\r\n        const now = Date.now();\r\n        activities.forEach(item => {\r\n             const diff = now - item.timestamp;\r\n             if (diff < 60000) item.time = '刚刚';\r\n             else if (diff < 3600000) item.time = Math.floor(diff/60000) + '分钟前';\r\n             else if (diff < 86400000) item.time = Math.floor(diff/3600000) + '小时前';\r\n             else item.time = new Date(item.timestamp).toLocaleDateString();\r\n        });\r\n        \r\n        this.dashboardData.recentActivities = { data: activities, isMock: false };\r\n    },\r\n    \r\n    async initChinaMap() {\r\n      try {\r\n        const mapDataUrl = 'https://geo.datav.aliyun.com/areas_v3/bound/100000_full.json';\r\n        const response = await axios.get(mapDataUrl);\r\n        echarts.registerMap('china', response.data);\r\n        const chartDom = document.getElementById('china-map-chart');\r\n        if (!chartDom) return;\r\n        this.chinaMapChart = echarts.init(chartDom);\r\n        const option = {\r\n          tooltip: { trigger: 'item', formatter: '{b}<br/>订单数: {c}' },\r\n          visualMap: {\r\n            min: 0, \r\n            max: Math.max(...this.provinceOrders.map(p => p.value), 10), \r\n            left: '30', \r\n            bottom: '30', \r\n            text: ['高', '低'], \r\n            itemWidth: 10,\r\n            itemHeight: 50,\r\n            calculable: true,\r\n            inRange: { color: ['#e0f3f8', '#ffffbf', '#fee090', '#fdae61', '#f46d43', '#d73027', '#a50026'] }\r\n          },\r\n          series: [{\r\n            name: '订单数量', type: 'map', map: 'china', roam: false, zoom: 1.75,center:[105,36],\r\n            label: { show: true, fontSize: 10 },\r\n            data: this.provinceOrders,\r\n            itemStyle: { areaColor: '#f3f3f3', borderColor: '#ccc' },\r\n            emphasis: { itemStyle: { areaColor: '#f39c12' } }\r\n          }]\r\n        };\r\n        this.chinaMapChart.setOption(option);\r\n      } catch (error) {\r\n        console.error('Map init error:', error);\r\n      }\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.admin-dashboard {\r\n  font-family: 'Source Sans Pro', 'Helvetica Neue', Helvetica, Arial, sans-serif;\r\n  color: #333;\r\n}\r\n\r\n/* 栅格系统模拟 Bootstrap */\r\n.row {\r\n  display: flex;\r\n  flex-wrap: wrap;\r\n  margin-right: -15px;\r\n  margin-left: -15px;\r\n}\r\n\r\n.equal-height-row > [class*='col-'] {\r\n  display: flex;\r\n  flex-direction: column;\r\n}\r\n\r\n.equal-height-row .box {\r\n  flex: 1;\r\n  width: 100%;\r\n  display: flex;\r\n  flex-direction: column;\r\n}\r\n\r\n.equal-height-row .box-body {\r\n  flex: 1;\r\n  display: flex;\r\n  flex-direction: column;\r\n}\r\n\r\n.col-md-3, .col-sm-6, .col-xs-12, .col-md-6 {\r\n  position: relative;\r\n  min-height: 1px;\r\n  padding-right: 15px;\r\n  padding-left: 15px;\r\n}\r\n\r\n.col-xs-12 { width: 100%; }\r\n@media (min-width: 768px) {\r\n  .col-sm-6 { width: 50%; }\r\n}\r\n@media (min-width: 992px) {\r\n  .col-md-3 { width: 25%; }\r\n  .col-md-6 { width: 50%; }\r\n}\r\n\r\n/* Info Box */\r\n.info-box {\r\n  display: block;\r\n  min-height: 90px;\r\n  background: #fff;\r\n  width: 100%;\r\n  box-shadow: 0 1px 1px rgba(0,0,0,0.1);\r\n  border-radius: 2px;\r\n  margin-bottom: 15px;\r\n}\r\n\r\n.info-box-icon {\r\n  border-top-left-radius: 2px;\r\n  border-top-right-radius: 0;\r\n  border-bottom-right-radius: 0;\r\n  border-bottom-left-radius: 2px;\r\n  display: block;\r\n  float: left;\r\n  height: 90px;\r\n  width: 90px;\r\n  text-align: center;\r\n  font-size: 45px;\r\n  line-height: 90px;\r\n  background: rgba(0,0,0,0.2);\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n}\r\n\r\n.info-box-content {\r\n  padding: 5px 10px;\r\n  margin-left: 90px;\r\n}\r\n\r\n.info-box-number {\r\n  display: block;\r\n  font-weight: bold;\r\n  font-size: 18px;\r\n}\r\n\r\n.progress-description {\r\n  display: block;\r\n  margin: 0;\r\n  font-size: 12px;\r\n  white-space: nowrap;\r\n  overflow: hidden;\r\n  text-overflow: ellipsis;\r\n  margin-top: 5px;\r\n}\r\n\r\n.progress-description.up { color: #00a65a; }\r\n.progress-description.down { color: #dd4b39; }\r\n.progress-description.neutral { color: #777; }\r\n\r\n.info-box-text {\r\n  text-transform: uppercase;\r\n  display: block;\r\n  font-size: 14px;\r\n  white-space: nowrap;\r\n  overflow: hidden;\r\n  text-overflow: ellipsis;\r\n}\r\n\r\n/* Colors */\r\n.bg-aqua { background-color: #00c0ef !important; color: #fff !important; }\r\n.bg-red { background-color: #dd4b39 !important; color: #fff !important; }\r\n.bg-green { background-color: #00a65a !important; color: #fff !important; }\r\n.bg-yellow { background-color: #f39c12 !important; color: #fff !important; }\r\n\r\n/* Box Style */\r\n.box {\r\n  position: relative;\r\n  border-radius: 3px;\r\n  background: #ffffff;\r\n  border-top: 3px solid #d2d6de;\r\n  margin-bottom: 20px;\r\n  width: 100%;\r\n  box-shadow: 0 1px 1px rgba(0,0,0,0.1);\r\n}\r\n\r\n.box-header {\r\n  color: #444;\r\n  display: block;\r\n  padding: 10px;\r\n  position: relative;\r\n}\r\n\r\n.box-header.with-border {\r\n  border-bottom: 1px solid #f4f4f4;\r\n}\r\n\r\n.box-title {\r\n  display: inline-block;\r\n  font-size: 18px;\r\n  margin: 0;\r\n  line-height: 1;\r\n}\r\n\r\n.box-body {\r\n  border-top-left-radius: 0;\r\n  border-top-right-radius: 0;\r\n  border-bottom-right-radius: 3px;\r\n  border-bottom-left-radius: 3px;\r\n  padding: 10px;\r\n}\r\n\r\n.box-tools {\r\n  position: absolute;\r\n  right: 10px;\r\n  top: 5px;\r\n}\r\n\r\n.label {\r\n  display: inline;\r\n  padding: .2em .6em .3em;\r\n  font-size: 75%;\r\n  font-weight: 700;\r\n  line-height: 1;\r\n  color: #fff;\r\n  text-align: center;\r\n  white-space: nowrap;\r\n  vertical-align: baseline;\r\n  border-radius: .25em;\r\n}\r\n.label-warning { background-color: #f0ad4e; }\r\n.label-success { background-color: #5cb85c; }\r\n\r\n.chart-container {\r\n  height: 300px;\r\n  position: relative;\r\n}\r\n\r\n/* 特别调整地图容器高度，让地图显示更大 */\r\n.map-container {\r\n  height: 380px;\r\n}\r\n\r\n.line-chart {\r\n  width: 100%;\r\n  height: 100%;\r\n}\r\n\r\n.x-axis {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  margin-top: 5px;\r\n  font-size: 12px;\r\n  color: #666;\r\n}\r\n\r\n/* Activity List */\r\n.activity-list {\r\n  padding: 0;\r\n  margin: 0;\r\n  height: 300px;\r\n  overflow-y: auto;\r\n}\r\n\r\n.activity-item {\r\n  border-bottom: 1px solid #f4f4f4;\r\n  padding: 10px;\r\n  display: flex;\r\n  align-items: center;\r\n}\r\n\r\n.activity-icon-wrapper {\r\n  margin-right: 10px;\r\n}\r\n\r\n.simple-dot {\r\n  width: 12px;\r\n  height: 12px;\r\n  border-radius: 50%;\r\n}\r\n\r\n.activity-content {\r\n  flex: 1;\r\n}\r\n\r\n.activity-text {\r\n  font-size: 14px;\r\n  margin-bottom: 2px;\r\n}\r\n\r\n.activity-time {\r\n  color: #999;\r\n  font-size: 12px;\r\n}\r\n\r\n/* Buttons */\r\n.btn-box-tool {\r\n  padding: 5px;\r\n  font-size: 12px;\r\n  background: transparent;\r\n  color: #97a0b3;\r\n  border: none;\r\n  cursor: pointer;\r\n}\r\n.btn-box-tool:hover { color: #606c84; }\r\n\r\n.time-select {\r\n  border: 1px solid #ddd;\r\n  padding: 2px;\r\n  font-size: 12px;\r\n}\r\n\r\n.mock-badge {\r\n  font-size: 12px;\r\n  color: #999;\r\n  font-weight: normal;\r\n  margin-left: 5px;\r\n  background: #f4f4f4;\r\n  padding: 1px 4px;\r\n  border-radius: 3px;\r\n}\r\n\r\n/* 头部高亮样式 */\r\n.header-highlight-map {\r\n  background: linear-gradient(to right, #e8f5e9, #ffffff);\r\n  border-left: 4px solid #2e7d32;\r\n}\r\n\r\n.header-highlight-activity {\r\n  background: linear-gradient(to right, #e3f2fd, #ffffff);\r\n  border-left: 4px solid #1976d2;\r\n}\r\n\r\n/* 宽屏地图容器 */\r\n.map-container-large {\r\n  height: 300px;\r\n}\r\n\r\n/* 宽屏活动列表 */\r\n.activity-list-large {\r\n  height: auto;\r\n  max-height: 400px;\r\n}\r\n</style>\r\n"],"mappings":";;;;;;;AA2NA,OAAOA,KAAI,MAAO,OAAO;AACzB,OAAOC,SAAQ,MAAO,qBAAoB;AAC1C,OAAO,KAAKC,OAAM,MAAO,cAAc;AACvC,SAASC,QAAQ,EAAEC,SAAQ,QAAS,gBAAgB;AACpD,SAASC,cAAc,EAAEC,gBAAgB,EAAEC,kBAAkB,EAAEC,aAAa,EAAEC,eAAc,QAAS,oBAAoB;AACzH,SAASC,cAAa,QAAS,mBAAmB;AAClD,SAASC,WAAU,QAAS,kBAAkB;AAE9CT,OAAO,CAACU,GAAG,CAAC,CAACT,QAAQ,EAAEC,SAAS,EAAEC,cAAc,EAAEC,gBAAgB,EAAEC,kBAAkB,EAAEC,aAAa,EAAEC,eAAe,EAAEC,cAAc,EAAEC,WAAW,CAAC,CAAC;AAErJ,MAAME,aAAY,GAAI;EACpBC,UAAU,EAAEb,SAAS,CAACc,UAAU,CAACC,aAAa;EAC9CC,WAAW,EAAEhB,SAAS,CAACc,UAAU,CAACG,aAAa;EAC/CC,aAAa,EAAElB,SAAS,CAACc,UAAU,CAACK,eAAe;EACnDC,UAAU,EAAEpB,SAAS,CAACc,UAAU,CAACO,kBAAkB;EACnDC,WAAW,EAAEtB,SAAS,CAACc,UAAU,CAACS,kBAAkB;EACpDC,gBAAgB,EAAExB,SAAS,CAACc,UAAU,CAACW,gBAAgB;EACvD;EACAC,gBAAgB,EAAE1B,SAAS,CAAC2B,KAAK,CAACC,qBAAqB;EACvDC,UAAU,EAAE7B,SAAS,CAACc,UAAU,CAACgB,aAAY,IAAK9B,SAAS,CAAC2B,KAAK,CAACG,aAAa;EAC/EC,eAAe,EAAE/B,SAAS,CAACc,UAAU,CAACkB,kBAAkB;EACxDC,UAAU,EAAEjC,SAAS,CAACkC,IAAI,CAACC,aAAa;EACxCC,QAAQ,EAAEpC,SAAS,CAACkC,IAAI,CAACG,iBAAiB;EAAE;EAC5CC,gBAAgB,EAAE;AACpB,CAAC;AAED,MAAMC,SAAQ,GAAI;EAChB1B,UAAU,EAAE;IAAE2B,KAAK,EAAE,OAAO;IAAEC,KAAK,EAAE;MAAED,KAAK,EAAE,QAAQ;MAAEE,IAAI,EAAE;IAAK;EAAE,CAAC;EACtET,UAAU,EAAE;IAAEO,KAAK,EAAE;EAAK,CAAC;EAC3BtB,aAAa,EAAE;IAAEsB,KAAK,EAAE,GAAG;IAAEC,KAAK,EAAE;MAAED,KAAK,EAAE,KAAK;MAAEE,IAAI,EAAE;IAAU;EAAE,CAAC;EACvE1B,WAAW,EAAE;IAAEwB,KAAK,EAAE,IAAI;IAAEC,KAAK,EAAE;MAAED,KAAK,EAAE,OAAO;MAAEE,IAAI,EAAE;IAAK;EAAE,CAAC;EACnEtB,UAAU,EAAE;IAAEoB,KAAK,EAAE,KAAK;IAAEC,KAAK,EAAE;MAAED,KAAK,EAAE,QAAQ;MAAEE,IAAI,EAAE;IAAK;EAAE,CAAC;EACpEN,QAAQ,EAAE;IAAEI,KAAK,EAAE;EAAG,CAAC;EACvBlB,WAAW,EAAE;IAAEkB,KAAK,EAAE,GAAG;IAAEC,KAAK,EAAE;MAAED,KAAK,EAAE,OAAO;MAAEE,IAAI,EAAE;IAAK;EAAE,CAAC;EAClElB,gBAAgB,EAAE;IAAEgB,KAAK,EAAE;EAAE,CAAC;EAC9BX,UAAU,EAAE,CAAC;IAAEc,KAAK,EAAE,IAAI;IAAEC,KAAK,EAAE;EAAO,CAAC,EAAE;IAAED,KAAK,EAAE,IAAI;IAAEC,KAAK,EAAE;EAAO,CAAC,EAAE;IAAED,KAAK,EAAE,IAAI;IAAEC,KAAK,EAAE;EAAO,CAAC,EAAE;IAAED,KAAK,EAAE,IAAI;IAAEC,KAAK,EAAE;EAAO,CAAC,EAAE;IAAED,KAAK,EAAE,IAAI;IAAEC,KAAK,EAAE;EAAO,CAAC,EAAE;IAAED,KAAK,EAAE,IAAI;IAAEC,KAAK,EAAE;EAAO,CAAC,CAAC;EAC5MC,UAAU,EAAE,CAAC;IAAEC,IAAI,EAAE,OAAO;IAAEC,KAAK,EAAE;EAAK,CAAC,EAAE;IAAED,IAAI,EAAE,OAAO;IAAEC,KAAK,EAAE;EAAK,CAAC,EAAE;IAAED,IAAI,EAAE,OAAO;IAAEC,KAAK,EAAE;EAAK,CAAC,EAAE;IAAED,IAAI,EAAE,OAAO;IAAEC,KAAK,EAAE;EAAK,CAAC,EAAE;IAAED,IAAI,EAAE,OAAO;IAAEC,KAAK,EAAE;EAAK,CAAC,EAAE;IAAED,IAAI,EAAE,OAAO;IAAEC,KAAK,EAAE;EAAK,CAAC,EAAE;IAAED,IAAI,EAAE,OAAO;IAAEC,KAAK,EAAE;EAAK,CAAC,CAAC;EAC5OrB,gBAAgB,EAAE,CAAC;IAAEsB,QAAQ,EAAE,IAAI;IAAED,KAAK,EAAE;EAAI,CAAC,EAAE;IAAEC,QAAQ,EAAE,IAAI;IAAED,KAAK,EAAE;EAAI,CAAC,EAAE;IAAEC,QAAQ,EAAE,IAAI;IAAED,KAAK,EAAE;EAAI,CAAC,CAAC;EAClHT,gBAAgB,EAAE,CAChB;IAAEW,EAAE,EAAE,CAAC;IAAEP,IAAI,EAAE,OAAO;IAAEQ,IAAI,EAAE,mBAAmB;IAAEC,IAAI,EAAE,OAAO;IAAEC,KAAK,EAAE;EAAU,CAAC,EACpF;IAAEH,EAAE,EAAE,CAAC;IAAEP,IAAI,EAAE,SAAS;IAAEQ,IAAI,EAAE,qBAAqB;IAAEC,IAAI,EAAE,OAAO;IAAEC,KAAK,EAAE;EAAU,CAAC,EACxF;IAAEH,EAAE,EAAE,CAAC;IAAEP,IAAI,EAAE,MAAM;IAAEQ,IAAI,EAAE,WAAW;IAAEC,IAAI,EAAE,MAAM;IAAEC,KAAK,EAAE;EAAU;AAE7E,CAAC;AAED,eAAeC,SAASA,CAACC,QAAQ,EAAEC,QAAQ,EAAEC,OAAM,GAAI,IAAI,EAAEC,YAAW,GAAI,IAAI,EAAE;EAChF,IAAI,CAACH,QAAQ,EAAE,OAAO;IAAEI,IAAI,EAAEH,QAAQ;IAAEI,MAAM,EAAE,KAAK;IAAEC,KAAK,EAAE,IAAI;IAAEpB,KAAK,EAAEiB,YAAW,IAAKF,QAAQ,EAAEf,KAAI,IAAKe;EAAS,CAAC;EACxH,IAAI;IACF,MAAMM,QAAO,GAAI,MAAM9D,KAAK,CAAC+D,GAAG,CAACR,QAAQ,CAAC;IAC1C,IAAIO,QAAQ,CAACH,IAAI,CAACK,IAAG,KAAM,CAAC,EAAE;MAC5B,IAAIC,OAAM,GAAIR,OAAM,GAAIK,QAAQ,CAACH,IAAI,CAACA,IAAI,CAACF,OAAO,IAAIK,QAAQ,CAACH,IAAI,CAACA,IAAI;MACxE,IAAIF,OAAM,IAAK,OAAOQ,OAAM,KAAM,WAAW,EAAEA,OAAM,GAAIH,QAAQ,CAACH,IAAI,CAACA,IAAI;MAC3E,OAAO;QAAEA,IAAI,EAAEM,OAAO;QAAEL,MAAM,EAAE,KAAK;QAAEC,KAAK,EAAE,KAAK;QAAEpB,KAAK,EAAEwB,OAAM,IAAKP;MAAa,CAAC;IACvF;IACA,OAAO;MAAEC,IAAI,EAAEH,QAAQ;MAAEI,MAAM,EAAE,IAAI;MAAEC,KAAK,EAAE,KAAK;MAAEpB,KAAK,EAAEiB,YAAW,IAAKF,QAAQ,EAAEf,KAAI,IAAKe;IAAS,CAAC;EAC3G,EAAE,OAAOU,KAAK,EAAE;IACd,OAAO;MAAEP,IAAI,EAAEH,QAAQ;MAAEI,MAAM,EAAE,IAAI;MAAEC,KAAK,EAAE,KAAK;MAAEpB,KAAK,EAAEiB,YAAW,IAAKF,QAAQ,EAAEf,KAAI,IAAKe;IAAS,CAAC;EAC3G;AACF;AAEA,eAAeW,qBAAqBA,CAAA,EAAG;EACrC,IAAI;IACF;IACA,MAAML,QAAO,GAAI,MAAM9D,KAAK,CAAC+D,GAAG,CAAClD,aAAa,CAACc,gBAAgB,CAAC;IAEhE,IAAImC,QAAQ,CAACH,IAAI,CAACK,IAAG,KAAM,KAAKI,KAAK,CAACC,OAAO,CAACP,QAAQ,CAACH,IAAI,CAACA,IAAI,CAAC,EAAE;MACjE;MACA,MAAMM,OAAM,GAAIH,QAAQ,CAACH,IAAI,CAACA,IAAI,CAACW,GAAG,CAACC,IAAG,KAAM;QAC9C;QACA;QACAC,IAAI,EAAGD,IAAI,CAACtB,QAAO,IAAKsB,IAAI,CAACC,IAAG,IAAK,EAAG;QACxC/B,KAAK,EAAE8B,IAAI,CAACE,UAAS,IAAKF,IAAI,CAACG,KAAI,IAAKH,IAAI,CAAC9B,KAAI,IAAK;MACxD,CAAC,CAAC,CAAC,CAACkC,MAAM,CAACJ,IAAG,IAAKA,IAAI,CAACC,IAAI,CAAC,EAAE;;MAE/B,OAAO;QAAEb,IAAI,EAAEM,OAAO;QAAEL,MAAM,EAAE,KAAK;QAAEC,KAAK,EAAE,KAAK;QAAEpB,KAAK,EAAEwB;MAAQ,CAAC;IACvE;;IAEA;IACA;IACA,MAAMW,cAAa,GAAI,MAAM5E,KAAK,CAAC+D,GAAG,CAAC9D,SAAS,CAAC2B,KAAK,CAACiD,YAAY,CAAC;IAEpE,IAAID,cAAc,CAACjB,IAAI,CAACK,IAAG,KAAM,KAAKI,KAAK,CAACC,OAAO,CAACO,cAAc,CAACjB,IAAI,CAACA,IAAI,CAAC,EAAE;MAC7E,MAAMmB,MAAK,GAAIF,cAAc,CAACjB,IAAI,CAACA,IAAI;MACvC,MAAMoB,WAAU,GAAI,CAAC,CAAC;MACtBD,MAAM,CAACE,OAAO,CAACpD,KAAI,IAAK;QACtB,MAAMqB,QAAO,GAAIrB,KAAK,CAACqB,QAAO,IAAKrB,KAAK,CAACqD,gBAAe,IAAKrD,KAAK,CAACsD,OAAO,EAAEC,SAAS,CAAC,CAAC,EAAE,CAAC,KAAK,IAAI;QACnG;QACA,IAAIlC,QAAO,IAAKA,QAAO,KAAM,IAAI,EAAE;UACjC8B,WAAW,CAAC9B,QAAQ,IAAI,CAAC8B,WAAW,CAAC9B,QAAQ,KAAK,CAAC,IAAI,CAAC;QAC1D;MACF,CAAC,CAAC;MACF,MAAMgB,OAAM,GAAImB,MAAM,CAACC,IAAI,CAACN,WAAW,CAAC,CAACT,GAAG,CAACgB,GAAE,KAAM;QAAEd,IAAI,EAAEc,GAAG;QAAE7C,KAAK,EAAEsC,WAAW,CAACO,GAAG;MAAE,CAAC,CAAC,CAAC;MAC7F,OAAO;QAAE3B,IAAI,EAAEM,OAAO;QAAEL,MAAM,EAAE,KAAK;QAAEC,KAAK,EAAE,KAAK;QAAEpB,KAAK,EAAEwB;MAAQ,CAAC;IACvE;IAEA,MAAM,IAAIsB,KAAK,CAAC,iCAAiC,CAAC;EACpD,EAAE,OAAOrB,KAAK,EAAE;IACdsB,OAAO,CAACC,IAAI,CAAC,sDAAsD,EAAEvB,KAAK,CAAC;IAC3E,OAAO;MAAEP,IAAI,EAAEnB,SAAS,CAACb,gBAAgB;MAAEiC,MAAM,EAAE,IAAI;MAAEC,KAAK,EAAE,KAAK;MAAEpB,KAAK,EAAED,SAAS,CAACb;IAAiB,CAAC;EAC5G;AACF;AAEA,eAAe+D,eAAeA,CAAA,EAAG;EAC/B,IAAI;IACF,MAAMnC,QAAO,GAAI1C,aAAa,CAACiB,UAAU;IACzC,IAAI,CAACyB,QAAQ,EAAE,OAAO;MAAEI,IAAI,EAAEnB,SAAS,CAACV,UAAU;MAAE8B,MAAM,EAAE,IAAI;MAAEC,KAAK,EAAE,IAAI;MAAEpB,KAAK,EAAED,SAAS,CAACV;IAAW,CAAC;IAC5G,MAAMgC,QAAO,GAAI,MAAM9D,KAAK,CAAC+D,GAAG,CAACR,QAAQ,CAAC;IAC1C,IAAIO,QAAQ,CAACH,IAAG,IAAKG,QAAQ,CAACH,IAAI,CAACK,IAAG,KAAM,KAAKI,KAAK,CAACC,OAAO,CAACP,QAAQ,CAACH,IAAI,CAACA,IAAI,CAAC,EAAE;MAClF,OAAO;QAAEA,IAAI,EAAEG,QAAQ,CAACH,IAAI,CAACA,IAAI,CAACW,GAAG,CAACC,IAAG,KAAM;UAAE3B,KAAK,EAAE2B,IAAI,CAAC3B,KAAI,IAAK2B,IAAI,CAACxB,IAAG,IAAK,EAAE;UAAEF,KAAK,EAAE0B,IAAI,CAAC1B,KAAI,IAAK0B,IAAI,CAACoB,MAAK,IAAK;QAAE,CAAC,CAAC,CAAC;QAAE/B,MAAM,EAAE,KAAK;QAAEC,KAAK,EAAE,KAAK;QAAEpB,KAAK,EAAEqB,QAAQ,CAACH,IAAI,CAACA;MAAK,CAAC;IAC5L;IACA,OAAO;MAAEA,IAAI,EAAEnB,SAAS,CAACV,UAAU;MAAE8B,MAAM,EAAE,IAAI;MAAEC,KAAK,EAAE,KAAK;MAAEpB,KAAK,EAAED,SAAS,CAACV;IAAW,CAAC;EAChG,EAAE,OAAOoC,KAAK,EAAE;IACd,OAAO;MAAEP,IAAI,EAAEnB,SAAS,CAACV,UAAU;MAAE8B,MAAM,EAAE,IAAI;MAAEC,KAAK,EAAE,KAAK;MAAEpB,KAAK,EAAED,SAAS,CAACV;IAAW,CAAC;EAChG;AACF;AAEA,eAAe8D,mBAAmBA,CAAA,EAAG;EACnC,IAAI;IACF,MAAMrC,QAAO,GAAI1C,aAAa,CAACmB,eAAc,IAAKnB,aAAa,CAACiC,UAAU;IAC1E,IAAI,CAACS,QAAQ,EAAE,OAAO;MAAEI,IAAI,EAAEnB,SAAS,CAACM,UAAU;MAAEc,MAAM,EAAE,IAAI;MAAEC,KAAK,EAAE,IAAI;MAAEpB,KAAK,EAAED,SAAS,CAACM;IAAW,CAAC;IAC5G,MAAMgB,QAAO,GAAI,MAAM9D,KAAK,CAAC+D,GAAG,CAACR,QAAQ,CAAC;IAC1C,IAAIO,QAAQ,CAACH,IAAG,IAAKG,QAAQ,CAACH,IAAI,CAACK,IAAG,KAAM,CAAC,EAAE;MAC7C,IAAI6B,UAAS,GAAIzB,KAAK,CAACC,OAAO,CAACP,QAAQ,CAACH,IAAI,CAACA,IAAI,IAAIG,QAAQ,CAACH,IAAI,CAACA,IAAG,GAAKG,QAAQ,CAACH,IAAI,CAACA,IAAI,EAAEA,IAAG,IAAK,EAAG;MAC1G,IAAIkC,UAAU,CAACC,MAAK,GAAI,CAAC,EAAE,OAAO;QAAEnC,IAAI,EAAEkC,UAAU,CAACvB,GAAG,CAACC,IAAG,KAAM;UAAExB,IAAI,EAAEwB,IAAI,CAACxB,IAAG,IAAKwB,IAAI,CAACwB,GAAE,IAAK,EAAE;UAAE/C,KAAK,EAAEuB,IAAI,CAACvB,KAAI,IAAKuB,IAAI,CAACG,KAAI,IAAK;QAAE,CAAC,CAAC,CAAC;QAAEd,MAAM,EAAE,KAAK;QAAEC,KAAK,EAAE,KAAK;QAAEpB,KAAK,EAAEoD;MAAW,CAAC;IACnM;IACA,OAAO;MAAElC,IAAI,EAAEnB,SAAS,CAACM,UAAU;MAAEc,MAAM,EAAE,IAAI;MAAEC,KAAK,EAAE,KAAK;MAAEpB,KAAK,EAAED,SAAS,CAACM;IAAW,CAAC;EAChG,EAAE,OAAOoB,KAAK,EAAE;IACd,OAAO;MAAEP,IAAI,EAAEnB,SAAS,CAACM,UAAU;MAAEc,MAAM,EAAE,IAAI;MAAEC,KAAK,EAAE,KAAK;MAAEpB,KAAK,EAAED,SAAS,CAACM;IAAW,CAAC;EAChG;AACF;AAEA,eAAe;EACb0B,IAAI,EAAE,gBAAgB;EACtBb,IAAIA,CAAA,EAAG;IACL,OAAO;MACLqC,eAAe,EAAE,MAAM;MACvBC,eAAe,EAAE,MAAM;MAEvBC,aAAa,EAAE,IAAI;MACnBC,eAAe,EAAE,IAAI;MACrBC,eAAe,EAAE,IAAI;MAErBC,cAAc,EAAE,EAAE;MAElBC,SAAS,EAAE,EAAE;MACbC,QAAQ,EAAE,EAAE;MACZC,WAAW,EAAE,EAAE;MAAE;;MAEjBC,aAAa,EAAE;QACb3F,UAAU,EAAE;UAAE2B,KAAK,EAAE;QAAE,CAAC;QAAEP,UAAU,EAAE;UAAEO,KAAK,EAAE;QAAE,CAAC;QAAEtB,aAAa,EAAE;UAAEsB,KAAK,EAAE;QAAE,CAAC;QAAExB,WAAW,EAAE;UAAEwB,KAAK,EAAE;QAAE,CAAC;QAC1GpB,UAAU,EAAE;UAAEoB,KAAK,EAAE;QAAE,CAAC;QAAEJ,QAAQ,EAAE;UAAEI,KAAK,EAAE;QAAE,CAAC;QAAElB,WAAW,EAAE;UAAEkB,KAAK,EAAE;QAAE,CAAC;QAAEhB,gBAAgB,EAAE;UAAEgB,KAAK,EAAE;QAAE,CAAC;QAC3GiE,UAAU,EAAE;UAAE9C,MAAM,EAAE;QAAM,CAAC;QAAEd,UAAU,EAAE;UAAEc,MAAM,EAAE;QAAM,CAAC;QAAEjC,gBAAgB,EAAE;UAAEgC,IAAI,EAAE;QAAG,CAAC;QAAEpB,gBAAgB,EAAE;UAAEoB,IAAI,EAAE;QAAG;MAC7H;IACF,CAAC;EACH,CAAC;EACDgD,OAAOA,CAAA,EAAG;IACR,IAAI,CAACC,WAAW,CAAC,CAAC,CAACC,IAAI,CAAC,MAAM;MAC5B,IAAI,CAACC,SAAS,CAAC,MAAM;QACnB,IAAI,CAACC,YAAY,CAAC,CAAC;QACnB,IAAI,CAACC,qBAAqB,CAAC,CAAC;QAC5B,IAAI,CAACC,qBAAqB,CAAC,CAAC;MAC9B,CAAC,CAAC;IACJ,CAAC,CAAC;IACFC,MAAM,CAACC,gBAAgB,CAAC,QAAQ,EAAE,IAAI,CAACC,YAAY,CAAC;EACtD,CAAC;EACDC,aAAaA,CAAA,EAAG;IACd,IAAI,IAAI,CAACnB,aAAa,EAAE;MACtB,IAAI,CAACA,aAAa,CAACoB,OAAO,CAAC,CAAC;MAC5B,IAAI,CAACpB,aAAY,GAAI,IAAI;IAC3B;IACA,IAAI,IAAI,CAACC,eAAe,EAAE;MACxB,IAAI,CAACA,eAAe,CAACmB,OAAO,CAAC,CAAC;MAC9B,IAAI,CAACnB,eAAc,GAAI,IAAI;IAC7B;IACA,IAAI,IAAI,CAACC,eAAe,EAAE;MACxB,IAAI,CAACA,eAAe,CAACkB,OAAO,CAAC,CAAC;MAC9B,IAAI,CAAClB,eAAc,GAAI,IAAI;IAC7B;IACAc,MAAM,CAACK,mBAAmB,CAAC,QAAQ,EAAE,IAAI,CAACH,YAAY,CAAC;EACzD,CAAC;EACDI,OAAO,EAAE;IACPJ,YAAYA,CAAA,EAAG;MACb,IAAI,IAAI,CAAClB,aAAa,EAAE,IAAI,CAACA,aAAa,CAACuB,MAAM,CAAC,CAAC;MACnD,IAAI,IAAI,CAACtB,eAAe,EAAE,IAAI,CAACA,eAAe,CAACsB,MAAM,CAAC,CAAC;MACvD,IAAI,IAAI,CAACrB,eAAe,EAAE,IAAI,CAACA,eAAe,CAACqB,MAAM,CAAC,CAAC;IACzD,CAAC;IACDC,YAAYA,CAACC,GAAG,EAAE;MAChB,IAAIA,GAAE,KAAMC,SAAQ,IAAKD,GAAE,KAAM,IAAI,EAAE,OAAO,GAAG;MACjD,MAAME,CAAA,GAAIC,MAAM,CAACH,GAAG,CAAC;MACrB,IAAII,KAAK,CAACF,CAAC,CAAC,EAAE,OAAO,GAAG;MACxB,IAAIA,CAAA,IAAK,KAAK,EAAE,OAAO,CAACA,CAAA,GAAI,KAAK,EAAEG,OAAO,CAAC,CAAC,IAAI,GAAG;MACnD,OAAOH,CAAC,CAACI,cAAc,CAAC,CAAC;IAC3B,CAAC;IAED,MAAMrB,WAAWA,CAAA,EAAG;MAClB;MACA,MAAMsB,OAAO,CAACC,GAAG,CAAC,CAChB,IAAI,CAACC,cAAc,CAAC,CAAC,EACrB,IAAI,CAACC,aAAa,CAAC,CAAC,EACpB,IAAI,CAACC,iBAAiB,CAAC,EAAE;MAAA,CAC1B,CAAC;;MAEF;MACA,MAAMJ,OAAO,CAACC,GAAG,CAAC,CAChB,IAAI,CAACI,cAAc,CAAC,CAAC,EACrB,IAAI,CAACC,cAAc,CAAC,CAAC;MACrB;MACA,IAAI,CAACC,eAAe,CAAC,CAAC,EACtB,IAAI,CAACC,cAAc,CAAC,CAAC,EACrB,IAAI,CAACC,YAAY,CAAC,CAAC,EACnB,IAAI,CAACC,eAAe,CAAC,CAAC,EACtB,IAAI,CAACC,oBAAoB,CAAC,CAAC,EAC3B,IAAI,CAACC,oBAAoB,CAAC,CAAC,EAC3B,IAAI,CAACC,oBAAoB,CAAC,EAC3B,CAAC;IACJ,CAAC;IAED,MAAMX,cAAcA,CAAA,EAAG;MACrB,IAAI;QACF,MAAMtE,QAAO,GAAI,MAAM9D,KAAK,CAAC+D,GAAG,CAAC9D,SAAS,CAAC2B,KAAK,CAACiD,YAAY,CAAC;QAC9D,IAAIf,QAAQ,CAACH,IAAI,CAACK,IAAG,KAAM,CAAC,EAAE;UAC5B,IAAI,CAACsC,SAAQ,GAAIxC,QAAQ,CAACH,IAAI,CAACA,IAAG,IAAK,EAAE;QAC3C;MACF,EAAE,OAAOqF,CAAC,EAAE;QACVxD,OAAO,CAACtB,KAAK,CAAC,wBAAwB,EAAE8E,CAAC,CAAC;QAC1C,IAAI,CAAC1C,SAAQ,GAAI,EAAE,EAAE;MACvB;IACF,CAAC;IAED,MAAM+B,aAAaA,CAAA,EAAG;MACpB,IAAI;QACF,MAAMvE,QAAO,GAAI,MAAM9D,KAAK,CAAC+D,GAAG,CAAC9D,SAAS,CAACkC,IAAI,CAAC8G,WAAW,CAAC;QAC5D,IAAInF,QAAQ,CAACH,IAAI,CAACK,IAAG,KAAM,CAAC,EAAE;UAC5B;UACA,IAAIhB,KAAI,GAAIc,QAAQ,CAACH,IAAI,CAACA,IAAI;UAC9B,IAAIX,KAAI,IAAKA,KAAK,CAACkG,IAAI,EAAElG,KAAI,GAAIA,KAAK,CAACkG,IAAI;UAC3C,IAAI,CAAC3C,QAAO,GAAInC,KAAK,CAACC,OAAO,CAACrB,KAAK,IAAIA,KAAI,GAAI,EAAE;QACnD;MACF,EAAE,OAAOgG,CAAC,EAAE;QACVxD,OAAO,CAACtB,KAAK,CAAC,uBAAuB,EAAE8E,CAAC,CAAC;QACzC,IAAI,CAACzC,QAAO,GAAI,EAAE;MACpB;IACF,CAAC;IAED,MAAMgC,cAAcA,CAAA,EAAG;MACnB;MACA,MAAMY,MAAK,GAAI,MAAM7F,SAAS,CAACzC,aAAa,CAACC,UAAU,EAAE0B,SAAS,CAAC1B,UAAU,EAAE,IAAI,EAAE,CAAC,CAAC;MACvF,IAAI,CAACqI,MAAM,CAACvF,MAAK,IAAK,CAACuF,MAAM,CAACtF,KAAK,EAAE;QAChC,IAAIpB,KAAI,GAAI0G,MAAM,CAAC1G,KAAK;QACxB,IAAI,OAAOA,KAAI,KAAM,QAAO,IAAKA,KAAI,KAAM,IAAI,EAAEA,KAAI,GAAIA,KAAK,CAAC3B,UAAS,IAAK2B,KAAK,CAACA,KAAI,IAAKA,KAAK,CAAC2G,KAAI,IAAK,CAAC;QAC5G,IAAI,CAAC3C,aAAa,CAAC3F,UAAS,GAAI;UAAE2B,KAAK;UAAEmB,MAAM,EAAE;QAAM,CAAC;MAC7D,OAAO;QACH;QACA,MAAMwF,KAAI,GAAI,IAAI,CAAC9C,SAAS,CAAC+C,MAAM,CAAC,CAACC,GAAG,EAAE1H,KAAK,KAAK0H,GAAE,IAAK1H,KAAK,CAAC+D,MAAK,IAAK,CAAC,CAAC,EAAE,CAAC,CAAC;QACjF,IAAI,CAACc,aAAa,CAAC3F,UAAS,GAAI;UAAE2B,KAAK,EAAE2G,KAAK;UAAExF,MAAM,EAAE,IAAI,CAAC0C,SAAS,CAACR,MAAK,KAAM;QAAE,CAAC;MACzF;IACJ,CAAC;IAED,MAAM0C,cAAcA,CAAA,EAAG;MACnB,IAAI,CAAC/B,aAAa,CAACvE,UAAS,GAAI;QAAEO,KAAK,EAAE,IAAI,CAAC8D,QAAQ,CAACT,MAAK,IAAKtD,SAAS,CAACN,UAAU,CAACO,KAAK;QAAEmB,MAAM,EAAE,IAAI,CAAC2C,QAAQ,CAACT,MAAK,KAAM;MAAE,CAAC;IACrI,CAAC;IAED,MAAM2C,eAAeA,CAAA,EAAG;MACpB,IAAI,CAAChC,aAAa,CAACxF,WAAU,GAAI;QAAEwB,KAAK,EAAE,IAAI,CAAC6D,SAAS,CAACR,MAAK,IAAKtD,SAAS,CAACvB,WAAW,CAACwB,KAAK;QAAEmB,MAAM,EAAE,IAAI,CAAC0C,SAAS,CAACR,MAAK,KAAM;MAAE,CAAC;IACzI,CAAC;IAED,MAAMwC,iBAAiBA,CAAA,EAAG;MACxB,IAAI;QACF,MAAMiB,GAAE,GAAI,MAAMvJ,KAAK,CAAC+D,GAAG,CAAC9D,SAAS,CAACuJ,OAAO,CAACC,cAAc,CAAC;QAC7D,IAAIF,GAAG,CAAC5F,IAAI,CAACK,IAAG,KAAM,CAAC,EAAE;UACvB,MAAM0F,QAAO,GAAIH,GAAG,CAAC5F,IAAI,CAACA,IAAG,IAAK,EAAE;UACpC,IAAI,CAAC6C,WAAU,GAAIkD,QAAQ,EAAE;UAC7B,IAAI,CAACjD,aAAa,CAACtF,aAAY,GAAI;YAAEsB,KAAK,EAAEiH,QAAQ,CAAC5D,MAAM;YAAElC,MAAM,EAAE;UAAM,CAAC;QAC9E;MACF,EAAE,OAAOM,KAAK,EAAE;QACdsB,OAAO,CAACtB,KAAK,CAAC,WAAW,EAAEA,KAAK,CAAC;MACnC;IACF,CAAC;IAED,MAAMwE,cAAcA,CAAA,EAAG;MACrB;MACA,IAAI,IAAI,CAACpC,SAAS,CAACR,MAAK,GAAI,CAAC,EAAE;QAC7B,MAAM6D,QAAO,GAAI,IAAIC,IAAI,CAAC,CAAC,CAACC,kBAAkB,CAAC,OAAO,EAAE;UAAEC,IAAI,EAAE,SAAS;UAAElH,KAAK,EAAE,SAAS;UAAEmD,GAAG,EAAE;QAAU,CAAC,CAAC,CAACgE,OAAO,CAAC,KAAK,EAAE,GAAG,CAAC;QAElI,MAAM1I,UAAS,GAAI,IAAI,CAACiF,SAAQ,CAC3B3B,MAAM,CAAC/C,KAAI,IAAK;UACf,MAAMoI,SAAQ,GAAIpI,KAAK,CAACoI,SAAQ,IAAKpI,KAAK,CAACqI,UAAU;UACrD,IAAI,CAACD,SAAS,EAAE,OAAO,KAAK;UAC5B,MAAME,SAAQ,GAAI,IAAIN,IAAI,CAACI,SAAS,CAAC,CAACH,kBAAkB,CAAC,OAAO,EAAE;YAAEC,IAAI,EAAE,SAAS;YAAElH,KAAK,EAAE,SAAS;YAAEmD,GAAG,EAAE;UAAU,CAAC,CAAC,CAACgE,OAAO,CAAC,KAAK,EAAE,GAAG,CAAC;UAC5I,OAAOG,SAAQ,KAAMP,QAAQ;QAC/B,CAAC,EACAN,MAAM,CAAC,CAACC,GAAG,EAAE1H,KAAK,KAAK0H,GAAE,IAAK1H,KAAK,CAAC+D,MAAK,IAAK,CAAC,CAAC,EAAE,CAAC,CAAC;QAEzD,IAAI,CAACc,aAAa,CAACpF,UAAS,GAAI;UAAEoB,KAAK,EAAEpB,UAAU;UAAEuC,MAAM,EAAE;QAAM,CAAC;MACtE,OAAO;QACL;QACC,IAAI,CAAC6C,aAAa,CAACpF,UAAS,GAAI;UAAEoB,KAAK,EAAED,SAAS,CAACnB,UAAU,CAACoB,KAAK;UAAEmB,MAAM,EAAE;QAAK,CAAC;MACtF;IACF,CAAC;IAED,MAAM+E,YAAYA,CAAA,EAAG;MAClB;MACA,IAAI,IAAI,CAACpC,QAAQ,CAACT,MAAK,GAAI,CAAC,EAAE;QAC7B,MAAM6D,QAAO,GAAI,IAAIC,IAAI,CAAC,CAAC,CAACC,kBAAkB,CAAC,OAAO,EAAE;UAAEC,IAAI,EAAE,SAAS;UAAElH,KAAK,EAAE,SAAS;UAAEmD,GAAG,EAAE;QAAU,CAAC,CAAC,CAACgE,OAAO,CAAC,KAAK,EAAE,GAAG,CAAC;QAElI,MAAMrF,KAAI,GAAI,IAAI,CAAC6B,QAAQ,CAAC5B,MAAM,CAACxC,IAAG,IAAK;UACvC,MAAMiB,IAAG,GAAIjB,IAAI,CAAC8H,UAAS,IAAK9H,IAAI,CAACgI,YAAY;UACjD,IAAI,CAAC/G,IAAI,EAAE,OAAO,KAAK;UACvB,MAAML,IAAG,GAAI,IAAI6G,IAAI,CAACxG,IAAI,CAAC,CAACyG,kBAAkB,CAAC,OAAO,EAAE;YAAEC,IAAI,EAAE,SAAS;YAAElH,KAAK,EAAE,SAAS;YAAEmD,GAAG,EAAE;UAAU,CAAC,CAAC,CAACgE,OAAO,CAAC,KAAK,EAAE,GAAG,CAAC;UAClI,OAAOhH,IAAG,KAAM4G,QAAQ;QAC5B,CAAC,CAAC,CAAC7D,MAAM;QAET,IAAI,CAACW,aAAa,CAACpE,QAAO,GAAI;UAAEI,KAAK,EAAEiC,KAAK;UAAEd,MAAM,EAAE;QAAM,CAAC;MAC9D,OAAO;QACL,IAAI,CAAC6C,aAAa,CAACpE,QAAO,GAAI;UAAEI,KAAK,EAAED,SAAS,CAACH,QAAQ,CAACI,KAAK;UAAEmB,MAAM,EAAE;QAAK,CAAC;MACjF;IACH,CAAC;IAED,MAAMgF,eAAeA,CAAA,EAAG;MACtB;MACA,IAAI,IAAI,CAACtC,SAAS,CAACR,MAAK,GAAI,CAAC,EAAE;QAC7B,MAAM6D,QAAO,GAAI,IAAIC,IAAI,CAAC,CAAC,CAACC,kBAAkB,CAAC,OAAO,EAAE;UAAEC,IAAI,EAAE,SAAS;UAAElH,KAAK,EAAE,SAAS;UAAEmD,GAAG,EAAE;QAAU,CAAC,CAAC,CAACgE,OAAO,CAAC,KAAK,EAAE,GAAG,CAAC;QAElI,MAAMrF,KAAI,GAAI,IAAI,CAAC4B,SAAS,CAAC3B,MAAM,CAAC/C,KAAI,IAAK;UACzC,MAAMoI,SAAQ,GAAIpI,KAAK,CAACoI,SAAQ,IAAKpI,KAAK,CAACqI,UAAU;UACrD,IAAI,CAACD,SAAS,EAAE,OAAO,KAAK;UAC5B,MAAME,SAAQ,GAAI,IAAIN,IAAI,CAACI,SAAS,CAAC,CAACH,kBAAkB,CAAC,OAAO,EAAE;YAAEC,IAAI,EAAE,SAAS;YAAElH,KAAK,EAAE,SAAS;YAAEmD,GAAG,EAAE;UAAU,CAAC,CAAC,CAACgE,OAAO,CAAC,KAAK,EAAE,GAAG,CAAC;UAC5I,OAAOG,SAAQ,KAAMP,QAAQ;QACjC,CAAC,CAAC,CAAC7D,MAAM;QAET,IAAI,CAACW,aAAa,CAAClF,WAAU,GAAI;UAAEkB,KAAK,EAAEiC,KAAK;UAAEd,MAAM,EAAE;QAAM,CAAC;MAClE,OAAO;QACJ,IAAI,CAAC6C,aAAa,CAAClF,WAAU,GAAI;UAAEkB,KAAK,EAAED,SAAS,CAACjB,WAAW,CAACkB,KAAK;UAAEmB,MAAM,EAAE;QAAK,CAAC;MACxF;IACF,CAAC;IAED,MAAMiF,oBAAoBA,CAAA,EAAG;MAC3B,MAAMM,MAAK,GAAI,MAAM7F,SAAS,CAACzC,aAAa,CAACY,gBAAgB,EAAEe,SAAS,CAACf,gBAAgB,EAAE,IAAI,EAAE,CAAC,CAAC;MACnG,IAAI,CAACgF,aAAa,CAAChF,gBAAe,GAAI;QAAEgB,KAAK,EAAE0G,MAAM,CAAC1G,KAAK;QAAEmB,MAAM,EAAEuF,MAAM,CAACvF;MAAO,CAAC;IACtF,CAAC;IAED;IACA,MAAMwG,uBAAuBA,CAACC,KAAK,EAAE;MACjC;MACA,IAAI;QACA,MAAMC,GAAE,GAAID,KAAI,KAAM,MAAK,GAAIpK,SAAS,CAAC2B,KAAK,CAAC2I,mBAAkB,GAAItK,SAAS,CAAC2B,KAAK,CAAC4I,oBAAoB;QACzG,MAAM1G,QAAO,GAAI,MAAM9D,KAAK,CAAC+D,GAAG,CAACuG,GAAG,CAAC;QAErC,IAAIxG,QAAQ,CAACH,IAAI,CAACK,IAAG,KAAM,KAAKI,KAAK,CAACC,OAAO,CAACP,QAAQ,CAACH,IAAI,CAACA,IAAI,CAAC,EAAE;UAC/D,MAAM8G,MAAK,GAAI,EAAE;UACjB,MAAMC,MAAK,GAAI,EAAE;UAEjB5G,QAAQ,CAACH,IAAI,CAACA,IAAI,CAACqB,OAAO,CAACT,IAAG,IAAK;YAC/B;YACA;YACA,MAAMoG,OAAM,GAAI,IAAIf,IAAI,CAACrF,IAAI,CAACxB,IAAI,CAAC;YACnC,MAAM6H,KAAI,GAAID,OAAO,CAACd,kBAAkB,CAAC,OAAO,EAAE;cAAEjH,KAAK,EAAE,SAAS;cAAEmD,GAAG,EAAE;YAAU,CAAC,CAAC;YAEvF0E,MAAM,CAACI,IAAI,CAACD,KAAK,CAAC;YAClBF,MAAM,CAACG,IAAI,CAACtG,IAAI,CAACuG,WAAU,IAAK,CAAC,CAAC;UACtC,CAAC,CAAC;UAEF,OAAO;YAAEL,MAAM;YAAEC;UAAO,CAAC;QAC7B;MACJ,EAAE,OAAOxG,KAAK,EAAE;QACZsB,OAAO,CAACtB,KAAK,CAAC,8BAA8B,EAAEA,KAAK,CAAC;MACxD;;MAEA;MACAsB,OAAO,CAACC,IAAI,CAAC,sDAAsD,CAAC;MACpE,MAAMsF,GAAE,GAAI,IAAInB,IAAI,CAAC,CAAC;MACtB,MAAMa,MAAK,GAAI,EAAE;MACjB,MAAMC,MAAK,GAAI,EAAE;MACjB,MAAMM,OAAM,GAAI,IAAIC,GAAG,CAAC,CAAC;MAEzB,IAAIZ,KAAI,KAAM,MAAM,EAAE;QAClB;QACA,MAAMtE,GAAE,GAAIgF,GAAG,CAACG,MAAM,CAAC,KAAK,CAAC,EAAE;QAC/B,MAAMC,WAAU,GAAI,IAAIvB,IAAI,CAACmB,GAAG,CAAC;QACjCI,WAAW,CAACC,OAAO,CAACL,GAAG,CAACM,OAAO,CAAC,IAAItF,GAAE,GAAI,CAAC,CAAC,EAAE;QAC9CoF,WAAW,CAACG,QAAQ,CAAC,CAAC,EAAC,CAAC,EAAC,CAAC,EAAC,CAAC,CAAC;QAE7B,KAAK,IAAIC,CAAA,GAAI,CAAC,EAAEA,CAAA,GAAI,CAAC,EAAEA,CAAC,EAAE,EAAE;UACxB,MAAMC,CAAA,GAAI,IAAI5B,IAAI,CAACuB,WAAW,CAAC;UAC/BK,CAAC,CAACJ,OAAO,CAACD,WAAW,CAACE,OAAO,CAAC,IAAIE,CAAC,CAAC;UACpC,MAAMX,KAAI,GAAIY,CAAC,CAAC3B,kBAAkB,CAAC,OAAO,EAAE;YAAEjH,KAAK,EAAE,SAAS;YAAEmD,GAAG,EAAE;UAAU,CAAC,CAAC;UACjF,MAAMT,GAAE,GAAIkG,CAAC,CAAC3B,kBAAkB,CAAC,OAAO,EAAE;YAAEC,IAAI,EAAE,SAAS;YAAElH,KAAK,EAAE,SAAS;YAAEmD,GAAG,EAAE;UAAU,CAAC,CAAC,CAACgE,OAAO,CAAC,KAAK,EAAE,GAAG,CAAC;UACpHU,MAAM,CAACI,IAAI,CAACD,KAAK,CAAC;UAClBI,OAAO,CAACS,GAAG,CAACnG,GAAG,EAAE,CAAC,CAAC;QACvB;MACJ,OAAO;QACH;QACA,MAAMoG,YAAW,GAAI,IAAI9B,IAAI,CAACmB,GAAG,CAACY,WAAW,CAAC,CAAC,EAAEZ,GAAG,CAACa,QAAQ,CAAC,CAAC,EAAE,CAAC,CAAC;QACnE,MAAMC,WAAU,GAAI,IAAIjC,IAAI,CAACmB,GAAG,CAACY,WAAW,CAAC,CAAC,EAAEZ,GAAG,CAACa,QAAQ,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC,CAACP,OAAO,CAAC,CAAC;QAEhF,KAAK,IAAIE,CAAA,GAAI,CAAC,EAAEA,CAAA,IAAKM,WAAW,EAAEN,CAAC,EAAE,EAAE;UAClC,MAAMC,CAAA,GAAI,IAAI5B,IAAI,CAACmB,GAAG,CAACY,WAAW,CAAC,CAAC,EAAEZ,GAAG,CAACa,QAAQ,CAAC,CAAC,EAAEL,CAAC,CAAC;UACxD,MAAMX,KAAI,GAAIY,CAAC,CAAC3B,kBAAkB,CAAC,OAAO,EAAE;YAAEjH,KAAK,EAAE,SAAS;YAAEmD,GAAG,EAAE;UAAU,CAAC,CAAC;UACjF,MAAMT,GAAE,GAAIkG,CAAC,CAAC3B,kBAAkB,CAAC,OAAO,EAAE;YAAEC,IAAI,EAAE,SAAS;YAAElH,KAAK,EAAE,SAAS;YAAEmD,GAAG,EAAE;UAAU,CAAC,CAAC,CAACgE,OAAO,CAAC,KAAK,EAAE,GAAG,CAAC;UACpHU,MAAM,CAACI,IAAI,CAACD,KAAK,CAAC;UAClBI,OAAO,CAACS,GAAG,CAACnG,GAAG,EAAE,CAAC,CAAC;QACxB;MACJ;;MAEA;MACA,IAAI,CAACgB,SAAS,CAACtB,OAAO,CAACpD,KAAI,IAAK;QAC5B,MAAMwB,IAAG,GAAIxB,KAAK,CAACoI,SAAQ,IAAKpI,KAAK,CAACqI,UAAU;QAChD,IAAI7G,IAAI,EAAE;UACN,MAAMoI,CAAA,GAAI,IAAI5B,IAAI,CAACxG,IAAI,CAAC;UACxB,MAAMkC,GAAE,GAAIkG,CAAC,CAAC3B,kBAAkB,CAAC,OAAO,EAAE;YAAEC,IAAI,EAAE,SAAS;YAAElH,KAAK,EAAE,SAAS;YAAEmD,GAAG,EAAE;UAAU,CAAC,CAAC,CAACgE,OAAO,CAAC,KAAK,EAAE,GAAG,CAAC;UACpH,IAAIiB,OAAO,CAACc,GAAG,CAACxG,GAAG,CAAC,EAAE;YAClB0F,OAAO,CAACS,GAAG,CAACnG,GAAG,EAAE0F,OAAO,CAACjH,GAAG,CAACuB,GAAG,IAAI,CAAC,CAAC;UAC1C;QACJ;MACJ,CAAC,CAAC;MAEF,OAAO;QAAEmF,MAAM;QAAEC,MAAM,EAAEtG,KAAK,CAAC2H,IAAI,CAACf,OAAO,CAACN,MAAM,CAAC,CAAC;MAAE,CAAC;IAC3D,CAAC;IAED;IACA,MAAMsB,uBAAuBA,CAAC3B,KAAK,EAAE;MACjC;MACA,IAAI;QACA,MAAMC,GAAE,GAAID,KAAI,KAAM,MAAK,GAAIpK,SAAS,CAACkC,IAAI,CAAC8J,mBAAkB,GAAIhM,SAAS,CAACkC,IAAI,CAAC+J,oBAAoB;QACvG,MAAMpI,QAAO,GAAI,MAAM9D,KAAK,CAAC+D,GAAG,CAACuG,GAAG,CAAC;QAErC,IAAIxG,QAAQ,CAACH,IAAI,CAACK,IAAG,KAAM,KAAKI,KAAK,CAACC,OAAO,CAACP,QAAQ,CAACH,IAAI,CAACA,IAAI,CAAC,EAAE;UAC/D,MAAM8G,MAAK,GAAI,EAAE;UACjB,MAAMC,MAAK,GAAI,EAAE;UAEjB5G,QAAQ,CAACH,IAAI,CAACA,IAAI,CAACqB,OAAO,CAACT,IAAG,IAAK;YAC/B,MAAMoG,OAAM,GAAI,IAAIf,IAAI,CAACrF,IAAI,CAACxB,IAAI,CAAC;YACnC,MAAM6H,KAAI,GAAID,OAAO,CAACd,kBAAkB,CAAC,OAAO,EAAE;cAAEjH,KAAK,EAAE,SAAS;cAAEmD,GAAG,EAAE;YAAU,CAAC,CAAC;YAEvF0E,MAAM,CAACI,IAAI,CAACD,KAAK,CAAC;YAClBF,MAAM,CAACG,IAAI,CAACtG,IAAI,CAAC4H,SAAQ,IAAK,CAAC,CAAC;UACpC,CAAC,CAAC;UAEF,OAAO;YAAE1B,MAAM;YAAEC;UAAO,CAAC;QAC7B;MACJ,EAAE,OAAOxG,KAAK,EAAE;QACZsB,OAAO,CAACtB,KAAK,CAAC,oCAAoC,EAAEA,KAAK,CAAC;MAC9D;;MAEA;MACAsB,OAAO,CAACC,IAAI,CAAC,sDAAsD,CAAC;MACpE,MAAMsF,GAAE,GAAI,IAAInB,IAAI,CAAC,CAAC;MACtB,MAAMa,MAAK,GAAI,EAAE;MACjB,MAAMO,OAAM,GAAI,IAAIC,GAAG,CAAC,CAAC;MAEzB,IAAIZ,KAAI,KAAM,MAAM,EAAE;QAClB,MAAMtE,GAAE,GAAIgF,GAAG,CAACG,MAAM,CAAC,KAAK,CAAC;QAC7B,MAAMC,WAAU,GAAI,IAAIvB,IAAI,CAACmB,GAAG,CAAC;QACjCI,WAAW,CAACC,OAAO,CAACL,GAAG,CAACM,OAAO,CAAC,IAAItF,GAAE,GAAI,CAAC,CAAC;QAC5CoF,WAAW,CAACG,QAAQ,CAAC,CAAC,EAAC,CAAC,EAAC,CAAC,EAAC,CAAC,CAAC;QAE7B,KAAK,IAAIC,CAAA,GAAI,CAAC,EAAEA,CAAA,GAAI,CAAC,EAAEA,CAAC,EAAE,EAAE;UACxB,MAAMC,CAAA,GAAI,IAAI5B,IAAI,CAACuB,WAAW,CAAC;UAC/BK,CAAC,CAACJ,OAAO,CAACD,WAAW,CAACE,OAAO,CAAC,IAAIE,CAAC,CAAC;UACpC,MAAMX,KAAI,GAAIY,CAAC,CAAC3B,kBAAkB,CAAC,OAAO,EAAE;YAAEjH,KAAK,EAAE,SAAS;YAAEmD,GAAG,EAAE;UAAU,CAAC,CAAC;UACjF,MAAMT,GAAE,GAAIkG,CAAC,CAAC3B,kBAAkB,CAAC,OAAO,EAAE;YAAEC,IAAI,EAAE,SAAS;YAAElH,KAAK,EAAE,SAAS;YAAEmD,GAAG,EAAE;UAAU,CAAC,CAAC,CAACgE,OAAO,CAAC,KAAK,EAAE,GAAG,CAAC;UACpHU,MAAM,CAACI,IAAI,CAACD,KAAK,CAAC;UAClBI,OAAO,CAACS,GAAG,CAACnG,GAAG,EAAE,CAAC,CAAC;QACvB;MACJ,OAAO;QACH,MAAMuG,WAAU,GAAI,IAAIjC,IAAI,CAACmB,GAAG,CAACY,WAAW,CAAC,CAAC,EAAEZ,GAAG,CAACa,QAAQ,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC,CAACP,OAAO,CAAC,CAAC;QAChF,KAAK,IAAIE,CAAA,GAAI,CAAC,EAAEA,CAAA,IAAKM,WAAW,EAAEN,CAAC,EAAE,EAAE;UAClC,MAAMC,CAAA,GAAI,IAAI5B,IAAI,CAACmB,GAAG,CAACY,WAAW,CAAC,CAAC,EAAEZ,GAAG,CAACa,QAAQ,CAAC,CAAC,EAAEL,CAAC,CAAC;UACxD,MAAMX,KAAI,GAAIY,CAAC,CAAC3B,kBAAkB,CAAC,OAAO,EAAE;YAAEjH,KAAK,EAAE,SAAS;YAAEmD,GAAG,EAAE;UAAU,CAAC,CAAC;UACjF,MAAMT,GAAE,GAAIkG,CAAC,CAAC3B,kBAAkB,CAAC,OAAO,EAAE;YAAEC,IAAI,EAAE,SAAS;YAAElH,KAAK,EAAE,SAAS;YAAEmD,GAAG,EAAE;UAAU,CAAC,CAAC,CAACgE,OAAO,CAAC,KAAK,EAAE,GAAG,CAAC;UACpHU,MAAM,CAACI,IAAI,CAACD,KAAK,CAAC;UAClBI,OAAO,CAACS,GAAG,CAACnG,GAAG,EAAE,CAAC,CAAC;QACxB;MACJ;MAEA,IAAI,CAACiB,QAAQ,CAACvB,OAAO,CAAC7C,IAAG,IAAK;QAC1B,MAAMiB,IAAG,GAAIjB,IAAI,CAAC8H,UAAS,IAAK9H,IAAI,CAACgI,YAAY;QACjD,IAAI/G,IAAI,EAAE;UACN,MAAMoI,CAAA,GAAI,IAAI5B,IAAI,CAACxG,IAAI,CAAC;UACxB,MAAMkC,GAAE,GAAIkG,CAAC,CAAC3B,kBAAkB,CAAC,OAAO,EAAE;YAAEC,IAAI,EAAE,SAAS;YAAElH,KAAK,EAAE,SAAS;YAAEmD,GAAG,EAAE;UAAU,CAAC,CAAC,CAACgE,OAAO,CAAC,KAAK,EAAE,GAAG,CAAC;UACpH,IAAIiB,OAAO,CAACc,GAAG,CAACxG,GAAG,CAAC,EAAE;YAClB0F,OAAO,CAACS,GAAG,CAACnG,GAAG,EAAE0F,OAAO,CAACjH,GAAG,CAACuB,GAAG,IAAI,CAAC,CAAC;UAC1C;QACJ;MACJ,CAAC,CAAC;MAEF,OAAO;QAAEmF,MAAM;QAAEC,MAAM,EAAEtG,KAAK,CAAC2H,IAAI,CAACf,OAAO,CAACN,MAAM,CAAC,CAAC;MAAE,CAAC;IAC3D,CAAC;IAED,MAAM1D,qBAAqBA,CAAA,EAAG;MAC1B,MAAMrD,IAAG,GAAI,MAAM,IAAI,CAACyG,uBAAuB,CAAC,IAAI,CAACpE,eAAe,CAAC;MAErE,IAAI,CAACrC,IAAG,IAAK,CAACA,IAAI,CAAC8G,MAAK,IAAK,CAAC9G,IAAI,CAAC+G,MAAM,EAAE;QACvClF,OAAO,CAACC,IAAI,CAAC,wCAAwC,CAAC;QACtD;MACJ;MAEA,IAAI,CAAC,IAAI,CAACU,eAAe,EAAE;QACtB,MAAMiG,GAAE,GAAIC,QAAQ,CAACC,cAAc,CAAC,mBAAmB,CAAC;QACxD,IAAI,CAACF,GAAG,EAAE;QACV;QACA,MAAMG,gBAAe,GAAIrM,OAAO,CAACsM,gBAAgB,CAACJ,GAAG,CAAC;QACtD,IAAIG,gBAAgB,EAAEA,gBAAgB,CAACjF,OAAO,CAAC,CAAC;QAChD,IAAI,CAACnB,eAAc,GAAIjG,OAAO,CAACuM,IAAI,CAACL,GAAG,CAAC;MAC7C;MAEA,MAAMM,MAAK,GAAI;QACXC,OAAO,EAAE;UACLC,OAAO,EAAE,MAAM;UACfC,SAAS,EAAE;QACf,CAAC;QACDC,IAAI,EAAE;UAAEC,IAAI,EAAE,IAAI;UAAEC,KAAK,EAAE,IAAI;UAAEC,MAAM,EAAE,IAAI;UAAEC,YAAY,EAAE;QAAK,CAAC;QACnEC,KAAK,EAAE;UACHxK,IAAI,EAAE,UAAU;UAChByK,WAAW,EAAE,KAAK;UAClBzJ,IAAI,EAAEA,IAAI,CAAC8G,MAAM;UACjB4C,QAAQ,EAAE;YAAEC,IAAI,EAAE;UAAM,CAAC;UACzBC,QAAQ,EAAE;YAAED,IAAI,EAAE;UAAM;QAC5B,CAAC;QACDE,KAAK,EAAE;UACH7K,IAAI,EAAE,OAAO;UACb8K,SAAS,EAAE;YAAEC,SAAS,EAAE;cAAE/K,IAAI,EAAE;YAAS;UAAE;QAC/C,CAAC;QACDgL,MAAM,EAAE,CAAC;UACLnJ,IAAI,EAAE,KAAK;UACX7B,IAAI,EAAE,MAAM;UACZiL,MAAM,EAAE,IAAI;UAAE;UACdjK,IAAI,EAAEA,IAAI,CAAC+G,MAAM;UACjBmD,SAAS,EAAE;YACPxK,KAAK,EAAE,IAAInD,OAAO,CAAC4N,OAAO,CAACC,cAAc,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CACpD;cAAEC,MAAM,EAAE,CAAC;cAAE3K,KAAK,EAAE;YAA0B,CAAC,EAC/C;cAAE2K,MAAM,EAAE,CAAC;cAAE3K,KAAK,EAAE;YAA0B,EAC/C;UACL,CAAC;UACD4K,SAAS,EAAE;YAAE5K,KAAK,EAAE;UAAU;QAClC,CAAC;MACL,CAAC;MACD;MACA,IAAIM,IAAI,CAAC+G,MAAM,CAACwD,IAAI,CAACC,CAAA,IAAKA,CAAA,KAAMvG,SAAQ,IAAKuG,CAAA,KAAM,IAAI,CAAC,EAAE;QACrD3I,OAAO,CAACC,IAAI,CAAC,2CAA2C,EAAE9B,IAAI,CAAC+G,MAAM,CAAC;QACtE;QACAgC,MAAM,CAACiB,MAAM,CAAC,CAAC,CAAC,CAAChK,IAAG,GAAIA,IAAI,CAAC+G,MAAM,CAACpG,GAAG,CAAC6J,CAAA,IAAKA,CAAA,IAAK,CAAC,CAAC;MACzD;MAEA,IAAI,CAAChI,eAAe,CAACiI,SAAS,CAAC1B,MAAM,CAAC;IAC1C,CAAC;IAED,MAAMzF,qBAAqBA,CAAA,EAAG;MAC1B,MAAMtD,IAAG,GAAI,MAAM,IAAI,CAACqI,uBAAuB,CAAC,IAAI,CAAC/F,eAAe,CAAC;MAErE,IAAI,CAACtC,IAAG,IAAK,CAACA,IAAI,CAAC8G,MAAK,IAAK,CAAC9G,IAAI,CAAC+G,MAAM,EAAE;QACtClF,OAAO,CAACC,IAAI,CAAC,wCAAwC,CAAC;QACtD;MACL;MAEA,IAAI,CAAC,IAAI,CAACW,eAAe,EAAE;QACtB,MAAMgG,GAAE,GAAIC,QAAQ,CAACC,cAAc,CAAC,mBAAmB,CAAC;QACxD,IAAI,CAACF,GAAG,EAAE;QACV,MAAMG,gBAAe,GAAIrM,OAAO,CAACsM,gBAAgB,CAACJ,GAAG,CAAC;QACtD,IAAIG,gBAAgB,EAAEA,gBAAgB,CAACjF,OAAO,CAAC,CAAC;QAChD,IAAI,CAAClB,eAAc,GAAIlG,OAAO,CAACuM,IAAI,CAACL,GAAG,CAAC;MAC7C;MAEA,MAAMM,MAAK,GAAI;QACXC,OAAO,EAAE;UACLC,OAAO,EAAE,MAAM;UACfC,SAAS,EAAE;QACf,CAAC;QACDC,IAAI,EAAE;UAAEC,IAAI,EAAE,IAAI;UAAEC,KAAK,EAAE,IAAI;UAAEC,MAAM,EAAE,IAAI;UAAEC,YAAY,EAAE;QAAK,CAAC;QACnEC,KAAK,EAAE;UACHxK,IAAI,EAAE,UAAU;UAChByK,WAAW,EAAE,KAAK;UAClBzJ,IAAI,EAAEA,IAAI,CAAC8G,MAAM;UACjB4C,QAAQ,EAAE;YAAEC,IAAI,EAAE;UAAM,CAAC;UACzBC,QAAQ,EAAE;YAAED,IAAI,EAAE;UAAM;QAC5B,CAAC;QACDE,KAAK,EAAE;UACH7K,IAAI,EAAE,OAAO;UACb8K,SAAS,EAAE;YAAEC,SAAS,EAAE;cAAE/K,IAAI,EAAE;YAAS;UAAE;QAC/C,CAAC;QACDgL,MAAM,EAAE,CAAC;UACLnJ,IAAI,EAAE,MAAM;UACZ7B,IAAI,EAAE,MAAM;UACZiL,MAAM,EAAE,IAAI;UACZjK,IAAI,EAAEA,IAAI,CAAC+G,MAAM;UACjBmD,SAAS,EAAE;YACPxK,KAAK,EAAE,IAAInD,OAAO,CAAC4N,OAAO,CAACC,cAAc,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CACpD;cAAEC,MAAM,EAAE,CAAC;cAAE3K,KAAK,EAAE;YAAwB,CAAC,EAC7C;cAAE2K,MAAM,EAAE,CAAC;cAAE3K,KAAK,EAAE;YAAwB,EAC7C;UACL,CAAC;UACD4K,SAAS,EAAE;YAAE5K,KAAK,EAAE;UAAU;QAClC,CAAC;MACL,CAAC;MAED,IAAIM,IAAI,CAAC+G,MAAM,CAACwD,IAAI,CAACC,CAAA,IAAKA,CAAA,KAAMvG,SAAQ,IAAKuG,CAAA,KAAM,IAAI,CAAC,EAAE;QACrDzB,MAAM,CAACiB,MAAM,CAAC,CAAC,CAAC,CAAChK,IAAG,GAAIA,IAAI,CAAC+G,MAAM,CAACpG,GAAG,CAAC6J,CAAA,IAAKA,CAAA,IAAK,CAAC,CAAC;MACzD;MAEA,IAAI,CAAC/H,eAAe,CAACgI,SAAS,CAAC1B,MAAM,CAAC;IAC1C,CAAC;IAED;IACA2B,qBAAqBA,CAAC7J,IAAI,EAAE;MAC1B,IAAI,CAACA,IAAI,EAAE,OAAO,EAAE;MACpB,IAAI8J,UAAS,GAAI9J,IAAI,CAAC+J,IAAI,CAAC,CAAC;MAC5B,MAAMxJ,WAAU,GAAI;QAClB,IAAI,EAAE,KAAK;QAAE,IAAI,EAAE,KAAK;QAAE,IAAI,EAAE,KAAK;QAAE,IAAI,EAAE,KAAK;QAClD,IAAI,EAAE,KAAK;QAAE,IAAI,EAAE,KAAK;QAAE,IAAI,EAAE,KAAK;QAAE,IAAI,EAAE,KAAK;QAAE,KAAK,EAAE,MAAM;QACjE,IAAI,EAAE,KAAK;QAAE,IAAI,EAAE,KAAK;QAAE,IAAI,EAAE,KAAK;QAAE,IAAI,EAAE,KAAK;QAAE,IAAI,EAAE,KAAK;QAAE,IAAI,EAAE,KAAK;QAC5E,IAAI,EAAE,KAAK;QAAE,IAAI,EAAE,KAAK;QAAE,IAAI,EAAE,KAAK;QAAE,IAAI,EAAE,KAAK;QAAE,IAAI,EAAE,KAAK;QAC/D,IAAI,EAAE,KAAK;QAAE,IAAI,EAAE,KAAK;QAAE,IAAI,EAAE,KAAK;QAAE,IAAI,EAAE,KAAK;QAAE,IAAI,EAAE,KAAK;QAAE,IAAI,EAAE,KAAK;QAAE,IAAI,EAAE,KAAK;QACzF,KAAK,EAAE,QAAQ;QAAE,IAAI,EAAE,SAAS;QAAE,IAAI,EAAE,OAAO;QAAE,IAAI,EAAE,SAAS;QAAE,IAAI,EAAE,UAAU;QAClF,IAAI,EAAE,SAAS;QAAE,IAAI,EAAE;MACzB,CAAC;MACD,IAAIK,MAAM,CAACsF,MAAM,CAAC3F,WAAW,CAAC,CAACyJ,QAAQ,CAACF,UAAU,CAAC,EAAE,OAAOA,UAAU;MACtE,IAAIvJ,WAAW,CAACuJ,UAAU,CAAC,EAAE,OAAOvJ,WAAW,CAACuJ,UAAU,CAAC;MAC3D,KAAK,MAAM,CAAChJ,GAAG,EAAE7C,KAAK,KAAK2C,MAAM,CAACqJ,OAAO,CAAC1J,WAAW,CAAC,EAAE;QACtD,IAAIuJ,UAAU,CAACI,UAAU,CAACpJ,GAAG,CAAC,EAAE,OAAO7C,KAAK;MAC9C;MACA,OAAO6L,UAAU;IACnB,CAAC;IAED,MAAMxF,oBAAoBA,CAAA,EAAG;MACzB;MACA,MAAM/D,WAAU,GAAI,CAAC,CAAC;MACtB,IAAI,CAACuB,SAAS,CAACtB,OAAO,CAACpD,KAAI,IAAK;QAC3B,MAAMqB,QAAO,GAAIrB,KAAK,CAACqB,QAAO,IAAKrB,KAAK,CAACqD,gBAAe,IAAK,CAACrD,KAAK,CAAC+M,eAAc,IAAK,EAAE,EAAExJ,SAAS,CAAC,CAAC,EAAE,CAAC,CAAC;QAC1G,IAAIlC,QAAQ,EAAE;UACV,MAAMqL,UAAS,GAAI,IAAI,CAACD,qBAAqB,CAACpL,QAAQ,CAAC;UACvD,IAAIqL,UAAU,EAAE;YACZvJ,WAAW,CAACuJ,UAAU,IAAI,CAACvJ,WAAW,CAACuJ,UAAU,KAAK,CAAC,IAAI,CAAC;UAChE;QACJ;MACL,CAAC,CAAC;MAEF,MAAM3K,IAAG,GAAIyB,MAAM,CAACC,IAAI,CAACN,WAAW,CAAC,CAACT,GAAG,CAACgB,GAAE,KAAM;QAAEd,IAAI,EAAEc,GAAG;QAAE7C,KAAK,EAAEsC,WAAW,CAACO,GAAG;MAAE,CAAC,CAAC,CAAC;MAC1F,IAAI,CAACe,cAAa,GAAI1C,IAAI;MAC1B,IAAI,CAAC8C,aAAa,CAAC9E,gBAAe,GAAI;QAAEgC,IAAI;QAAEC,MAAM,EAAE;MAAM,CAAC;MAE7D,IAAI,CAACkD,SAAS,CAAC,MAAM;QAAE,IAAI,CAACC,YAAY,CAAC,CAAC;MAAE,CAAC,CAAC;IAClD,CAAC;IAED,MAAMgC,oBAAoBA,CAAA,EAAG;MACzB,IAAI6F,UAAS,GAAI,EAAE;;MAEnB;MACA,IAAI,CAACtI,SAAS,CAACtB,OAAO,CAACpD,KAAI,IAAK;QAC3BgN,UAAU,CAAC/D,IAAI,CAAC;UACZ3H,EAAE,EAAE,QAAO,GAAItB,KAAK,CAACiN,GAAG;UACxBlM,IAAI,EAAE,OAAO;UACbQ,IAAI,EAAE,MAAMvB,KAAK,CAACkN,YAAW,IAAK,IAAI,QAAQlN,KAAK,CAAC+D,MAAM,EAAE;UAC5DoJ,SAAS,EAAE,IAAInF,IAAI,CAAChI,KAAK,CAACoI,SAAQ,IAAKpI,KAAK,CAACqI,UAAU,CAAC,CAAC+E,OAAO,CAAC,CAAC;UAClE3L,KAAK,EAAE;QACX,CAAC,CAAC;MACP,CAAC,CAAC;;MAEF;MACA,IAAI,CAACkD,QAAQ,CAACvB,OAAO,CAAC7C,IAAG,IAAK;QACzByM,UAAU,CAAC/D,IAAI,CAAC;UACZ3H,EAAE,EAAE,OAAM,GAAIf,IAAI,CAAC8M,GAAG;UACtBtM,IAAI,EAAE,MAAM;UACZQ,IAAI,EAAE,OAAOhB,IAAI,CAAC+M,QAAQ,KAAK;UAC/BH,SAAS,EAAE,IAAInF,IAAI,CAACzH,IAAI,CAAC8H,UAAU,CAAC,CAAC+E,OAAO,CAAC,CAAC;UAC9C3L,KAAK,EAAE;QACX,CAAC,CAAC;MACP,CAAC,CAAC;;MAEF;MACA,IAAI,IAAI,CAACmD,WAAU,IAAK,IAAI,CAACA,WAAW,CAACV,MAAK,GAAI,CAAC,EAAE;QACjD,IAAI,CAACU,WAAW,CAACxB,OAAO,CAACwE,OAAM,IAAK;UAC/B,MAAM2F,MAAK,GAAI,CAAC3F,OAAO,CAAC4F,MAAK,IAAK5F,OAAO,CAAC6F,IAAG,IAAK,GAAG,IAAI,GAAG;UAC5D,IAAIF,MAAK,GAAI,CAAC,EAAE;YACZP,UAAU,CAAC/D,IAAI,CAAC;cACZ3H,EAAE,EAAE,QAAO,GAAIsG,OAAO,CAAC8F,GAAG;cAC1B3M,IAAI,EAAE,WAAW;cACjBQ,IAAI,EAAE,QAAQqG,OAAO,CAAChF,IAAI,SAAS2K,MAAM,OAAO;cAChDJ,SAAS,EAAE,IAAInF,IAAI,CAACJ,OAAO,CAAC+F,UAAS,IAAK3F,IAAI,CAACmB,GAAG,CAAC,CAAC,CAAC,CAACiE,OAAO,CAAC,CAAC;cAC/D3L,KAAK,EAAE;YACX,CAAC,CAAC;UACN;QACL,CAAC,CAAC;MACN;;MAEA;MACAuL,UAAU,CAACY,IAAI,CAAC,CAACC,CAAC,EAAEC,CAAC,KAAKA,CAAC,CAACX,SAAQ,GAAIU,CAAC,CAACV,SAAS,CAAC;MACpDH,UAAS,GAAIA,UAAU,CAACe,KAAK,CAAC,CAAC,EAAE,EAAE,CAAC;;MAEpC;MACA,MAAM5E,GAAE,GAAInB,IAAI,CAACmB,GAAG,CAAC,CAAC;MACtB6D,UAAU,CAAC5J,OAAO,CAACT,IAAG,IAAK;QACtB,MAAMqL,IAAG,GAAI7E,GAAE,GAAIxG,IAAI,CAACwK,SAAS;QACjC,IAAIa,IAAG,GAAI,KAAK,EAAErL,IAAI,CAACnB,IAAG,GAAI,IAAI,MAC7B,IAAIwM,IAAG,GAAI,OAAO,EAAErL,IAAI,CAACnB,IAAG,GAAIyM,IAAI,CAACC,KAAK,CAACF,IAAI,GAAC,KAAK,IAAI,KAAK,MAC9D,IAAIA,IAAG,GAAI,QAAQ,EAAErL,IAAI,CAACnB,IAAG,GAAIyM,IAAI,CAACC,KAAK,CAACF,IAAI,GAAC,OAAO,IAAI,KAAK,MACjErL,IAAI,CAACnB,IAAG,GAAI,IAAIwG,IAAI,CAACrF,IAAI,CAACwK,SAAS,CAAC,CAAClF,kBAAkB,CAAC,CAAC;MACnE,CAAC,CAAC;MAEF,IAAI,CAACpD,aAAa,CAAClE,gBAAe,GAAI;QAAEoB,IAAI,EAAEiL,UAAU;QAAEhL,MAAM,EAAE;MAAM,CAAC;IAC7E,CAAC;IAED,MAAMmD,YAAYA,CAAA,EAAG;MACnB,IAAI;QACF,MAAMgJ,UAAS,GAAI,8DAA8D;QACjF,MAAMjM,QAAO,GAAI,MAAM9D,KAAK,CAAC+D,GAAG,CAACgM,UAAU,CAAC;QAC5C7P,OAAO,CAAC8P,WAAW,CAAC,OAAO,EAAElM,QAAQ,CAACH,IAAI,CAAC;QAC3C,MAAMsM,QAAO,GAAI5D,QAAQ,CAACC,cAAc,CAAC,iBAAiB,CAAC;QAC3D,IAAI,CAAC2D,QAAQ,EAAE;QACf,IAAI,CAAC/J,aAAY,GAAIhG,OAAO,CAACuM,IAAI,CAACwD,QAAQ,CAAC;QAC3C,MAAMvD,MAAK,GAAI;UACbC,OAAO,EAAE;YAAEC,OAAO,EAAE,MAAM;YAAEC,SAAS,EAAE;UAAmB,CAAC;UAC3DqD,SAAS,EAAE;YACTC,GAAG,EAAE,CAAC;YACNC,GAAG,EAAEP,IAAI,CAACO,GAAG,CAAC,GAAG,IAAI,CAAC/J,cAAc,CAAC/B,GAAG,CAAC+L,CAAA,IAAKA,CAAC,CAAC5N,KAAK,CAAC,EAAE,EAAE,CAAC;YAC3DsK,IAAI,EAAE,IAAI;YACVE,MAAM,EAAE,IAAI;YACZ9J,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,CAAC;YAChBmN,SAAS,EAAE,EAAE;YACbC,UAAU,EAAE,EAAE;YACdC,UAAU,EAAE,IAAI;YAChBC,OAAO,EAAE;cAAEpN,KAAK,EAAE,CAAC,SAAS,EAAE,SAAS,EAAE,SAAS,EAAE,SAAS,EAAE,SAAS,EAAE,SAAS,EAAE,SAAS;YAAE;UAClG,CAAC;UACDsK,MAAM,EAAE,CAAC;YACPnJ,IAAI,EAAE,MAAM;YAAE7B,IAAI,EAAE,KAAK;YAAE2B,GAAG,EAAE,OAAO;YAAEoM,IAAI,EAAE,KAAK;YAAEC,IAAI,EAAE,IAAI;YAACC,MAAM,EAAC,CAAC,GAAG,EAAC,EAAE,CAAC;YAChFhG,KAAK,EAAE;cAAE0C,IAAI,EAAE,IAAI;cAAEuD,QAAQ,EAAE;YAAG,CAAC;YACnClN,IAAI,EAAE,IAAI,CAAC0C,cAAc;YACzB4H,SAAS,EAAE;cAAE6C,SAAS,EAAE,SAAS;cAAEC,WAAW,EAAE;YAAO,CAAC;YACxDC,QAAQ,EAAE;cAAE/C,SAAS,EAAE;gBAAE6C,SAAS,EAAE;cAAU;YAAE;UAClD,CAAC;QACH,CAAC;QACD,IAAI,CAAC5K,aAAa,CAACkI,SAAS,CAAC1B,MAAM,CAAC;MACtC,EAAE,OAAOxI,KAAK,EAAE;QACdsB,OAAO,CAACtB,KAAK,CAAC,iBAAiB,EAAEA,KAAK,CAAC;MACzC;IACF;EACF;AACF,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}