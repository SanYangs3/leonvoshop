{"ast":null,"code":"import { createElementVNode as _createElementVNode, createTextVNode as _createTextVNode, resolveComponent as _resolveComponent, withCtx as _withCtx, createVNode as _createVNode, vModelText as _vModelText, withDirectives as _withDirectives, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, normalizeClass as _normalizeClass, createCommentVNode as _createCommentVNode, normalizeStyle as _normalizeStyle, withModifiers as _withModifiers } from \"vue\";\nconst _hoisted_1 = {\n  class: \"admin-promotions\"\n};\nconst _hoisted_2 = {\n  class: \"content-header\"\n};\nconst _hoisted_3 = {\n  class: \"breadcrumb\"\n};\nconst _hoisted_4 = {\n  class: \"content\"\n};\nconst _hoisted_5 = {\n  class: \"row\"\n};\nconst _hoisted_6 = {\n  class: \"col-xs-12\"\n};\nconst _hoisted_7 = {\n  class: \"box box-primary\"\n};\nconst _hoisted_8 = {\n  class: \"box-header with-border\"\n};\nconst _hoisted_9 = {\n  class: \"box-tools pull-right\"\n};\nconst _hoisted_10 = {\n  class: \"has-feedback\"\n};\nconst _hoisted_11 = {\n  class: \"box-body table-responsive no-padding\"\n};\nconst _hoisted_12 = {\n  class: \"table table-hover\"\n};\nconst _hoisted_13 = {\n  class: \"product-info-compact\"\n};\nconst _hoisted_14 = {\n  class: \"product-name-wrapper\"\n};\nconst _hoisted_15 = {\n  class: \"product-name-text\"\n};\nconst _hoisted_16 = {\n  class: \"product-price-text\"\n};\nconst _hoisted_17 = [\"title\"];\nconst _hoisted_18 = [\"title\"];\nconst _hoisted_19 = {\n  class: \"progress-group\"\n};\nconst _hoisted_20 = {\n  class: \"progress-text\"\n};\nconst _hoisted_21 = {\n  class: \"progress sm\"\n};\nconst _hoisted_22 = {\n  key: 0,\n  class: \"text-orange\"\n};\nconst _hoisted_23 = {\n  key: 1,\n  class: \"text-muted\"\n};\nconst _hoisted_24 = {\n  key: 0\n};\nconst _hoisted_25 = {\n  colspan: \"6\",\n  class: \"text-center text-muted\",\n  style: {\n    \"padding\": \"20px\"\n  }\n};\nconst _hoisted_26 = {\n  class: \"box-footer clearfix\"\n};\nconst _hoisted_27 = {\n  class: \"pagination pagination-sm no-margin pull-right\"\n};\nconst _hoisted_28 = [\"onClick\"];\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_router_link = _resolveComponent(\"router-link\");\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createElementVNode(\"div\", _hoisted_2, [_cache[5] || (_cache[5] = _createElementVNode(\"h1\", null, [_createTextVNode(\" Êé®ÂπøÁÆ°ÁêÜ \"), _createElementVNode(\"small\", null, \"ÂïÜÂìÅÊé®ÂπøÊÉÖÂÜµÁõëÊéß\")], -1 /* CACHED */)), _createElementVNode(\"ol\", _hoisted_3, [_createElementVNode(\"li\", null, [_createVNode(_component_router_link, {\n    to: \"/admin/dashboard\"\n  }, {\n    default: _withCtx(() => [...(_cache[3] || (_cache[3] = [_createElementVNode(\"i\", {\n      class: \"fa fa-dashboard\"\n    }, null, -1 /* CACHED */), _createTextVNode(\" È¶ñÈ°µ\", -1 /* CACHED */)]))]),\n    _: 1 /* STABLE */\n  })]), _cache[4] || (_cache[4] = _createElementVNode(\"li\", {\n    class: \"active\"\n  }, \"Êé®ÂπøÁÆ°ÁêÜ\", -1 /* CACHED */))])]), _createElementVNode(\"div\", _hoisted_4, [_createElementVNode(\"div\", _hoisted_5, [_createElementVNode(\"div\", _hoisted_6, [_createElementVNode(\"div\", _hoisted_7, [_createElementVNode(\"div\", _hoisted_8, [_cache[7] || (_cache[7] = _createElementVNode(\"h3\", {\n    class: \"box-title\"\n  }, \"Êé®ÂπøÂïÜÂìÅÊéíË°å (Top 50)\", -1 /* CACHED */)), _createElementVNode(\"div\", _hoisted_9, [_createElementVNode(\"div\", _hoisted_10, [_withDirectives(_createElementVNode(\"input\", {\n    type: \"text\",\n    class: \"form-control input-sm\",\n    placeholder: \"ÊêúÁ¥¢ÂïÜÂìÅ...\",\n    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => $data.searchKeyword = $event)\n  }, null, 512 /* NEED_PATCH */), [[_vModelText, $data.searchKeyword]]), _cache[6] || (_cache[6] = _createElementVNode(\"span\", {\n    class: \"glyphicon glyphicon-search form-control-feedback\"\n  }, null, -1 /* CACHED */))])])]), _createElementVNode(\"div\", _hoisted_11, [_createElementVNode(\"table\", _hoisted_12, [_cache[10] || (_cache[10] = _createElementVNode(\"thead\", null, [_createElementVNode(\"tr\", null, [_createElementVNode(\"th\", {\n    style: {\n      \"width\": \"60px\"\n    }\n  }, \"ÊéíÂêç\"), _createElementVNode(\"th\", null, \"ÂïÜÂìÅÂêçÁß∞\"), _createElementVNode(\"th\", null, \"ÊâÄÂ±ûÂïÜÂÆ∂\"), _createElementVNode(\"th\", null, \"ÂΩìÂâçÁÉ≠Â∫¶ (ÁßØÂàÜ)\"), _createElementVNode(\"th\", null, \"Êé®ÂπøÁä∂ÊÄÅ\"), _createElementVNode(\"th\", null, \"Â§ßÂ±èÂ±ïÁ§∫\")])], -1 /* CACHED */)), _createElementVNode(\"tbody\", null, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($options.filteredProducts, (product, index) => {\n    return _openBlock(), _createElementBlock(\"tr\", {\n      key: product.pid\n    }, [_createElementVNode(\"td\", null, [_createElementVNode(\"span\", {\n      class: _normalizeClass([\"badge\", $options.getRankBadgeClass(index)])\n    }, _toDisplayString(index + 1), 3 /* TEXT, CLASS */)]), _createElementVNode(\"td\", null, [_createElementVNode(\"div\", _hoisted_13, [_cache[8] || (_cache[8] = _createElementVNode(\"div\", {\n      class: \"product-icon-wrapper\"\n    }, [_createCommentVNode(\" Áªü‰∏Ä‰ΩøÁî®ÈÄöÁî®ÂõæÊ†á \"), _createElementVNode(\"span\", {\n      class: \"product-icon-placeholder\"\n    }, \"üíª\")], -1 /* CACHED */)), _createElementVNode(\"div\", _hoisted_14, [_createElementVNode(\"div\", _hoisted_15, _toDisplayString(product.name), 1 /* TEXT */), _createElementVNode(\"div\", _hoisted_16, \"¬•\" + _toDisplayString(product.price), 1 /* TEXT */)])])]), _createElementVNode(\"td\", null, [product.merchantName ? (_openBlock(), _createElementBlock(\"span\", {\n      key: 0,\n      class: \"merchant-tag\",\n      title: 'ÂïÜÂÆ∂ID: ' + product.bid\n    }, _toDisplayString(product.merchantName), 9 /* TEXT, PROPS */, _hoisted_17)) : (_openBlock(), _createElementBlock(\"span\", {\n      key: 1,\n      class: \"text-muted\",\n      title: 'ÂïÜÂÆ∂ID: ' + product.bid\n    }, \" Êú™Áü•ÂïÜÂÆ∂ (ID: \" + _toDisplayString(product.bid) + \") \", 9 /* TEXT, PROPS */, _hoisted_18))]), _createElementVNode(\"td\", null, [_createElementVNode(\"div\", _hoisted_19, [_createElementVNode(\"span\", _hoisted_20, _toDisplayString(product.heat), 1 /* TEXT */), _createElementVNode(\"div\", _hoisted_21, [_createElementVNode(\"div\", {\n      class: _normalizeClass([\"progress-bar\", product.heat >= 150 ? 'progress-bar-red' : 'progress-bar-aqua']),\n      style: _normalizeStyle({\n        width: $options.getHeatPercentage(product.heat) + '%'\n      })\n    }, null, 6 /* CLASS, STYLE */)])])]), _createElementVNode(\"td\", null, [product.heat > 100 ? (_openBlock(), _createElementBlock(\"span\", _hoisted_22, [_cache[9] || (_cache[9] = _createElementVNode(\"i\", {\n      class: \"fa fa-fire\"\n    }, null, -1 /* CACHED */)), _createTextVNode(\" Êé®Âπø‰∏≠ (+\" + _toDisplayString(product.heat - 100) + \") \", 1 /* TEXT */)])) : (_openBlock(), _createElementBlock(\"span\", _hoisted_23, \"Êú™Êé®Âπø\"))]), _createElementVNode(\"td\", null, [_createElementVNode(\"span\", {\n      class: _normalizeClass([\"label\", product.heat >= 150 ? 'label-danger' : 'label-warning'])\n    }, _toDisplayString(product.heat >= 150 ? 'Â∑≤‰∏äÂ§ßÂ±è' : `ËøòÂ∑Æ ${150 - product.heat} ÂàÜ`), 3 /* TEXT, CLASS */)])]);\n  }), 128 /* KEYED_FRAGMENT */)), $options.filteredProducts.length === 0 ? (_openBlock(), _createElementBlock(\"tr\", _hoisted_24, [_createElementVNode(\"td\", _hoisted_25, _toDisplayString($data.loading ? 'Âä†ËΩΩ‰∏≠...' : 'ÊöÇÊó†Êé®ÂπøÊï∞ÊçÆ'), 1 /* TEXT */)])) : _createCommentVNode(\"v-if\", true)])])]), _createElementVNode(\"div\", _hoisted_26, [_createElementVNode(\"ul\", _hoisted_27, [_createElementVNode(\"li\", {\n    class: _normalizeClass({\n      disabled: $data.currentPage === 1\n    })\n  }, [_createElementVNode(\"a\", {\n    href: \"#\",\n    onClick: _cache[1] || (_cache[1] = _withModifiers((...args) => $options.prevPage && $options.prevPage(...args), [\"prevent\"]))\n  }, \"¬´\")], 2 /* CLASS */), (_openBlock(true), _createElementBlock(_Fragment, null, _renderList($options.totalPages, p => {\n    return _openBlock(), _createElementBlock(\"li\", {\n      key: p,\n      class: _normalizeClass({\n        active: $data.currentPage === p\n      })\n    }, [_createElementVNode(\"a\", {\n      href: \"#\",\n      onClick: _withModifiers($event => $data.currentPage = p, [\"prevent\"])\n    }, _toDisplayString(p), 9 /* TEXT, PROPS */, _hoisted_28)], 2 /* CLASS */);\n  }), 128 /* KEYED_FRAGMENT */)), _createElementVNode(\"li\", {\n    class: _normalizeClass({\n      disabled: $data.currentPage === $options.totalPages\n    })\n  }, [_createElementVNode(\"a\", {\n    href: \"#\",\n    onClick: _cache[2] || (_cache[2] = _withModifiers((...args) => $options.nextPage && $options.nextPage(...args), [\"prevent\"]))\n  }, \"¬ª\")], 2 /* CLASS */)])])])])])])]);\n}","map":{"version":3,"names":["class","colspan","style","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_hoisted_3","_createVNode","_component_router_link","to","_cache","_hoisted_4","_hoisted_5","_hoisted_6","_hoisted_7","_hoisted_8","_hoisted_9","_hoisted_10","type","placeholder","$data","searchKeyword","$event","_hoisted_11","_hoisted_12","_Fragment","_renderList","$options","filteredProducts","product","index","key","pid","_normalizeClass","getRankBadgeClass","_hoisted_13","_createCommentVNode","_hoisted_14","_hoisted_15","_toDisplayString","name","_hoisted_16","price","merchantName","title","bid","_hoisted_17","_hoisted_18","_hoisted_19","_hoisted_20","heat","_hoisted_21","_normalizeStyle","width","getHeatPercentage","_hoisted_22","_hoisted_23","length","_hoisted_24","_hoisted_25","loading","_hoisted_26","_hoisted_27","disabled","currentPage","href","onClick","_withModifiers","args","prevPage","totalPages","p","active","_hoisted_28","nextPage"],"sources":["D:\\1_homework_file\\Â§ß‰∏â‰∏ä\\ËΩØ‰ª∂Â∑•Á®ã\\È°πÁõÆÁïôÊ°£\\1ÂâçÁ´ØÂºÄÂèë_ÊàëÊâçÊòØÁúüÁöÑ\\version5.0\\src\\views\\admin\\Admin9Promotions.vue"],"sourcesContent":["<template>\r\n  <div class=\"admin-promotions\">\r\n    <div class=\"content-header\">\r\n      <h1>\r\n        Êé®ÂπøÁÆ°ÁêÜ\r\n        <small>ÂïÜÂìÅÊé®ÂπøÊÉÖÂÜµÁõëÊéß</small>\r\n      </h1>\r\n      <ol class=\"breadcrumb\">\r\n        <li><router-link to=\"/admin/dashboard\"><i class=\"fa fa-dashboard\"></i> È¶ñÈ°µ</router-link></li>\r\n        <li class=\"active\">Êé®ÂπøÁÆ°ÁêÜ</li>\r\n      </ol>\r\n    </div>\r\n\r\n    <div class=\"content\">\r\n      <div class=\"row\">\r\n        <div class=\"col-xs-12\">\r\n          <div class=\"box box-primary\">\r\n            <div class=\"box-header with-border\">\r\n              <h3 class=\"box-title\">Êé®ÂπøÂïÜÂìÅÊéíË°å (Top 50)</h3>\r\n              <div class=\"box-tools pull-right\">\r\n                <div class=\"has-feedback\">\r\n                  <input type=\"text\" class=\"form-control input-sm\" placeholder=\"ÊêúÁ¥¢ÂïÜÂìÅ...\" v-model=\"searchKeyword\">\r\n                  <span class=\"glyphicon glyphicon-search form-control-feedback\"></span>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            \r\n            <div class=\"box-body table-responsive no-padding\">\r\n              <table class=\"table table-hover\">\r\n                <thead>\r\n                  <tr>\r\n                    <th style=\"width: 60px;\">ÊéíÂêç</th>\r\n                    <th>ÂïÜÂìÅÂêçÁß∞</th>\r\n                    <th>ÊâÄÂ±ûÂïÜÂÆ∂</th>\r\n                    <th>ÂΩìÂâçÁÉ≠Â∫¶ (ÁßØÂàÜ)</th>\r\n                    <th>Êé®ÂπøÁä∂ÊÄÅ</th>\r\n                    <th>Â§ßÂ±èÂ±ïÁ§∫</th>\r\n                  </tr>\r\n                </thead>\r\n                <tbody>\r\n                  <tr v-for=\"(product, index) in filteredProducts\" :key=\"product.pid\">\r\n                    <td>\r\n                      <span class=\"badge\" :class=\"getRankBadgeClass(index)\">{{ index + 1 }}</span>\r\n                    </td>\r\n                    <td>\r\n                      <div class=\"product-info-compact\">\r\n                        <div class=\"product-icon-wrapper\">\r\n                          <!-- Áªü‰∏Ä‰ΩøÁî®ÈÄöÁî®ÂõæÊ†á -->\r\n                          <span class=\"product-icon-placeholder\">üíª</span>\r\n                        </div>\r\n                        <div class=\"product-name-wrapper\">\r\n                          <div class=\"product-name-text\">{{ product.name }}</div>\r\n                          <div class=\"product-price-text\">¬•{{ product.price }}</div>\r\n                        </div>\r\n                      </div>\r\n                    </td>\r\n                    <td>\r\n                      <span v-if=\"product.merchantName\" class=\"merchant-tag\" :title=\"'ÂïÜÂÆ∂ID: ' + product.bid\">\r\n                        {{ product.merchantName }}\r\n                      </span>\r\n                      <span v-else class=\"text-muted\" :title=\"'ÂïÜÂÆ∂ID: ' + product.bid\">\r\n                        Êú™Áü•ÂïÜÂÆ∂ (ID: {{ product.bid }})\r\n                      </span>\r\n                    </td>\r\n                    <td>\r\n                      <div class=\"progress-group\">\r\n                        <span class=\"progress-text\">{{ product.heat }}</span>\r\n                        <div class=\"progress sm\">\r\n                          <div class=\"progress-bar\" \r\n                               :class=\"product.heat >= 150 ? 'progress-bar-red' : 'progress-bar-aqua'\"\r\n                               :style=\"{ width: getHeatPercentage(product.heat) + '%' }\"></div>\r\n                        </div>\r\n                      </div>\r\n                    </td>\r\n                    <td>\r\n                      <span v-if=\"product.heat > 100\" class=\"text-orange\">\r\n                        <i class=\"fa fa-fire\"></i> Êé®Âπø‰∏≠ (+{{ product.heat - 100 }})\r\n                      </span>\r\n                      <span class=\"text-muted\" v-else>Êú™Êé®Âπø</span>\r\n                    </td>\r\n                    <td>\r\n                      <span class=\"label\" :class=\"product.heat >= 150 ? 'label-danger' : 'label-warning'\">\r\n                        {{ product.heat >= 150 ? 'Â∑≤‰∏äÂ§ßÂ±è' : `ËøòÂ∑Æ ${150 - product.heat} ÂàÜ` }}\r\n                      </span>\r\n                    </td>\r\n                  </tr>\r\n                  <tr v-if=\"filteredProducts.length === 0\">\r\n                    <td colspan=\"6\" class=\"text-center text-muted\" style=\"padding: 20px;\">\r\n                      {{ loading ? 'Âä†ËΩΩ‰∏≠...' : 'ÊöÇÊó†Êé®ÂπøÊï∞ÊçÆ' }}\r\n                    </td>\r\n                  </tr>\r\n                </tbody>\r\n              </table>\r\n            </div>\r\n            \r\n            <div class=\"box-footer clearfix\">\r\n              <ul class=\"pagination pagination-sm no-margin pull-right\">\r\n                <li :class=\"{ disabled: currentPage === 1 }\"><a href=\"#\" @click.prevent=\"prevPage\">&laquo;</a></li>\r\n                <li v-for=\"p in totalPages\" :key=\"p\" :class=\"{ active: currentPage === p }\">\r\n                  <a href=\"#\" @click.prevent=\"currentPage = p\">{{ p }}</a>\r\n                </li>\r\n                <li :class=\"{ disabled: currentPage === totalPages }\"><a href=\"#\" @click.prevent=\"nextPage\">&raquo;</a></li>\r\n              </ul>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport axios from 'axios';\r\nimport apiConfig from '@/config/api.config';\r\n\r\nexport default {\r\n  name: 'AdminPromotions',\r\n  data() {\r\n    return {\r\n      products: [],\r\n      businesses: [],\r\n      loading: false,\r\n      searchKeyword: '',\r\n      currentPage: 1,\r\n      pageSize: 10\r\n    };\r\n  },\r\n  computed: {\r\n    // ËøáÊª§Âπ∂ÊéíÂ∫èÂïÜÂìÅ\r\n    processedProducts() {\r\n      // 1. ËøáÊª§ÊéâÊ≤°ÊúâËØÑÂàÜÊàñËØÑÂàÜ<=100ÁöÑÂïÜÂìÅÔºàÂè™ÊòæÁ§∫ÊúâÊé®ÂπøË°å‰∏∫ÁöÑÔºâ\r\n      // ÂøÖÈ°ª‰∏•Ê†ºÂ§ß‰∫é100ÂàÜÔºåÊâçËßÜ‰∏∫ÊúâÊé®Âπø\r\n      let list = this.products.filter(p => (p.rating || p.heat || 0) > 100).map(p => {\r\n        // Â∞ùËØïÂåπÈÖçÂïÜÂÆ∂ÂêçÁß∞\r\n        // Ê≥®ÊÑèÔºöËøôÈáåÂøÖÈ°ªÁ°Æ‰øùÂïÜÂÆ∂IDÁ±ªÂûãÂåπÈÖç (String vs Number)\r\n        const merchant = this.businesses.find(b => String(b.bid) === String(p.bid) || String(b.id) === String(p.bid));\r\n        return {\r\n          ...p,\r\n          heat: p.rating || p.heat || 100, // Á°Æ‰øùÊúâÂÄº\r\n          merchantName: merchant ? merchant.name : null\r\n        };\r\n      });\r\n\r\n      // 2. ÊåâÁÉ≠Â∫¶ÈôçÂ∫èÊéíÂ∫è\r\n      list.sort((a, b) => b.heat - a.heat);\r\n\r\n      // 3. ÊêúÁ¥¢ËøáÊª§\r\n      if (this.searchKeyword) {\r\n        const keyword = this.searchKeyword.toLowerCase();\r\n        list = list.filter(p => \r\n          p.name.toLowerCase().includes(keyword) || \r\n          (p.merchantName && p.merchantName.toLowerCase().includes(keyword))\r\n        );\r\n      }\r\n\r\n      return list;\r\n    },\r\n    \r\n    filteredProducts() {\r\n      const start = (this.currentPage - 1) * this.pageSize;\r\n      return this.processedProducts.slice(start, start + this.pageSize);\r\n    },\r\n    \r\n    totalPages() {\r\n      return Math.ceil(this.processedProducts.length / this.pageSize) || 1;\r\n    }\r\n  },\r\n  mounted() {\r\n    this.loadData();\r\n  },\r\n  methods: {\r\n    async loadData() {\r\n      this.loading = true;\r\n      try {\r\n        // 1. Ëé∑ÂèñÊâÄÊúâÂïÜÂìÅÂíåÊâÄÊúâÂïÜÂÆ∂\r\n        const [productsRes, businessesRes] = await Promise.all([\r\n          axios.get(apiConfig.product.getAllProducts),\r\n          axios.get(apiConfig.business.getAllBusinesses)\r\n        ]);\r\n\r\n        let allBusinesses = [];\r\n        if (businessesRes.data.code === 1) {\r\n          allBusinesses = (businessesRes.data.data || []).map(b => ({\r\n            ...b,\r\n            bid: b.bid || b.id || b.businessId,\r\n            name: b.bname || b.businessName || b.name\r\n          }));\r\n          this.businesses = allBusinesses;\r\n        }\r\n\r\n        // 2. ÊûÑÂª∫ pid -> bid ÁöÑÊò†Â∞ÑË°®\r\n        // Áî±‰∫éÂïÜÂìÅË°®ÂèØËÉΩÊ≤°ÊúâÁõ¥Êé•Â≠òbidÔºåÊàë‰ª¨ÈúÄË¶ÅÈÄöËøá‚ÄúÊü•ËØ¢ÊØè‰∏™ÂïÜÂÆ∂ÁöÑÂïÜÂìÅÂàóË°®‚ÄùÊù•ÂèçÂêëÂª∫Á´ãÂÖ≥ËÅî\r\n        // ËøôÈúÄË¶ÅÈÅçÂéÜÊâÄÊúâÂïÜÂÆ∂ÔºåËôΩÁÑ∂ËØ∑Ê±ÇÂ§ö‰∏ÄÁÇπÔºå‰ΩÜÊòØËÉΩÊãøÂà∞ÁúüÂÆûÁöÑÂÖ≥ËÅîÂÖ≥Á≥ª\r\n        const productOwnerMap = new Map(); // pid -> bid\r\n\r\n        if (allBusinesses.length > 0) {\r\n          // Âπ∂ÂèëËØ∑Ê±ÇÊâÄÊúâÂïÜÂÆ∂ÁöÑÂïÜÂìÅÂàóË°®\r\n          const productRequests = allBusinesses.map(b => \r\n            axios.get(apiConfig.business.getProducts(b.bid)).then(res => ({\r\n              bid: b.bid,\r\n              products: res.data.code === 1 ? res.data.data : []\r\n            })).catch(() => ({ bid: b.bid, products: [] }))\r\n          );\r\n          \r\n          const results = await Promise.all(productRequests);\r\n          \r\n          results.forEach(item => {\r\n            if (item.products && Array.isArray(item.products)) {\r\n              item.products.forEach(p => {\r\n                // ËÆ∞ÂΩïËøô‰∏™ÂïÜÂìÅÂ±û‰∫éÂì™‰∏™ÂïÜÂÆ∂\r\n                productOwnerMap.set(String(p.pid), item.bid);\r\n              });\r\n            }\r\n          });\r\n        }\r\n\r\n        // 3. Â§ÑÁêÜÂïÜÂìÅÂàóË°®\r\n        if (productsRes.data.code === 1) {\r\n          this.products = (productsRes.data.data || []).map(p => {\r\n            // ‰ºòÂÖà‰ΩøÁî® map ‰∏≠Êü•Âà∞ÁöÑÁúüÂÆû bidÔºåÂ¶ÇÊûúÊ≤°Êü•Âà∞ÔºåÂÜçÂ∞ùËØïÁî® p.bid\r\n            const realBid = productOwnerMap.get(String(p.pid)) || p.bid || p.businessId;\r\n            \r\n            return {\r\n              ...p,\r\n              bid: realBid, // Êõ¥Êñ∞‰∏∫ÁúüÂÆû bid\r\n              heat: p.heat || p.rating || 100\r\n            };\r\n          });\r\n        }\r\n        \r\n      } catch (error) {\r\n        console.error('Âä†ËΩΩÊé®ÂπøÊï∞ÊçÆÂ§±Ë¥•:', error);\r\n      } finally {\r\n        this.loading = false;\r\n      }\r\n    },\r\n    \r\n    getRankBadgeClass(index) {\r\n      if (index === 0) return 'bg-red';\r\n      if (index === 1) return 'bg-yellow';\r\n      if (index === 2) return 'bg-blue';\r\n      return 'bg-gray';\r\n    },\r\n    \r\n    getHeatPercentage(heat) {\r\n      // Ë∞ÉÊï¥ÊØî‰æãÔºö100ÂàÜÊòØËµ∑ÁÇπ(0%)Ôºå150ÂàÜÊòØÊª°ÁÇπ(100%)\r\n      const max = 150;\r\n      const min = 100;\r\n      // Êó¢ÁÑ∂Âè™ÊòæÁ§∫ > 100 ÁöÑÔºåÈÇ£‰πà heat Ëá≥Â∞ëÊòØ 101\r\n      if (heat <= min) return 0;\r\n      if (heat >= max) return 100;\r\n      \r\n      const percent = ((heat - min) / (max - min)) * 100;\r\n      return percent;\r\n    },\r\n    \r\n    prevPage() {\r\n      if (this.currentPage > 1) this.currentPage--;\r\n    },\r\n    \r\n    nextPage() {\r\n      if (this.currentPage < this.totalPages) this.currentPage++;\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.admin-promotions {\r\n  min-height: 100%;\r\n}\r\n\r\n.content-header {\r\n  padding: 15px 15px 0 15px;\r\n  margin-bottom: 20px;\r\n}\r\n\r\n.content-header > h1 {\r\n  margin: 0;\r\n  font-size: 24px;\r\n}\r\n\r\n.content-header > h1 > small {\r\n  font-size: 15px;\r\n  display: inline-block;\r\n  padding-left: 4px;\r\n  font-weight: 300;\r\n}\r\n\r\n.breadcrumb {\r\n  float: right;\r\n  background: transparent;\r\n  margin-top: 0;\r\n  margin-bottom: 0;\r\n  font-size: 12px;\r\n  padding: 7px 5px;\r\n  position: absolute;\r\n  top: 15px;\r\n  right: 15px;\r\n  border-radius: 2px;\r\n}\r\n\r\n.content {\r\n  padding: 15px;\r\n}\r\n\r\n/* Box Styles */\r\n.box {\r\n  position: relative;\r\n  border-radius: 3px;\r\n  background: #ffffff;\r\n  border-top: 3px solid #d2d6de;\r\n  margin-bottom: 20px;\r\n  width: 100%;\r\n  box-shadow: 0 1px 1px rgba(0,0,0,0.1);\r\n}\r\n\r\n.box.box-primary {\r\n  border-top-color: #3c8dbc;\r\n}\r\n\r\n.box-header {\r\n  color: #444;\r\n  display: block;\r\n  padding: 10px;\r\n  position: relative;\r\n}\r\n\r\n.box-header.with-border {\r\n  border-bottom: 1px solid #f4f4f4;\r\n}\r\n\r\n.box-title {\r\n  display: inline-block;\r\n  font-size: 18px;\r\n  margin: 0;\r\n  line-height: 1;\r\n}\r\n\r\n.box-tools {\r\n  position: absolute;\r\n  right: 10px;\r\n  top: 5px;\r\n}\r\n\r\n.box-body {\r\n  border-top-left-radius: 0;\r\n  border-top-right-radius: 0;\r\n  border-bottom-right-radius: 3px;\r\n  border-bottom-left-radius: 3px;\r\n  padding: 10px;\r\n}\r\n\r\n.box-footer {\r\n  border-top-left-radius: 0;\r\n  border-top-right-radius: 0;\r\n  border-bottom-right-radius: 3px;\r\n  border-bottom-left-radius: 3px;\r\n  border-top: 1px solid #f4f4f4;\r\n  padding: 10px;\r\n  background-color: #ffffff;\r\n  /* ‰ΩøÁî®flexÂ∏ÉÂ±ÄËß£ÂÜ≥È´òÂ∫¶Â°åÈô∑ÂíåÂØπÈΩêÈóÆÈ¢ò */\r\n  display: flex;\r\n  justify-content: flex-end;\r\n  align-items: center;\r\n}\r\n\r\n/* Âº∫Âà∂ÂàÜÈ°µÂè≥ÂØπÈΩê */\r\n.box-footer .pagination {\r\n  margin: 0;\r\n  /* ÁßªÈô§floatÔºå‰∫§Áî±flexÊéßÂà∂ */\r\n  display: flex; \r\n}\r\n\r\n.table-responsive {\r\n  min-height: .01%;\r\n  overflow-x: auto;\r\n}\r\n\r\n.no-padding {\r\n  padding: 0 !important;\r\n}\r\n\r\n/* Table Styles */\r\n.table {\r\n  width: 100%;\r\n  max-width: 100%;\r\n  margin-bottom: 20px;\r\n  border-collapse: collapse;\r\n}\r\n\r\n.table > thead > tr > th,\r\n.table > tbody > tr > td {\r\n  border-top: 1px solid #f4f4f4;\r\n  padding: 12px;\r\n  vertical-align: middle;\r\n}\r\n\r\n/* Compact Product Info */\r\n.product-info-compact {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 12px;\r\n}\r\n\r\n.product-icon-wrapper {\r\n  width: 36px;\r\n  height: 36px;\r\n  border-radius: 4px;\r\n  background: #f9f9f9;\r\n  border: 1px solid #eee;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  overflow: hidden;\r\n  flex-shrink: 0;\r\n}\r\n\r\n.product-icon-img {\r\n  width: 100%;\r\n  height: 100%;\r\n  object-fit: contain;\r\n}\r\n\r\n.product-icon-placeholder {\r\n  font-size: 20px;\r\n}\r\n\r\n.product-name-wrapper {\r\n  display: flex;\r\n  flex-direction: column;\r\n}\r\n\r\n.product-name-text {\r\n  font-weight: 600;\r\n  color: #333;\r\n  font-size: 14px;\r\n}\r\n\r\n.product-price-text {\r\n  font-size: 12px;\r\n  color: #999;\r\n}\r\n\r\n/* Merchant Tag */\r\n.merchant-tag {\r\n  color: #666;\r\n  font-size: 13px;\r\n}\r\n\r\n.merchant-tag-default {\r\n  color: #999;\r\n  font-style: italic;\r\n  font-size: 13px;\r\n}\r\n\r\n.badge {\r\n  display: inline-block;\r\n  min-width: 10px;\r\n  padding: 3px 7px;\r\n  font-size: 12px;\r\n  font-weight: 700;\r\n  line-height: 1;\r\n  color: #fff;\r\n  text-align: center;\r\n  white-space: nowrap;\r\n  vertical-align: middle;\r\n  border-radius: 10px;\r\n}\r\n\r\n.bg-red { background-color: #dd4b39 !important; }\r\n.bg-yellow { background-color: #f39c12 !important; }\r\n.bg-blue { background-color: #0073b7 !important; }\r\n.bg-gray { background-color: #d2d6de !important; color: #444 !important; }\r\n\r\n.label {\r\n  display: inline;\r\n  padding: .2em .6em .3em;\r\n  font-size: 75%;\r\n  font-weight: 700;\r\n  line-height: 1;\r\n  color: #fff;\r\n  text-align: center;\r\n  white-space: nowrap;\r\n  vertical-align: baseline;\r\n  border-radius: .25em;\r\n}\r\n\r\n.label-success { background-color: #00a65a !important; }\r\n.label-default { background-color: #d2d6de !important; color: #444 !important; }\r\n.label-danger { background-color: #dd4b39 !important; }\r\n.label-warning { background-color: #f39c12 !important; }\r\n\r\n.text-orange { color: #ff851b !important; font-weight: bold; }\r\n.text-muted { color: #777; }\r\n\r\n/* Progress Bar */\r\n.progress-group {\r\n  width: 150px;\r\n}\r\n.progress-text {\r\n  font-weight: 600;\r\n}\r\n.progress {\r\n  height: 10px;\r\n  margin-bottom: 0;\r\n  border-radius: 5px;\r\n  background-color: #f5f5f5;\r\n  overflow: hidden;\r\n  box-shadow: inset 0 1px 2px rgba(0,0,0,.1);\r\n}\r\n.progress-bar {\r\n  float: left;\r\n  width: 0;\r\n  height: 100%;\r\n  font-size: 12px;\r\n  line-height: 20px;\r\n  color: #fff;\r\n  text-align: center;\r\n  background-color: #337ab7;\r\n  transition: width .6s ease;\r\n}\r\n.progress-bar-aqua { background-color: #00c0ef !important; }\r\n\r\n/* Pagination */\r\n.pagination {\r\n  display: inline-block;\r\n  padding-left: 0;\r\n  margin: 20px 0;\r\n  border-radius: 4px;\r\n}\r\n.pagination > li { display: inline; }\r\n.pagination > li > a {\r\n  position: relative;\r\n  float: left;\r\n  padding: 6px 12px;\r\n  margin-left: -1px;\r\n  line-height: 1.42857143;\r\n  color: #337ab7;\r\n  text-decoration: none;\r\n  background-color: #fff;\r\n  border: 1px solid #ddd;\r\n}\r\n.pagination > li.active > a {\r\n  z-index: 2;\r\n  color: #fff;\r\n  cursor: default;\r\n  background-color: #337ab7;\r\n  border-color: #337ab7;\r\n}\r\n.pagination > li.disabled > a {\r\n  color: #777;\r\n  cursor: not-allowed;\r\n  background-color: #fff;\r\n  border-color: #ddd;\r\n}\r\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}