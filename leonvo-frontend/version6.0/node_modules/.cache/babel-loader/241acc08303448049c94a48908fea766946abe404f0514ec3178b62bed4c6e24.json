{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.filter.js\";\nimport \"core-js/modules/es.iterator.find.js\";\nimport \"core-js/modules/es.iterator.for-each.js\";\nimport \"core-js/modules/es.iterator.map.js\";\nimport \"core-js/modules/es.json.stringify.js\";\nimport \"core-js/modules/esnext.json.parse.js\";\nimport axios from 'axios';\nimport apiConfig from '@/config/api.config';\nexport default {\n  name: 'BusinessProducts',\n  data() {\n    return {\n      loading: false,\n      searchKeyword: '',\n      statusFilter: 'all',\n      sortBy: 'newest',\n      currentPage: 1,\n      pageSize: 10,\n      products: [],\n      showAddModal: false,\n      showDetailModal: false,\n      showPromoteModal: false,\n      promotePoints: 100,\n      businessPoints: 0,\n      selectedProduct: null,\n      newProduct: {\n        name: '',\n        price: '',\n        stock: '',\n        description: '',\n        CPU: '',\n        GPU: '',\n        storage: '',\n        size: '',\n        type: '',\n        picture: '',\n        rating: 100,\n        status: 1\n      }\n    };\n  },\n  computed: {\n    filteredProducts() {\n      let filtered = [...this.products];\n\n      // æœç´¢\n      if (this.searchKeyword) {\n        const keyword = this.searchKeyword.toLowerCase();\n        filtered = filtered.filter(p => p.name && p.name.toLowerCase().includes(keyword));\n      }\n\n      // çŠ¶æ€è¿‡æ»¤\n      if (this.statusFilter !== 'all') {\n        filtered = filtered.filter(p => {\n          // å¦‚æœçŠ¶æ€æœªå®šä¹‰ï¼Œé»˜è®¤ä¸º1ï¼ˆåœ¨å”®ä¸­ï¼‰\n          const status = p.status !== undefined && p.status !== null ? p.status : 1;\n          return status.toString() === this.statusFilter;\n        });\n      }\n\n      // æ’åº\n      filtered.sort((a, b) => {\n        switch (this.sortBy) {\n          case 'newest':\n            return (b.pid || 0) - (a.pid || 0);\n          case 'sales':\n            return (b.sales_count || 0) - (a.sales_count || 0);\n          case 'price_asc':\n            return (a.price || 0) - (b.price || 0);\n          case 'price_desc':\n            return (b.price || 0) - (a.price || 0);\n          default:\n            return 0;\n        }\n      });\n\n      // åˆ†é¡µ\n      const start = (this.currentPage - 1) * this.pageSize;\n      const end = start + this.pageSize;\n      return filtered.slice(start, end);\n    },\n    totalPages() {\n      return Math.ceil(this.products.length / this.pageSize);\n    }\n  },\n  mounted() {\n    console.log('å•†å“ç®¡ç†ç»„ä»¶åŠ è½½');\n    this.loadProducts();\n    this.loadBusinessPoints();\n  },\n  methods: {\n    async loadBusinessPoints() {\n      const bid = this.getBusinessId();\n      if (!bid) return;\n      try {\n        const localInfo = JSON.parse(localStorage.getItem('businessInfo') || '{}');\n        this.businessPoints = localInfo.points || 0;\n\n        // å°è¯•ä»APIè·å–æœ€æ–°ç§¯åˆ†\n        try {\n          const response = await axios.get(apiConfig.business.getPoints(bid));\n          if (response.data.code === 1) {\n            this.businessPoints = response.data.data;\n            // æ›´æ–°æœ¬åœ°å­˜å‚¨\n            localInfo.points = this.businessPoints;\n            localStorage.setItem('businessInfo', JSON.stringify(localInfo));\n          }\n        } catch (e) {\n          console.warn('è·å–ç§¯åˆ†å¤±è´¥ï¼Œä½¿ç”¨æœ¬åœ°ç¼“å­˜');\n        }\n      } catch (error) {\n        console.error('åŠ è½½ç§¯åˆ†ä¿¡æ¯å¤±è´¥', error);\n      }\n    },\n    openPromoteModal(product) {\n      this.selectedProduct = product;\n      this.promotePoints = 100;\n      this.showPromoteModal = true;\n      this.loadBusinessPoints(); // åˆ·æ–°ä½™é¢\n    },\n    closePromoteModal() {\n      this.showPromoteModal = false;\n      this.selectedProduct = null;\n    },\n    async submitPromote() {\n      if (this.promotePoints > this.businessPoints) {\n        alert('ç§¯åˆ†ä½™é¢ä¸è¶³ï¼Œè¯·å‰å¾€å•†å®¶ä¿¡æ¯é¡µå……å€¼');\n        return;\n      }\n      if (this.promotePoints <= 0) {\n        alert('è¯·è¾“å…¥æœ‰æ•ˆçš„ç§¯åˆ†æ•°é‡');\n        return;\n      }\n      this.loading = true;\n      const bid = this.getBusinessId();\n      try {\n        // 1. æ‰£é™¤ç§¯åˆ† (è°ƒç”¨ promoteProduct æ¥å£)\n        // æ³¨æ„ï¼šå¦‚æœåç«¯ promoteProduct æ²¡æœ‰æ›´æ–° ratingï¼Œæˆ‘ä»¬éœ€è¦é¢å¤–è°ƒç”¨ updateProduct\n        const promoteResponse = await axios.post(apiConfig.business.promoteProduct(bid, this.selectedProduct.pid), {\n          points: this.promotePoints\n        });\n\n        // 2. æ›´æ–°æœ¬åœ°æ˜¾ç¤ºçš„ç§¯åˆ†\n        this.businessPoints -= this.promotePoints;\n        const localInfo = JSON.parse(localStorage.getItem('businessInfo') || '{}');\n        localInfo.points = this.businessPoints;\n        localStorage.setItem('businessInfo', JSON.stringify(localInfo));\n\n        // 3. è®¡ç®—æ–°è¯„åˆ†å¹¶ä¿å­˜åˆ°æ•°æ®åº“ (Rating)\n        const product = this.products.find(p => p.pid === this.selectedProduct.pid);\n        if (product) {\n          const currentHeat = product.heat || 100; // ä½¿ç”¨ heat ä½œä¸º rating æ˜¾ç¤º\n          const newRating = currentHeat + this.promotePoints;\n\n          // æ›´æ–°æœ¬åœ°\n          product.heat = newRating;\n          product.rating = newRating; // ç¡®ä¿ rating å­—æ®µä¹Ÿæ›´æ–°\n\n          // æ˜¾å¼è°ƒç”¨æ›´æ–°å•†å“æ¥å£ä¿å­˜ Rating\n          try {\n            const updateData = {\n              ...product,\n              rating: newRating,\n              heat: newRating // åŒæ—¶æ›´æ–°ä¸¤ä¸ªå­—æ®µä»¥é˜²ä¸‡ä¸€\n            };\n            await axios.put(apiConfig.business.updateProduct(bid), updateData);\n            console.log('è¯„åˆ†å·²ä¿å­˜åˆ°æ•°æ®åº“:', newRating);\n          } catch (updateError) {\n            console.error('ä¿å­˜è¯„åˆ†å¤±è´¥:', updateError);\n            alert('æ¨å¹¿æˆåŠŸï¼Œä½†è¯„åˆ†ä¿å­˜å¤±è´¥ï¼Œè¯·é‡è¯•');\n          }\n        }\n        alert(`æ¨å¹¿æˆåŠŸï¼å•†å“è¯„åˆ†å¢åŠ  ${this.promotePoints}`);\n        this.closePromoteModal();\n      } catch (error) {\n        console.error('æ¨å¹¿å¤±è´¥', error);\n        alert('æ¨å¹¿å¤±è´¥: ' + (error.response?.data?.message || error.message));\n      } finally {\n        this.loading = false;\n      }\n    },\n    // è·å–å•†å®¶ID\n    getBusinessId() {\n      try {\n        const businessInfo = JSON.parse(localStorage.getItem('businessInfo') || '{}');\n        return businessInfo.bid || businessInfo.id;\n      } catch (error) {\n        console.error('è·å–å•†å®¶IDå¤±è´¥:', error);\n        return null;\n      }\n    },\n    async loadProducts() {\n      this.loading = true;\n      try {\n        const bid = this.getBusinessId();\n        console.log('å•†å®¶ID:', bid);\n        if (!bid) {\n          alert('è¯·å…ˆç™»å½•å•†å®¶è´¦å·');\n          this.$router.push('/business/login');\n          return;\n        }\n\n        // å¹¶è¡Œè¯·æ±‚å•†å“å’Œè®¢å•æ•°æ®ï¼Œä»¥ä¾¿è®¡ç®—é”€é‡\n        const [productsRes, ordersRes] = await Promise.all([axios.get(apiConfig.business.getProducts(bid)), axios.get(apiConfig.business.getOrders(bid)).catch(e => ({\n          data: {\n            code: 0,\n            data: []\n          }\n        }))]);\n        let products = [];\n        if (productsRes.data.code === 1) {\n          products = productsRes.data.data || [];\n        }\n        let orders = [];\n        if (ordersRes.data && ordersRes.data.code === 1) {\n          orders = ordersRes.data.data || [];\n          console.log('åŸå§‹è®¢å•æ•°æ®:', orders.slice(0, 3)); // æ‰“å°å‰3ä¸ªè®¢å•ç”¨äºè°ƒè¯•\n        } else {\n          console.warn('è·å–è®¢å•å¤±è´¥æˆ–æ— æ•°æ®:', ordersRes.data);\n        }\n\n        // 2.1 å»ºç«‹å•†å“IDå’Œåç§°æ˜ å°„è¡¨\n        const productMap = {};\n        const nameToPidMap = {};\n        products.forEach(p => {\n          if (p.pid) {\n            productMap[p.pid] = p;\n            if (p.name) nameToPidMap[p.name.trim()] = p.pid;\n          }\n        });\n\n        // 2.2 å‡†å¤‡è¡¥å…¨è®¢å•ä¿¡æ¯çš„é€»è¾‘\n        const detailPromises = [];\n        orders.forEach(order => {\n          let hasValidInfo = false;\n\n          // æ£€æŸ¥æ˜¯å¦æœ‰æœ‰æ•ˆçš„å•†å“ä¿¡æ¯\n          if (order.items && Array.isArray(order.items) && order.items.length > 0) {\n            const firstItem = order.items[0];\n            if (firstItem.name && firstItem.name !== 'å•†å“' && firstItem.name !== 'é»˜è®¤å•†å“' && firstItem.name !== 'æœªçŸ¥å•†å“') {\n              hasValidInfo = true;\n            }\n          } else if (order.product_name || order.productName) {\n            hasValidInfo = true;\n          }\n\n          // å¦‚æœä¿¡æ¯ä¸å…¨ï¼Œä¸”æœ‰OIDï¼ŒåŠ å…¥è¡¥å…¨é˜Ÿåˆ—\n          if (!hasValidInfo && (order.oid || order.id)) {\n            const oid = order.oid || order.id;\n            // å°è¯•ä»æœ¬åœ° productMap åæŸ¥\n            let foundInLocal = false;\n            if ((order.pid || order.productId) && productMap[order.pid || order.productId]) {\n              const p = productMap[order.pid || order.productId];\n              if (!order.items || !order.items.length) {\n                order.items = [{\n                  name: p.name,\n                  quantity: order.quantity || 1,\n                  pid: p.pid\n                }];\n              } else {\n                order.items[0].name = p.name;\n                order.items[0].pid = p.pid;\n              }\n              foundInLocal = true;\n            }\n\n            // å¦‚æœæœ¬åœ°ä¹Ÿæ²¡æ‰¾åˆ°ï¼Œè¯·æ±‚è¯¦æƒ…æ¥å£\n            if (!foundInLocal) {\n              detailPromises.push(axios.get(apiConfig.order.getOrderDetail(oid)).then(res => {\n                if (res.data.code === 1 && res.data.data) {\n                  const detail = res.data.data;\n                  let name = '';\n                  let pid = '';\n                  if (detail.items && detail.items.length) {\n                    name = detail.items[0].name;\n                    pid = detail.items[0].id || detail.items[0].pid;\n                  } else if (detail.product_name) {\n                    name = detail.product_name;\n                  }\n                  if (name) {\n                    if (!order.items || !order.items.length) {\n                      order.items = [{\n                        name: name,\n                        quantity: 1,\n                        pid: pid\n                      }];\n                    } else {\n                      order.items[0].name = name;\n                      if (pid) order.items[0].pid = pid;\n                    }\n                  }\n                }\n              }).catch(e => console.warn(`è¡¥å…¨è®¢å• ${oid} è¯¦æƒ…å¤±è´¥`, e)));\n            }\n          }\n        });\n\n        // ç­‰å¾…æ‰€æœ‰è¯¦æƒ…è¡¥å…¨å®Œæˆ\n        if (detailPromises.length > 0) {\n          console.log(`æ­£åœ¨è¡¥å…¨ ${detailPromises.length} ä¸ªè®¢å•çš„å•†å“ä¿¡æ¯...`);\n          await Promise.allSettled(detailPromises);\n        }\n\n        // 2.3 è®¡ç®—æ¯ä¸ªå•†å“çš„é”€é‡\n        const salesMap = {};\n        orders.forEach(order => {\n          // å½’ä¸€åŒ–å¤„ç† items\n          let items = [];\n          if (order.items && Array.isArray(order.items)) {\n            items = order.items;\n          } else if (order.products && Array.isArray(order.products)) {\n            items = order.products;\n          } else if (order.pid || order.productName) {\n            items = [{\n              pid: order.pid,\n              name: order.productName,\n              quantity: order.quantity || 1\n            }];\n          }\n          items.forEach(item => {\n            const qty = parseInt(item.quantity || item.count || 1);\n\n            // 1. ä¼˜å…ˆä½¿ç”¨ PID åŒ¹é…\n            if (item.pid || item.id) {\n              const pidStr = String(item.pid || item.id);\n              salesMap[pidStr] = (salesMap[pidStr] || 0) + qty;\n            }\n            // 2. å…¶æ¬¡ä½¿ç”¨åç§°åŒ¹é…\n            else if (item.name) {\n              const cleanName = item.name.trim();\n              if (nameToPidMap[cleanName]) {\n                const pidStr = String(nameToPidMap[cleanName]);\n                salesMap[pidStr] = (salesMap[pidStr] || 0) + qty;\n              } else {\n                salesMap[cleanName] = (salesMap[cleanName] || 0) + qty;\n              }\n            }\n          });\n        });\n        console.log('å•†å“ç®¡ç†-é”€é‡ç»Ÿè®¡:', salesMap);\n\n        // å°†é”€é‡åˆå¹¶åˆ°å•†å“æ•°æ®ä¸­\n        this.products = products.map(p => ({\n          ...p,\n          sales_count: (salesMap[String(p.pid)] || 0) + (p.name ? salesMap[p.name.trim()] || 0 : 0) || p.sales_count || 0,\n          // ç¡®ä¿ heat ä¼˜å…ˆä½¿ç”¨æ•°æ®åº“ä¸­çš„ ratingï¼Œå¦‚æœæ²¡æœ‰åˆ™ä½¿ç”¨ heatï¼Œæœ€åé»˜è®¤ä¸º 100\n          heat: p.rating || p.heat || 100,\n          rating: p.rating || p.heat || 100,\n          // å¦‚æœçŠ¶æ€æœªå®šä¹‰ï¼Œé»˜è®¤ä¸º1ï¼ˆåœ¨å”®ä¸­ï¼‰\n          status: p.status !== undefined && p.status !== null ? p.status : 1\n        }));\n        console.log(`åŠ è½½äº† ${this.products.length} ä¸ªå•†å“`);\n      } catch (error) {\n        console.error('åŠ è½½å•†å“å¤±è´¥:', error);\n        // ... (error handling)\n        this.products = [];\n      } finally {\n        this.loading = false;\n      }\n    },\n    async toggleProductStatus(product) {\n      const action = product.status === 1 ? 'ä¸‹æ¶' : 'ä¸Šæ¶';\n      if (!confirm(`ç¡®å®šè¦${action}å•†å“ \"${product.name}\" å—ï¼Ÿ`)) {\n        return;\n      }\n      try {\n        const bid = this.getBusinessId();\n        if (!bid) {\n          alert('å•†å®¶ä¿¡æ¯ä¸å®Œæ•´');\n          return;\n        }\n\n        // æ›´æ–°å•†å“çŠ¶æ€ - æ³¨æ„ï¼šæ–‡æ¡£ä¸­æ²¡æœ‰ç›´æ¥çš„APIï¼Œä½¿ç”¨æ›´æ–°å•†å“æ¥å£\n        const updateData = {\n          ...product,\n          status: product.status === 1 ? 0 : 1\n        };\n\n        // ä½¿ç”¨api.config.jsä¸­çš„é…ç½®\n        const apiUrl = apiConfig.business.updateProduct(bid);\n        const response = await axios.put(apiUrl, updateData);\n        if (response.data.code === 1) {\n          product.status = product.status === 1 ? 0 : 1;\n          alert(`å•†å“å·²${action}`);\n        } else {\n          alert(`${action}å¤±è´¥: ${response.data.message}`);\n        }\n      } catch (error) {\n        console.error(`${action}å•†å“å¤±è´¥:`, error);\n        alert(`${action}å¤±è´¥: ${error.message}`);\n      }\n    },\n    editProduct(product) {\n      this.newProduct = {\n        ...product\n      };\n      this.showAddModal = true;\n    },\n    async submitProduct() {\n      if (!this.validateProduct()) {\n        return;\n      }\n      try {\n        const bid = this.getBusinessId();\n        if (!bid) {\n          alert('å•†å®¶ä¿¡æ¯ä¸å®Œæ•´');\n          return;\n        }\n        const productData = {\n          ...this.newProduct,\n          price: parseFloat(this.newProduct.price) || 0,\n          stock: parseInt(this.newProduct.stock) || 0,\n          rating: 100 // é»˜è®¤è¯„åˆ†\n        };\n        let response;\n        if (this.newProduct.pid) {\n          // æ›´æ–°å•†å“ - ä½¿ç”¨api.config.jsä¸­çš„é…ç½®\n          const apiUrl = apiConfig.business.updateProduct(bid);\n          response = await axios.put(apiUrl, productData);\n        } else {\n          // æ·»åŠ å•†å“ - ä½¿ç”¨api.config.jsä¸­çš„é…ç½®\n          const apiUrl = apiConfig.business.uploadProduct(bid);\n          response = await axios.post(apiUrl, productData);\n        }\n        if (response.data.code === 1) {\n          alert(this.newProduct.pid ? 'å•†å“æ›´æ–°æˆåŠŸï¼' : 'å•†å“æ·»åŠ æˆåŠŸï¼');\n          this.closeAddModal();\n          this.loadProducts();\n        } else {\n          alert(`${this.newProduct.pid ? 'æ›´æ–°' : 'æ·»åŠ '}å¤±è´¥: ${response.data.message}`);\n        }\n      } catch (error) {\n        console.error('æ“ä½œå•†å“å¤±è´¥:', error);\n        alert('æ“ä½œå¤±è´¥: ' + error.message);\n      }\n    },\n    validateProduct() {\n      if (!this.newProduct.name || !this.newProduct.name.trim()) {\n        alert('è¯·è¾“å…¥å•†å“åç§°');\n        return false;\n      }\n      const price = parseFloat(this.newProduct.price);\n      if (!this.newProduct.price || isNaN(price) || price <= 0) {\n        alert('è¯·è¾“å…¥æœ‰æ•ˆçš„ä»·æ ¼');\n        return false;\n      }\n      const stock = parseInt(this.newProduct.stock);\n      if (!this.newProduct.stock || isNaN(stock) || stock < 0) {\n        alert('è¯·è¾“å…¥æœ‰æ•ˆçš„åº“å­˜æ•°é‡');\n        return false;\n      }\n      return true;\n    },\n    closeAddModal() {\n      this.showAddModal = false;\n      this.resetNewProduct();\n    },\n    resetNewProduct() {\n      this.newProduct = {\n        name: '',\n        price: '',\n        stock: '',\n        description: '',\n        CPU: '',\n        GPU: '',\n        storage: '',\n        size: '',\n        type: '',\n        picture: '',\n        rating: 100,\n        status: 1\n      };\n    },\n    getStockLevel(stock) {\n      const stockNum = parseInt(stock) || 0;\n      if (stockNum <= 0) return 'out';\n      if (stockNum < 5) return 'low';\n      if (stockNum < 20) return 'medium';\n      return 'high';\n    },\n    prevPage() {\n      if (this.currentPage > 1) this.currentPage--;\n    },\n    nextPage() {\n      if (this.currentPage < this.totalPages) this.currentPage++;\n    },\n    viewProductDetail(product) {\n      // æ˜¾ç¤ºå•†å“è¯¦æƒ…æ¨¡æ€æ¡†\n      this.selectedProduct = product;\n      this.showDetailModal = true;\n    },\n    closeDetailModal() {\n      // å…³é—­å•†å“è¯¦æƒ…æ¨¡æ€æ¡†\n      this.showDetailModal = false;\n      this.selectedProduct = null;\n    }\n  }\n};","map":{"version":3,"names":["axios","apiConfig","name","data","loading","searchKeyword","statusFilter","sortBy","currentPage","pageSize","products","showAddModal","showDetailModal","showPromoteModal","promotePoints","businessPoints","selectedProduct","newProduct","price","stock","description","CPU","GPU","storage","size","type","picture","rating","status","computed","filteredProducts","filtered","keyword","toLowerCase","filter","p","includes","undefined","toString","sort","a","b","pid","sales_count","start","end","slice","totalPages","Math","ceil","length","mounted","console","log","loadProducts","loadBusinessPoints","methods","bid","getBusinessId","localInfo","JSON","parse","localStorage","getItem","points","response","get","business","getPoints","code","setItem","stringify","e","warn","error","openPromoteModal","product","closePromoteModal","submitPromote","alert","promoteResponse","post","promoteProduct","find","currentHeat","heat","newRating","updateData","put","updateProduct","updateError","message","businessInfo","id","$router","push","productsRes","ordersRes","Promise","all","getProducts","getOrders","catch","orders","productMap","nameToPidMap","forEach","trim","detailPromises","order","hasValidInfo","items","Array","isArray","firstItem","product_name","productName","oid","foundInLocal","productId","quantity","getOrderDetail","then","res","detail","allSettled","salesMap","item","qty","parseInt","count","pidStr","String","cleanName","map","toggleProductStatus","action","confirm","apiUrl","editProduct","submitProduct","validateProduct","productData","parseFloat","uploadProduct","closeAddModal","isNaN","resetNewProduct","getStockLevel","stockNum","prevPage","nextPage","viewProductDetail","closeDetailModal"],"sources":["D:\\1_homework_file\\å¤§ä¸‰ä¸Š\\è½¯ä»¶å·¥ç¨‹\\é¡¹ç›®ç•™æ¡£\\1å‰ç«¯å¼€å‘_æˆ‘æ‰æ˜¯çœŸçš„\\version5.0\\src\\views\\business\\BusinessProduct.vue"],"sourcesContent":["<template>\r\n  <div class=\"business-products\">\r\n    <!-- é¡µé¢å¤´éƒ¨ -->\r\n    <div class=\"page-header\">\r\n      <h2>å•†å“ç®¡ç†</h2>\r\n      <div class=\"header-actions\">\r\n        <button class=\"btn-add\" @click=\"showAddModal = true\">\r\n          <span class=\"btn-icon\">+</span>\r\n          æ·»åŠ å•†å“\r\n        </button>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- ç­›é€‰å’Œæœç´¢åŒºåŸŸ -->\r\n    <div class=\"filters\">\r\n      <div class=\"search-box\">\r\n        <input\r\n            type=\"text\"\r\n            v-model=\"searchKeyword\"\r\n            placeholder=\"æœç´¢å•†å“åç§°...\"\r\n            class=\"search-input\"\r\n        />\r\n        <span class=\"search-icon\">ğŸ”</span>\r\n      </div>\r\n\r\n      <div class=\"filter-group\">\r\n        <select v-model=\"statusFilter\" class=\"filter-select\">\r\n          <option value=\"all\">å…¨éƒ¨çŠ¶æ€</option>\r\n          <option value=\"1\">åœ¨å”®ä¸­</option>\r\n          <option value=\"0\">å·²ä¸‹æ¶</option>\r\n        </select>\r\n\r\n        <select v-model=\"sortBy\" class=\"filter-select\">\r\n          <option value=\"newest\">æœ€æ–°æ·»åŠ </option>\r\n          <option value=\"sales\">é”€é‡æœ€é«˜</option>\r\n          <option value=\"price_asc\">ä»·æ ¼ä»ä½åˆ°é«˜</option>\r\n          <option value=\"price_desc\">ä»·æ ¼ä»é«˜åˆ°ä½</option>\r\n        </select>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- å•†å“è¡¨æ ¼ -->\r\n    <div class=\"products-table\">\r\n      <table>\r\n        <thead>\r\n        <tr>\r\n          <th>å•†å“å›¾ç‰‡</th>\r\n          <th>å•†å“ä¿¡æ¯</th>\r\n          <th>ä»·æ ¼</th>\r\n          <th>åº“å­˜</th>\r\n          <th>çŠ¶æ€</th>\r\n          <th>è¯„åˆ†</th>\r\n          <th>é”€é‡</th>\r\n          <th>æ“ä½œ</th>\r\n        </tr>\r\n        </thead>\r\n        <tbody>\r\n        <!-- å•†å“åˆ—è¡¨ -->\r\n        <tr v-for=\"product in filteredProducts\" :key=\"product.pid\">\r\n          <td>\r\n            <div class=\"product-image\">\r\n              <img v-if=\"product.picture\" :src=\"product.picture\" :alt=\"product.name\">\r\n              <span v-else class=\"image-placeholder\">ğŸ’»</span>\r\n            </div>\r\n          </td>\r\n          <td>\r\n            <div class=\"product-info\">\r\n              <div class=\"product-name\">{{ product.name }}</div>\r\n              <div class=\"product-desc\">{{ product.description }}</div>\r\n              <div class=\"product-spec\">\r\n                <span v-if=\"product.CPU\">CPU: {{ product.CPU }}</span>\r\n                <span v-if=\"product.GPU\"> | GPU: {{ product.GPU }}</span>\r\n                <span v-if=\"product.storage\"> | å†…å­˜: {{ product.storage }}</span>\r\n              </div>\r\n            </div>\r\n          </td>\r\n          <td>\r\n            <div class=\"product-price\">Â¥{{ product.price }}</div>\r\n          </td>\r\n          <td>\r\n            <div class=\"product-stock\">\r\n                <span :class=\"['stock-badge', getStockLevel(product.stock)]\">\r\n                  {{ product.stock }}\r\n                </span>\r\n            </div>\r\n          </td>\r\n          <td>\r\n              <span :class=\"['status-badge', product.status === 1 ? 'active' : 'inactive']\">\r\n                {{ product.status === 1 ? 'åœ¨å”®ä¸­' : 'å·²ä¸‹æ¶' }}\r\n              </span>\r\n          </td>\r\n          <td>\r\n            <div class=\"product-heat\">\r\n              <span class=\"heat-icon\">â­</span>\r\n              {{ product.heat || 100 }}\r\n            </div>\r\n          </td>\r\n          <td>\r\n            <div class=\"product-sales\">{{ product.sales_count || 0 }}</div>\r\n          </td>\r\n          <td>\r\n            <div class=\"product-actions\">\r\n              <button class=\"btn-promote\" @click=\"openPromoteModal(product)\">\r\n                 <span class=\"btn-icon\">ğŸš€</span> æ¨å¹¿\r\n              </button>\r\n              <button class=\"btn-edit\" @click=\"editProduct(product)\">ç¼–è¾‘</button>\r\n              <button v-if=\"product.status === 1\"\r\n                      class=\"btn-offline\"\r\n                      @click=\"toggleProductStatus(product)\">\r\n                ä¸‹æ¶\r\n              </button>\r\n              <button v-else\r\n                      class=\"btn-online\"\r\n                      @click=\"toggleProductStatus(product)\">\r\n                ä¸Šæ¶\r\n              </button>\r\n              <button class=\"btn-view\" @click=\"viewProductDetail(product)\">è¯¦æƒ…</button>\r\n            </div>\r\n          </td>\r\n        </tr>\r\n\r\n        <!-- æ— æ•°æ®æç¤º -->\r\n        <tr v-if=\"filteredProducts.length === 0\">\r\n          <td colspan=\"7\" class=\"no-products\">æš‚æ— å•†å“æ•°æ®</td>\r\n        </tr>\r\n        </tbody>\r\n      </table>\r\n    </div>\r\n\r\n    <!-- åˆ†é¡µ -->\r\n    <div class=\"pagination\">\r\n      <button class=\"pagination-btn\" :disabled=\"currentPage === 1\" @click=\"prevPage\">\r\n        ä¸Šä¸€é¡µ\r\n      </button>\r\n      <span class=\"pagination-info\">ç¬¬ {{ currentPage }} é¡µ / å…± {{ totalPages }} é¡µ</span>\r\n      <button class=\"pagination-btn\" :disabled=\"currentPage === totalPages\" @click=\"nextPage\">\r\n        ä¸‹ä¸€é¡µ\r\n      </button>\r\n    </div>\r\n\r\n    <!-- æ·»åŠ /ç¼–è¾‘å•†å“æ¨¡æ€æ¡† -->\r\n    <div v-if=\"showAddModal\" class=\"modal-overlay\" @click.self=\"closeAddModal\">\r\n      <div class=\"modal\">\r\n        <div class=\"modal-header\">\r\n          <h3>{{ newProduct.pid ? 'ç¼–è¾‘å•†å“' : 'æ·»åŠ å•†å“' }}</h3>\r\n          <button class=\"modal-close\" @click=\"closeAddModal\">Ã—</button>\r\n        </div>\r\n        <div class=\"modal-body\">\r\n          <form @submit.prevent=\"submitProduct\">\r\n            <!-- è¡¨å•å­—æ®µ -->\r\n            <div class=\"form-group\">\r\n              <label>å•†å“åç§° *</label>\r\n              <input type=\"text\" v-model=\"newProduct.name\" placeholder=\"è¯·è¾“å…¥å•†å“åç§°\" required>\r\n            </div>\r\n\r\n            <div class=\"form-row\">\r\n              <div class=\"form-group\">\r\n                <label>ä»·æ ¼ *</label>\r\n                <input type=\"number\" v-model=\"newProduct.price\" placeholder=\"è¯·è¾“å…¥ä»·æ ¼\" min=\"0\" required>\r\n              </div>\r\n\r\n              <div class=\"form-group\">\r\n                <label>åº“å­˜ *</label>\r\n                <input type=\"number\" v-model=\"newProduct.stock\" placeholder=\"è¯·è¾“å…¥åº“å­˜æ•°é‡\" min=\"0\" required>\r\n              </div>\r\n            </div>\r\n\r\n            <div class=\"form-group\">\r\n              <label>å•†å“æè¿°</label>\r\n              <textarea v-model=\"newProduct.description\" placeholder=\"è¯·è¾“å…¥å•†å“æè¿°\" rows=\"3\"></textarea>\r\n            </div>\r\n\r\n            <div class=\"form-row\">\r\n              <div class=\"form-group\">\r\n                <label>CPU</label>\r\n                <input type=\"text\" v-model=\"newProduct.CPU\" placeholder=\"å¦‚ï¼šIntel i7-1165G7\">\r\n              </div>\r\n              <div class=\"form-group\">\r\n                <label>GPU</label>\r\n                <input type=\"text\" v-model=\"newProduct.GPU\" placeholder=\"å¦‚ï¼šIntel Iris Xe\">\r\n              </div>\r\n            </div>\r\n\r\n            <div class=\"form-row\">\r\n              <div class=\"form-group\">\r\n                <label>å†…å­˜</label>\r\n                <input type=\"text\" v-model=\"newProduct.storage\" placeholder=\"å¦‚ï¼š16GB DDR4\">\r\n              </div>\r\n              <div class=\"form-group\">\r\n                <label>å±å¹•å°ºå¯¸</label>\r\n                <input type=\"text\" v-model=\"newProduct.size\" placeholder=\"å¦‚ï¼š13.9è‹±å¯¸\">\r\n              </div>\r\n            </div>\r\n\r\n            <div class=\"form-row\">\r\n              <div class=\"form-group\">\r\n                <label>å•†å“ç±»å‹</label>\r\n                <input type=\"text\" v-model=\"newProduct.type\" placeholder=\"å¦‚ï¼šç¬”è®°æœ¬ç”µè„‘ã€æ¸¸æˆæœ¬\">\r\n              </div>\r\n              <div class=\"form-group\">\r\n                <label>å•†å“çŠ¶æ€</label>\r\n                <select v-model=\"newProduct.status\" class=\"form-select\">\r\n                  <option :value=\"1\">ä¸Šæ¶ (åœ¨å”®)</option>\r\n                  <option :value=\"0\">ä¸‹æ¶ (ä»“åº“ä¸­)</option>\r\n                </select>\r\n              </div>\r\n            </div>\r\n\r\n            <div class=\"form-group\">\r\n              <label>å•†å“å›¾ç‰‡URL</label>\r\n              <input type=\"text\" v-model=\"newProduct.picture\" placeholder=\"è¾“å…¥å›¾ç‰‡URLåœ°å€\">\r\n            </div>\r\n\r\n            <div class=\"form-actions\">\r\n              <button type=\"button\" class=\"btn-cancel\" @click=\"closeAddModal\">å–æ¶ˆ</button>\r\n              <button type=\"submit\" class=\"btn-submit\">{{ newProduct.pid ? 'æ›´æ–°' : 'æ·»åŠ ' }}å•†å“</button>\r\n            </div>\r\n          </form>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- æ¨å¹¿å•†å“æ¨¡æ€æ¡† -->\r\n    <div v-if=\"showPromoteModal\" class=\"modal-overlay\" @click.self=\"closePromoteModal\">\r\n      <div class=\"modal\">\r\n        <div class=\"modal-header\">\r\n          <h3><span class=\"modal-icon\">ğŸš€</span> æ¨å¹¿å•†å“</h3>\r\n          <button class=\"modal-close\" @click=\"closePromoteModal\">Ã—</button>\r\n        </div>\r\n        <div class=\"modal-body\">\r\n          <div class=\"promote-product-info\">\r\n             <div class=\"promote-image\">\r\n                <img v-if=\"selectedProduct?.picture\" :src=\"selectedProduct.picture\" alt=\"\">\r\n                <span v-else>ğŸ’»</span>\r\n             </div>\r\n             <div class=\"promote-details\">\r\n               <h4>{{ selectedProduct?.name }}</h4>\r\n               <p>å½“å‰è¯„åˆ†: <span class=\"heat-value\">â­ {{ selectedProduct?.heat || 100 }}</span></p>\r\n               <p class=\"account-points\">\r\n                 è´¦æˆ·ä½™é¢: <span class=\"points-value\">ğŸ’ {{ businessPoints }}</span>\r\n                 <button class=\"btn-link-recharge\" @click=\"$router.push('/business/profile')\">å»å……å€¼</button>\r\n               </p>\r\n             </div>\r\n          </div>\r\n          \r\n          <div class=\"promote-options\">\r\n            <div class=\"form-group\">\r\n              <label>æŠ•å…¥ç§¯åˆ† (1ç§¯åˆ† = 1è¯„åˆ†)</label>\r\n              <input type=\"number\" v-model.number=\"promotePoints\" min=\"1\" step=\"10\" placeholder=\"è¯·è¾“å…¥è¦æŠ•å…¥çš„ç§¯åˆ†\" class=\"form-input\">\r\n              <p class=\"hint\">æ¯æŠ•å…¥ 1 ç§¯åˆ†å¯å¢åŠ  1 ç‚¹è¯„åˆ†ï¼ŒåŸºç¡€åˆ†100ï¼Œä¸Šä¸å°é¡¶ã€‚</p>\r\n            </div>\r\n            \r\n            <div class=\"quick-select\">\r\n              <button type=\"button\" v-for=\"amount in [10, 50, 100, 500]\" :key=\"amount\" @click=\"promotePoints = amount\" class=\"tag-btn\">\r\n                {{ amount }}\r\n              </button>\r\n            </div>\r\n          </div>\r\n\r\n          <div class=\"form-actions\">\r\n            <button type=\"button\" class=\"btn-cancel\" @click=\"closePromoteModal\">å–æ¶ˆ</button>\r\n            <button type=\"button\" class=\"btn-submit\" @click=\"submitPromote\" :disabled=\"loading || promotePoints <= 0\">\r\n              {{ loading ? 'å¤„ç†ä¸­...' : 'ç¡®è®¤æ¨å¹¿' }}\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- å•†å“è¯¦æƒ…æ¨¡æ€æ¡† -->\r\n    <div v-if=\"showDetailModal && selectedProduct\" class=\"modal-overlay\" @click.self=\"closeDetailModal\">\r\n      <div class=\"modal modal-large\">\r\n        <div class=\"modal-header\">\r\n          <h3>å•†å“è¯¦æƒ…</h3>\r\n          <button class=\"modal-close\" @click=\"closeDetailModal\">Ã—</button>\r\n        </div>\r\n        <div class=\"modal-body\">\r\n          <div class=\"product-detail-content\">\r\n            <!-- å•†å“å›¾ç‰‡ -->\r\n            <div class=\"detail-image-section\">\r\n              <div class=\"detail-image\">\r\n                <img v-if=\"selectedProduct.picture\" :src=\"selectedProduct.picture\" :alt=\"selectedProduct.name\">\r\n                <span v-else class=\"detail-image-placeholder\">ğŸ’»</span>\r\n              </div>\r\n            </div>\r\n            \r\n            <!-- å•†å“ä¿¡æ¯ -->\r\n            <div class=\"detail-info-section\">\r\n              <h2 class=\"detail-product-name\">{{ selectedProduct.name }}</h2>\r\n              \r\n              <div class=\"detail-price\">\r\n                Â¥{{ selectedProduct.price }}\r\n              </div>\r\n              \r\n              <div class=\"detail-status\">\r\n                <span :class=\"['status-badge', selectedProduct.status === 1 ? 'active' : 'inactive']\">\r\n                  {{ selectedProduct.status === 1 ? 'åœ¨å”®ä¸­' : 'å·²ä¸‹æ¶' }}\r\n                </span>\r\n              </div>\r\n              \r\n              <div class=\"detail-stock\">\r\n                <strong>åº“å­˜ï¼š</strong>\r\n                <span :class=\"['stock-badge', getStockLevel(selectedProduct.stock)]\">\r\n                  {{ selectedProduct.stock }}\r\n                </span>\r\n              </div>\r\n              \r\n              <div class=\"detail-sales\">\r\n                <strong>é”€é‡ï¼š</strong> {{ selectedProduct.sales_count || 0 }}\r\n              </div>\r\n              \r\n              <div class=\"detail-description\">\r\n                <h3>å•†å“æè¿°</h3>\r\n                <p>{{ selectedProduct.description || 'æš‚æ— æè¿°' }}</p>\r\n              </div>\r\n              \r\n              <div class=\"detail-specs\">\r\n                <h3>å•†å“è§„æ ¼</h3>\r\n                <div class=\"spec-item\">\r\n                  <strong>CPUï¼š</strong>{{ selectedProduct.CPU || 'æš‚æ— ä¿¡æ¯' }}\r\n                </div>\r\n                <div class=\"spec-item\">\r\n                  <strong>GPUï¼š</strong>{{ selectedProduct.GPU || 'æš‚æ— ä¿¡æ¯' }}\r\n                </div>\r\n                <div class=\"spec-item\">\r\n                  <strong>å†…å­˜ï¼š</strong>{{ selectedProduct.storage || 'æš‚æ— ä¿¡æ¯' }}\r\n                </div>\r\n                <div class=\"spec-item\">\r\n                  <strong>å±å¹•å°ºå¯¸ï¼š</strong>{{ selectedProduct.size || 'æš‚æ— ä¿¡æ¯' }}\r\n                </div>\r\n                <div class=\"spec-item\">\r\n                  <strong>å•†å“ç±»å‹ï¼š</strong>{{ selectedProduct.type || 'æš‚æ— ä¿¡æ¯' }}\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport axios from 'axios'\r\nimport apiConfig from '@/config/api.config'\r\n\r\nexport default {\r\n  name: 'BusinessProducts',\r\n  data() {\r\n    return {\r\n      loading: false,\r\n      searchKeyword: '',\r\n      statusFilter: 'all',\r\n      sortBy: 'newest',\r\n      currentPage: 1,\r\n      pageSize: 10,\r\n\r\n      products: [],\r\n      showAddModal: false,\r\n      showDetailModal: false,\r\n      showPromoteModal: false,\r\n      promotePoints: 100,\r\n      businessPoints: 0,\r\n      selectedProduct: null,\r\n\r\n      newProduct: {\r\n        name: '',\r\n        price: '',\r\n        stock: '',\r\n        description: '',\r\n        CPU: '',\r\n        GPU: '',\r\n        storage: '',\r\n        size: '',\r\n        type: '',\r\n        picture: '',\r\n        rating: 100,\r\n        status: 1\r\n      }\r\n    }\r\n  },\r\n\r\n  computed: {\r\n    filteredProducts() {\r\n      let filtered = [...this.products]\r\n\r\n      // æœç´¢\r\n      if (this.searchKeyword) {\r\n        const keyword = this.searchKeyword.toLowerCase()\r\n        filtered = filtered.filter(p =>\r\n            (p.name && p.name.toLowerCase().includes(keyword))\r\n        )\r\n      }\r\n\r\n      // çŠ¶æ€è¿‡æ»¤\r\n      if (this.statusFilter !== 'all') {\r\n        filtered = filtered.filter(p => {\r\n            // å¦‚æœçŠ¶æ€æœªå®šä¹‰ï¼Œé»˜è®¤ä¸º1ï¼ˆåœ¨å”®ä¸­ï¼‰\r\n            const status = (p.status !== undefined && p.status !== null) ? p.status : 1;\r\n            return status.toString() === this.statusFilter;\r\n        })\r\n      }\r\n\r\n      // æ’åº\r\n      filtered.sort((a, b) => {\r\n        switch (this.sortBy) {\r\n          case 'newest':\r\n            return (b.pid || 0) - (a.pid || 0)\r\n          case 'sales':\r\n            return (b.sales_count || 0) - (a.sales_count || 0)\r\n          case 'price_asc':\r\n            return (a.price || 0) - (b.price || 0)\r\n          case 'price_desc':\r\n            return (b.price || 0) - (a.price || 0)\r\n          default:\r\n            return 0\r\n        }\r\n      })\r\n\r\n      // åˆ†é¡µ\r\n      const start = (this.currentPage - 1) * this.pageSize\r\n      const end = start + this.pageSize\r\n      return filtered.slice(start, end)\r\n    },\r\n\r\n    totalPages() {\r\n      return Math.ceil(this.products.length / this.pageSize)\r\n    }\r\n  },\r\n\r\n  mounted() {\r\n    console.log('å•†å“ç®¡ç†ç»„ä»¶åŠ è½½')\r\n    this.loadProducts()\r\n    this.loadBusinessPoints()\r\n  },\r\n\r\n  methods: {\r\n    async loadBusinessPoints() {\r\n      const bid = this.getBusinessId();\r\n      if (!bid) return;\r\n      try {\r\n        const localInfo = JSON.parse(localStorage.getItem('businessInfo') || '{}');\r\n        this.businessPoints = localInfo.points || 0;\r\n        \r\n        // å°è¯•ä»APIè·å–æœ€æ–°ç§¯åˆ†\r\n        try {\r\n            const response = await axios.get(apiConfig.business.getPoints(bid));\r\n            if (response.data.code === 1) {\r\n                this.businessPoints = response.data.data;\r\n                // æ›´æ–°æœ¬åœ°å­˜å‚¨\r\n                localInfo.points = this.businessPoints;\r\n                localStorage.setItem('businessInfo', JSON.stringify(localInfo));\r\n            }\r\n        } catch (e) {\r\n            console.warn('è·å–ç§¯åˆ†å¤±è´¥ï¼Œä½¿ç”¨æœ¬åœ°ç¼“å­˜');\r\n        }\r\n      } catch (error) {\r\n        console.error('åŠ è½½ç§¯åˆ†ä¿¡æ¯å¤±è´¥', error);\r\n      }\r\n    },\r\n\r\n    openPromoteModal(product) {\r\n      this.selectedProduct = product;\r\n      this.promotePoints = 100;\r\n      this.showPromoteModal = true;\r\n      this.loadBusinessPoints(); // åˆ·æ–°ä½™é¢\r\n    },\r\n\r\n    closePromoteModal() {\r\n      this.showPromoteModal = false;\r\n      this.selectedProduct = null;\r\n    },\r\n\r\n    async submitPromote() {\r\n       if (this.promotePoints > this.businessPoints) {\r\n         alert('ç§¯åˆ†ä½™é¢ä¸è¶³ï¼Œè¯·å‰å¾€å•†å®¶ä¿¡æ¯é¡µå……å€¼');\r\n         return;\r\n       }\r\n       if (this.promotePoints <= 0) {\r\n         alert('è¯·è¾“å…¥æœ‰æ•ˆçš„ç§¯åˆ†æ•°é‡');\r\n         return;\r\n       }\r\n\r\n       this.loading = true;\r\n       const bid = this.getBusinessId();\r\n       \r\n       try {\r\n         // 1. æ‰£é™¤ç§¯åˆ† (è°ƒç”¨ promoteProduct æ¥å£)\r\n         // æ³¨æ„ï¼šå¦‚æœåç«¯ promoteProduct æ²¡æœ‰æ›´æ–° ratingï¼Œæˆ‘ä»¬éœ€è¦é¢å¤–è°ƒç”¨ updateProduct\r\n         const promoteResponse = await axios.post(apiConfig.business.promoteProduct(bid, this.selectedProduct.pid), {\r\n           points: this.promotePoints\r\n         });\r\n\r\n         // 2. æ›´æ–°æœ¬åœ°æ˜¾ç¤ºçš„ç§¯åˆ†\r\n         this.businessPoints -= this.promotePoints;\r\n         const localInfo = JSON.parse(localStorage.getItem('businessInfo') || '{}');\r\n         localInfo.points = this.businessPoints;\r\n         localStorage.setItem('businessInfo', JSON.stringify(localInfo));\r\n\r\n         // 3. è®¡ç®—æ–°è¯„åˆ†å¹¶ä¿å­˜åˆ°æ•°æ®åº“ (Rating)\r\n         const product = this.products.find(p => p.pid === this.selectedProduct.pid);\r\n         if (product) {\r\n             const currentHeat = product.heat || 100; // ä½¿ç”¨ heat ä½œä¸º rating æ˜¾ç¤º\r\n             const newRating = currentHeat + this.promotePoints;\r\n             \r\n             // æ›´æ–°æœ¬åœ°\r\n             product.heat = newRating;\r\n             product.rating = newRating; // ç¡®ä¿ rating å­—æ®µä¹Ÿæ›´æ–°\r\n\r\n             // æ˜¾å¼è°ƒç”¨æ›´æ–°å•†å“æ¥å£ä¿å­˜ Rating\r\n             try {\r\n                 const updateData = {\r\n                     ...product,\r\n                     rating: newRating,\r\n                     heat: newRating // åŒæ—¶æ›´æ–°ä¸¤ä¸ªå­—æ®µä»¥é˜²ä¸‡ä¸€\r\n                 };\r\n                 await axios.put(apiConfig.business.updateProduct(bid), updateData);\r\n                 console.log('è¯„åˆ†å·²ä¿å­˜åˆ°æ•°æ®åº“:', newRating);\r\n             } catch (updateError) {\r\n                 console.error('ä¿å­˜è¯„åˆ†å¤±è´¥:', updateError);\r\n                 alert('æ¨å¹¿æˆåŠŸï¼Œä½†è¯„åˆ†ä¿å­˜å¤±è´¥ï¼Œè¯·é‡è¯•');\r\n             }\r\n         }\r\n\r\n         alert(`æ¨å¹¿æˆåŠŸï¼å•†å“è¯„åˆ†å¢åŠ  ${this.promotePoints}`);\r\n         this.closePromoteModal();\r\n\r\n       } catch (error) {\r\n         console.error('æ¨å¹¿å¤±è´¥', error);\r\n         alert('æ¨å¹¿å¤±è´¥: ' + (error.response?.data?.message || error.message));\r\n       } finally {\r\n         this.loading = false;\r\n       }\r\n    },\r\n\r\n    // è·å–å•†å®¶ID\r\n    getBusinessId() {\r\n      try {\r\n        const businessInfo = JSON.parse(localStorage.getItem('businessInfo') || '{}')\r\n        return businessInfo.bid || businessInfo.id\r\n      } catch (error) {\r\n        console.error('è·å–å•†å®¶IDå¤±è´¥:', error)\r\n        return null\r\n      }\r\n    },\r\n\r\n    async loadProducts() {\r\n      this.loading = true\r\n\r\n      try {\r\n        const bid = this.getBusinessId()\r\n        console.log('å•†å®¶ID:', bid)\r\n\r\n        if (!bid) {\r\n          alert('è¯·å…ˆç™»å½•å•†å®¶è´¦å·')\r\n          this.$router.push('/business/login')\r\n          return\r\n        }\r\n\r\n        // å¹¶è¡Œè¯·æ±‚å•†å“å’Œè®¢å•æ•°æ®ï¼Œä»¥ä¾¿è®¡ç®—é”€é‡\r\n        const [productsRes, ordersRes] = await Promise.all([\r\n            axios.get(apiConfig.business.getProducts(bid)),\r\n            axios.get(apiConfig.business.getOrders(bid)).catch(e => ({ data: { code: 0, data: [] } }))\r\n        ]);\r\n\r\n        let products = [];\r\n        if (productsRes.data.code === 1) {\r\n          products = productsRes.data.data || []\r\n        }\r\n\r\n        let orders = [];\r\n        if (ordersRes.data && ordersRes.data.code === 1) {\r\n            orders = ordersRes.data.data || [];\r\n            console.log('åŸå§‹è®¢å•æ•°æ®:', orders.slice(0, 3)); // æ‰“å°å‰3ä¸ªè®¢å•ç”¨äºè°ƒè¯•\r\n        } else {\r\n            console.warn('è·å–è®¢å•å¤±è´¥æˆ–æ— æ•°æ®:', ordersRes.data);\r\n        }\r\n\r\n        // 2.1 å»ºç«‹å•†å“IDå’Œåç§°æ˜ å°„è¡¨\r\n        const productMap = {};\r\n        const nameToPidMap = {};\r\n        products.forEach(p => {\r\n            if (p.pid) {\r\n                productMap[p.pid] = p;\r\n                if (p.name) nameToPidMap[p.name.trim()] = p.pid;\r\n            }\r\n        });\r\n\r\n        // 2.2 å‡†å¤‡è¡¥å…¨è®¢å•ä¿¡æ¯çš„é€»è¾‘\r\n        const detailPromises = [];\r\n\r\n        orders.forEach(order => {\r\n            let hasValidInfo = false;\r\n            \r\n            // æ£€æŸ¥æ˜¯å¦æœ‰æœ‰æ•ˆçš„å•†å“ä¿¡æ¯\r\n            if (order.items && Array.isArray(order.items) && order.items.length > 0) {\r\n                 const firstItem = order.items[0];\r\n                 if (firstItem.name && firstItem.name !== 'å•†å“' && firstItem.name !== 'é»˜è®¤å•†å“' && firstItem.name !== 'æœªçŸ¥å•†å“') {\r\n                     hasValidInfo = true;\r\n                 }\r\n            } else if (order.product_name || order.productName) {\r\n                hasValidInfo = true;\r\n            }\r\n            \r\n            // å¦‚æœä¿¡æ¯ä¸å…¨ï¼Œä¸”æœ‰OIDï¼ŒåŠ å…¥è¡¥å…¨é˜Ÿåˆ—\r\n            if (!hasValidInfo && (order.oid || order.id)) {\r\n                const oid = order.oid || order.id;\r\n                // å°è¯•ä»æœ¬åœ° productMap åæŸ¥\r\n                let foundInLocal = false;\r\n                if ((order.pid || order.productId) && productMap[order.pid || order.productId]) {\r\n                    const p = productMap[order.pid || order.productId];\r\n                    if (!order.items || !order.items.length) {\r\n                        order.items = [{ name: p.name, quantity: order.quantity || 1, pid: p.pid }];\r\n                    } else {\r\n                        order.items[0].name = p.name;\r\n                        order.items[0].pid = p.pid;\r\n                    }\r\n                    foundInLocal = true;\r\n                }\r\n                \r\n                // å¦‚æœæœ¬åœ°ä¹Ÿæ²¡æ‰¾åˆ°ï¼Œè¯·æ±‚è¯¦æƒ…æ¥å£\r\n                if (!foundInLocal) {\r\n                    detailPromises.push(\r\n                        axios.get(apiConfig.order.getOrderDetail(oid))\r\n                            .then(res => {\r\n                                if (res.data.code === 1 && res.data.data) {\r\n                                    const detail = res.data.data;\r\n                                    let name = '';\r\n                                    let pid = '';\r\n                                    \r\n                                    if (detail.items && detail.items.length) {\r\n                                        name = detail.items[0].name;\r\n                                        pid = detail.items[0].id || detail.items[0].pid;\r\n                                    } else if (detail.product_name) {\r\n                                        name = detail.product_name;\r\n                                    }\r\n                                    \r\n                                    if (name) {\r\n                                        if (!order.items || !order.items.length) {\r\n                                            order.items = [{ name: name, quantity: 1, pid: pid }];\r\n                                        } else {\r\n                                            order.items[0].name = name;\r\n                                            if (pid) order.items[0].pid = pid;\r\n                                        }\r\n                                    }\r\n                                }\r\n                            })\r\n                            .catch(e => console.warn(`è¡¥å…¨è®¢å• ${oid} è¯¦æƒ…å¤±è´¥`, e))\r\n                    );\r\n                }\r\n            }\r\n        });\r\n\r\n        // ç­‰å¾…æ‰€æœ‰è¯¦æƒ…è¡¥å…¨å®Œæˆ\r\n        if (detailPromises.length > 0) {\r\n            console.log(`æ­£åœ¨è¡¥å…¨ ${detailPromises.length} ä¸ªè®¢å•çš„å•†å“ä¿¡æ¯...`);\r\n            await Promise.allSettled(detailPromises);\r\n        }\r\n\r\n        // 2.3 è®¡ç®—æ¯ä¸ªå•†å“çš„é”€é‡\r\n        const salesMap = {};\r\n        \r\n        orders.forEach(order => {\r\n            // å½’ä¸€åŒ–å¤„ç† items\r\n            let items = [];\r\n            if (order.items && Array.isArray(order.items)) {\r\n                items = order.items;\r\n            } else if (order.products && Array.isArray(order.products)) {\r\n                items = order.products;\r\n            } else if (order.pid || order.productName) {\r\n                items = [{\r\n                    pid: order.pid,\r\n                    name: order.productName,\r\n                    quantity: order.quantity || 1\r\n                }];\r\n            }\r\n\r\n            items.forEach(item => {\r\n                const qty = parseInt(item.quantity || item.count || 1);\r\n                \r\n                // 1. ä¼˜å…ˆä½¿ç”¨ PID åŒ¹é…\r\n                if (item.pid || item.id) {\r\n                    const pidStr = String(item.pid || item.id);\r\n                    salesMap[pidStr] = (salesMap[pidStr] || 0) + qty;\r\n                } \r\n                // 2. å…¶æ¬¡ä½¿ç”¨åç§°åŒ¹é…\r\n                else if (item.name) {\r\n                    const cleanName = item.name.trim();\r\n                    if (nameToPidMap[cleanName]) {\r\n                        const pidStr = String(nameToPidMap[cleanName]);\r\n                        salesMap[pidStr] = (salesMap[pidStr] || 0) + qty;\r\n                    } else {\r\n                        salesMap[cleanName] = (salesMap[cleanName] || 0) + qty;\r\n                    }\r\n                }\r\n            });\r\n        });\r\n\r\n        console.log('å•†å“ç®¡ç†-é”€é‡ç»Ÿè®¡:', salesMap);\r\n\r\n        // å°†é”€é‡åˆå¹¶åˆ°å•†å“æ•°æ®ä¸­\r\n        this.products = products.map(p => ({\r\n            ...p,\r\n            sales_count: (salesMap[String(p.pid)] || 0) + (p.name ? (salesMap[p.name.trim()] || 0) : 0) || p.sales_count || 0,\r\n            // ç¡®ä¿ heat ä¼˜å…ˆä½¿ç”¨æ•°æ®åº“ä¸­çš„ ratingï¼Œå¦‚æœæ²¡æœ‰åˆ™ä½¿ç”¨ heatï¼Œæœ€åé»˜è®¤ä¸º 100\r\n            heat: p.rating || p.heat || 100,\r\n            rating: p.rating || p.heat || 100,\r\n            // å¦‚æœçŠ¶æ€æœªå®šä¹‰ï¼Œé»˜è®¤ä¸º1ï¼ˆåœ¨å”®ä¸­ï¼‰\r\n            status: (p.status !== undefined && p.status !== null) ? p.status : 1\r\n        }));\r\n        \r\n        console.log(`åŠ è½½äº† ${this.products.length} ä¸ªå•†å“`);\r\n\r\n      } catch (error) {\r\n        console.error('åŠ è½½å•†å“å¤±è´¥:', error)\r\n        // ... (error handling)\r\n        this.products = []\r\n      } finally {\r\n        this.loading = false\r\n      }\r\n    },\r\n\r\n    async toggleProductStatus(product) {\r\n      const action = product.status === 1 ? 'ä¸‹æ¶' : 'ä¸Šæ¶'\r\n\r\n      if (!confirm(`ç¡®å®šè¦${action}å•†å“ \"${product.name}\" å—ï¼Ÿ`)) {\r\n        return\r\n      }\r\n\r\n      try {\r\n        const bid = this.getBusinessId()\r\n        if (!bid) {\r\n          alert('å•†å®¶ä¿¡æ¯ä¸å®Œæ•´')\r\n          return\r\n        }\r\n\r\n        // æ›´æ–°å•†å“çŠ¶æ€ - æ³¨æ„ï¼šæ–‡æ¡£ä¸­æ²¡æœ‰ç›´æ¥çš„APIï¼Œä½¿ç”¨æ›´æ–°å•†å“æ¥å£\r\n        const updateData = {\r\n          ...product,\r\n          status: product.status === 1 ? 0 : 1\r\n        }\r\n\r\n        // ä½¿ç”¨api.config.jsä¸­çš„é…ç½®\r\n        const apiUrl = apiConfig.business.updateProduct(bid)\r\n        const response = await axios.put(apiUrl, updateData)\r\n\r\n        if (response.data.code === 1) {\r\n          product.status = product.status === 1 ? 0 : 1\r\n          alert(`å•†å“å·²${action}`)\r\n        } else {\r\n          alert(`${action}å¤±è´¥: ${response.data.message}`)\r\n        }\r\n      } catch (error) {\r\n        console.error(`${action}å•†å“å¤±è´¥:`, error)\r\n        alert(`${action}å¤±è´¥: ${error.message}`)\r\n      }\r\n    },\r\n\r\n    editProduct(product) {\r\n      this.newProduct = { ...product }\r\n      this.showAddModal = true\r\n    },\r\n\r\n    async submitProduct() {\r\n      if (!this.validateProduct()) {\r\n        return\r\n      }\r\n\r\n      try {\r\n        const bid = this.getBusinessId()\r\n        if (!bid) {\r\n          alert('å•†å®¶ä¿¡æ¯ä¸å®Œæ•´')\r\n          return\r\n        }\r\n\r\n        const productData = {\r\n          ...this.newProduct,\r\n          price: parseFloat(this.newProduct.price) || 0,\r\n          stock: parseInt(this.newProduct.stock) || 0,\r\n          rating: 100 // é»˜è®¤è¯„åˆ†\r\n        }\r\n\r\n        let response\r\n        if (this.newProduct.pid) {\r\n          // æ›´æ–°å•†å“ - ä½¿ç”¨api.config.jsä¸­çš„é…ç½®\r\n          const apiUrl = apiConfig.business.updateProduct(bid)\r\n          response = await axios.put(apiUrl, productData)\r\n        } else {\r\n          // æ·»åŠ å•†å“ - ä½¿ç”¨api.config.jsä¸­çš„é…ç½®\r\n          const apiUrl = apiConfig.business.uploadProduct(bid)\r\n          response = await axios.post(apiUrl, productData)\r\n        }\r\n\r\n        if (response.data.code === 1) {\r\n          alert(this.newProduct.pid ? 'å•†å“æ›´æ–°æˆåŠŸï¼' : 'å•†å“æ·»åŠ æˆåŠŸï¼')\r\n          this.closeAddModal()\r\n          this.loadProducts()\r\n        } else {\r\n          alert(`${this.newProduct.pid ? 'æ›´æ–°' : 'æ·»åŠ '}å¤±è´¥: ${response.data.message}`)\r\n        }\r\n      } catch (error) {\r\n        console.error('æ“ä½œå•†å“å¤±è´¥:', error)\r\n        alert('æ“ä½œå¤±è´¥: ' + error.message)\r\n      }\r\n    },\r\n\r\n    validateProduct() {\r\n      if (!this.newProduct.name || !this.newProduct.name.trim()) {\r\n        alert('è¯·è¾“å…¥å•†å“åç§°')\r\n        return false\r\n      }\r\n\r\n      const price = parseFloat(this.newProduct.price)\r\n      if (!this.newProduct.price || isNaN(price) || price <= 0) {\r\n        alert('è¯·è¾“å…¥æœ‰æ•ˆçš„ä»·æ ¼')\r\n        return false\r\n      }\r\n\r\n      const stock = parseInt(this.newProduct.stock)\r\n      if (!this.newProduct.stock || isNaN(stock) || stock < 0) {\r\n        alert('è¯·è¾“å…¥æœ‰æ•ˆçš„åº“å­˜æ•°é‡')\r\n        return false\r\n      }\r\n\r\n      return true\r\n    },\r\n\r\n    closeAddModal() {\r\n      this.showAddModal = false\r\n      this.resetNewProduct()\r\n    },\r\n\r\n    resetNewProduct() {\r\n      this.newProduct = {\r\n        name: '',\r\n        price: '',\r\n        stock: '',\r\n        description: '',\r\n        CPU: '',\r\n        GPU: '',\r\n        storage: '',\r\n        size: '',\r\n        type: '',\r\n        picture: '',\r\n        rating: 100,\r\n        status: 1\r\n      }\r\n    },\r\n\r\n    getStockLevel(stock) {\r\n      const stockNum = parseInt(stock) || 0\r\n      if (stockNum <= 0) return 'out'\r\n      if (stockNum < 5) return 'low'\r\n      if (stockNum < 20) return 'medium'\r\n      return 'high'\r\n    },\r\n\r\n    prevPage() {\r\n      if (this.currentPage > 1) this.currentPage--\r\n    },\r\n\r\n    nextPage() {\r\n      if (this.currentPage < this.totalPages) this.currentPage++\r\n    },\r\n\r\n    viewProductDetail(product) {\r\n      // æ˜¾ç¤ºå•†å“è¯¦æƒ…æ¨¡æ€æ¡†\r\n      this.selectedProduct = product;\r\n      this.showDetailModal = true;\r\n    },\r\n    \r\n    closeDetailModal() {\r\n      // å…³é—­å•†å“è¯¦æƒ…æ¨¡æ€æ¡†\r\n      this.showDetailModal = false;\r\n      this.selectedProduct = null;\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n/* å•†å“ç®¡ç†é¡µé¢æ ·å¼ */\r\n.business-products {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 24px;\r\n}\r\n\r\n/* é¡µé¢å¤´éƒ¨ */\r\n.page-header {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n}\r\n\r\n.page-header h2 {\r\n  margin: 0;\r\n  font-size: 24px;\r\n  color: #2d3748;\r\n  font-weight: 700;\r\n}\r\n\r\n/* æ·»åŠ æŒ‰é’® */\r\n.btn-add {\r\n  padding: 10px 20px;\r\n  background: #667eea;\r\n  color: white;\r\n  border: none;\r\n  border-radius: 0;\r\n  cursor: pointer;\r\n  display: inline-flex;\r\n  align-items: center;\r\n  gap: 8px;\r\n  font-weight: 500;\r\n  transition: background 0.3s;\r\n}\r\n\r\n.btn-add:hover {\r\n  background: #5a67d8;\r\n}\r\n\r\n/* ç­›é€‰åŒºåŸŸ */\r\n.filters {\r\n  display: flex;\r\n  flex-wrap: wrap;\r\n  gap: 16px;\r\n  align-items: center;\r\n  background: white;\r\n  padding: 16px;\r\n  border-radius: 0;\r\n  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);\r\n}\r\n\r\n.search-box {\r\n  position: relative;\r\n  flex: 1;\r\n  min-width: 200px;\r\n}\r\n\r\n.search-input {\r\n  width: 100%;\r\n  padding: 10px 40px 10px 16px;\r\n  border: 1px solid #e2e8f0;\r\n  border-radius: 0;\r\n  font-size: 14px;\r\n  transition: border-color 0.3s;\r\n}\r\n\r\n.search-input:focus {\r\n  outline: none;\r\n  border-color: #667eea;\r\n  box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);\r\n}\r\n\r\n.search-icon {\r\n  position: absolute;\r\n  right: 16px;\r\n  top: 50%;\r\n  transform: translateY(-50%);\r\n  color: #718096;\r\n  font-size: 16px;\r\n}\r\n\r\n.filter-group {\r\n  display: flex;\r\n  gap: 12px;\r\n  align-items: center;\r\n}\r\n\r\n.filter-select {\r\n  padding: 10px 16px;\r\n  border: 1px solid #e2e8f0;\r\n  border-radius: 0;\r\n  background: white;\r\n  color: #4a5568;\r\n  font-size: 14px;\r\n  min-width: 120px;\r\n}\r\n\r\n/* å•†å“è¡¨æ ¼ */\r\n.products-table {\r\n  background: white;\r\n  border-radius: 0;\r\n  overflow: hidden;\r\n  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);\r\n}\r\n\r\n.products-table table {\r\n  width: 100%;\r\n  border-collapse: collapse;\r\n}\r\n\r\n.products-table th {\r\n  background: #f8fafc;\r\n  padding: 16px;\r\n  text-align: left;\r\n  font-weight: 600;\r\n  color: #4a5568;\r\n  border-bottom: 1px solid #e2e8f0;\r\n}\r\n\r\n.products-table td {\r\n  padding: 16px;\r\n  border-bottom: 1px solid #f7fafc;\r\n  vertical-align: top;\r\n}\r\n\r\n.products-table tbody tr:hover {\r\n  background: #f8fafc;\r\n}\r\n\r\n/* å•†å“å›¾ç‰‡ */\r\n.product-image {\r\n  width: 60px;\r\n  height: 60px;\r\n  border-radius: 0;\r\n  overflow: hidden;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  background: #f8fafc;\r\n}\r\n\r\n.product-image img {\r\n  width: 100%;\r\n  height: 100%;\r\n  object-fit: cover;\r\n}\r\n\r\n.image-placeholder {\r\n  font-size: 24px;\r\n}\r\n\r\n/* å•†å“ä¿¡æ¯ */\r\n.product-info {\r\n  max-width: 300px;\r\n}\r\n\r\n.product-name {\r\n  font-weight: 600;\r\n  color: #2d3748;\r\n  margin-bottom: 4px;\r\n  line-height: 1.4;\r\n}\r\n\r\n.product-desc {\r\n  font-size: 13px;\r\n  color: #718096;\r\n  margin-bottom: 4px;\r\n  line-height: 1.4;\r\n  display: -webkit-box;\r\n  -webkit-line-clamp: 2;\r\n  -webkit-box-orient: vertical;\r\n  overflow: hidden;\r\n}\r\n\r\n.product-spec {\r\n  font-size: 12px;\r\n  color: #718096;\r\n}\r\n\r\n/* å•†å“ä»·æ ¼ */\r\n.product-price {\r\n  font-weight: 700;\r\n  color: #667eea;\r\n  font-size: 16px;\r\n}\r\n\r\n/* åº“å­˜æ ‡ç­¾æ ·å¼ */\r\n.stock-badge {\r\n  padding: 4px 12px;\r\n  border-radius: 0;\r\n  font-size: 13px;\r\n  font-weight: 500;\r\n  display: inline-block;\r\n}\r\n\r\n.stock-badge.high {\r\n  background: #c6f6d5;\r\n  color: #22543d;\r\n}\r\n\r\n.stock-badge.medium {\r\n  background: #fed7d7;\r\n  color: #742a2a;\r\n}\r\n\r\n.stock-badge.low {\r\n  background: #feebc8;\r\n  color: #744210;\r\n}\r\n\r\n.stock-badge.out {\r\n  background: #e2e8f0;\r\n  color: #4a5568;\r\n}\r\n\r\n/* çŠ¶æ€æ ‡ç­¾ */\r\n.status-badge {\r\n  padding: 4px 12px;\r\n  border-radius: 0;\r\n  font-size: 13px;\r\n  font-weight: 500;\r\n  display: inline-block;\r\n}\r\n\r\n.status-badge.active {\r\n  background: #c6f6d5;\r\n  color: #22543d;\r\n}\r\n\r\n.status-badge.inactive {\r\n  background: #e2e8f0;\r\n  color: #4a5568;\r\n}\r\n\r\n/* å•†å“é”€é‡ */\r\n.product-sales {\r\n  font-weight: 500;\r\n  color: #4a5568;\r\n}\r\n\r\n/* æ“ä½œæŒ‰é’®ç»„ */\r\n.product-actions {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 6px;\r\n  min-width: 120px;\r\n}\r\n\r\n.btn-promote {\r\n  background: linear-gradient(135deg, #f59e0b, #d97706);\r\n  color: white;\r\n  padding: 6px 12px;\r\n  border: none;\r\n  font-size: 13px;\r\n  font-weight: 500;\r\n  cursor: pointer;\r\n  transition: all 0.3s;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  gap: 4px;\r\n}\r\n.btn-promote:hover {\r\n  background: linear-gradient(135deg, #d97706, #b45309);\r\n  transform: translateY(-1px);\r\n}\r\n\r\n.product-heat {\r\n  color: #f59e0b;\r\n  font-weight: 700;\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 4px;\r\n}\r\n\r\n.promote-product-info {\r\n  display: flex;\r\n  gap: 16px;\r\n  margin-bottom: 24px;\r\n  padding: 16px;\r\n  background: #f8fafc;\r\n  border-radius: 8px;\r\n}\r\n\r\n.promote-image {\r\n  width: 80px;\r\n  height: 80px;\r\n  background: white;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  border-radius: 4px;\r\n  font-size: 32px;\r\n}\r\n.promote-image img {\r\n  width: 100%;\r\n  height: 100%;\r\n  object-fit: cover;\r\n}\r\n\r\n.promote-details h4 {\r\n  margin: 0 0 8px 0;\r\n  font-size: 18px;\r\n}\r\n\r\n.heat-value {\r\n  color: #f59e0b;\r\n  font-weight: bold;\r\n}\r\n.points-value {\r\n  color: #0ea5e9;\r\n  font-weight: bold;\r\n}\r\n.btn-link-recharge {\r\n  background: none;\r\n  border: none;\r\n  color: #0ea5e9;\r\n  text-decoration: underline;\r\n  cursor: pointer;\r\n  margin-left: 8px;\r\n  font-size: 14px;\r\n}\r\n.btn-link-recharge:hover {\r\n  color: #0284c7;\r\n}\r\n\r\n.quick-select {\r\n  display: flex;\r\n  gap: 8px;\r\n  margin-top: 8px;\r\n}\r\n\r\n.tag-btn {\r\n  padding: 4px 12px;\r\n  background: #e0f2fe;\r\n  color: #0284c7;\r\n  border: 1px solid #bae6fd;\r\n  border-radius: 16px;\r\n  cursor: pointer;\r\n  transition: all 0.2s;\r\n}\r\n.tag-btn:hover {\r\n  background: #bae6fd;\r\n}\r\n\r\n.hint {\r\n  font-size: 12px;\r\n  color: #64748b;\r\n  margin-top: 4px;\r\n}\r\n\r\n.btn-edit, .btn-offline, .btn-online, .btn-view {\r\n  padding: 6px 12px;\r\n  border: none;\r\n  border-radius: 0;\r\n  font-size: 13px;\r\n  font-weight: 500;\r\n  cursor: pointer;\r\n  transition: all 0.3s;\r\n}\r\n\r\n.btn-edit {\r\n  background: #e2e8f0;\r\n  color: #4a5568;\r\n}\r\n\r\n.btn-edit:hover {\r\n  background: #cbd5e0;\r\n}\r\n\r\n.btn-offline {\r\n  background: #fed7d7;\r\n  color: #c53030;\r\n}\r\n\r\n.btn-offline:hover {\r\n  background: #feb2b2;\r\n}\r\n\r\n.btn-online {\r\n  background: #c6f6d5;\r\n  color: #22543d;\r\n}\r\n\r\n.btn-online:hover {\r\n  background: #9ae6b4;\r\n}\r\n\r\n.btn-view {\r\n  background: #bee3f8;\r\n  color: #2c5282;\r\n}\r\n\r\n.btn-view:hover {\r\n  background: #90cdf4;\r\n}\r\n\r\n/* æ— å•†å“æç¤º */\r\n.no-products {\r\n  text-align: center;\r\n  color: #a0aec0;\r\n  padding: 40px 0;\r\n}\r\n\r\n/* åˆ†é¡µ */\r\n.pagination {\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  gap: 16px;\r\n  padding: 20px;\r\n  background: white;\r\n  border-radius: 0;\r\n  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);\r\n}\r\n\r\n.pagination-btn {\r\n  padding: 8px 16px;\r\n  border: 1px solid #e2e8f0;\r\n  background: white;\r\n  color: #4a5568;\r\n  border-radius: 0;\r\n  cursor: pointer;\r\n  font-size: 14px;\r\n  transition: all 0.3s;\r\n}\r\n\r\n.pagination-btn:hover:not(:disabled) {\r\n  border-color: #667eea;\r\n  color: #667eea;\r\n}\r\n\r\n.pagination-btn:disabled {\r\n  opacity: 0.5;\r\n  cursor: not-allowed;\r\n}\r\n\r\n.pagination-info {\r\n  color: #718096;\r\n  font-size: 14px;\r\n}\r\n\r\n/* æ¨¡æ€æ¡†æ ·å¼ */\r\n.modal-overlay {\r\n  position: fixed;\r\n  top: 0;\r\n  left: 0;\r\n  right: 0;\r\n  bottom: 0;\r\n  background: rgba(0, 0, 0, 0.5);\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  z-index: 1000;\r\n  padding: 20px;\r\n}\r\n\r\n.modal {\r\n  background: white;\r\n  width: 100%;\r\n  max-width: 600px;\r\n  max-height: 90vh;\r\n  overflow-y: auto;\r\n  border-radius: 0;\r\n}\r\n\r\n/* å¤§å°ºå¯¸æ¨¡æ€æ¡† */\r\n.modal.modal-large {\r\n  max-width: 900px;\r\n  width: 90%;\r\n}\r\n\r\n/* å•†å“è¯¦æƒ…æ¨¡æ€æ¡†æ ·å¼ */\r\n.product-detail-content {\r\n  display: flex;\r\n  gap: 30px;\r\n  padding: 20px 0;\r\n}\r\n\r\n.detail-image-section {\r\n  flex: 1;\r\n  max-width: 400px;\r\n}\r\n\r\n.detail-image {\r\n  width: 100%;\r\n  height: 300px;\r\n  background: #f8fafc;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  overflow: hidden;\r\n}\r\n\r\n.detail-image img {\r\n  width: 100%;\r\n  height: 100%;\r\n  object-fit: contain;\r\n}\r\n\r\n.detail-image-placeholder {\r\n  font-size: 60px;\r\n}\r\n\r\n.detail-info-section {\r\n  flex: 1;\r\n}\r\n\r\n.detail-product-name {\r\n  font-size: 24px;\r\n  margin: 0 0 15px 0;\r\n  color: #2d3748;\r\n}\r\n\r\n.detail-price {\r\n  font-size: 28px;\r\n  font-weight: 700;\r\n  color: #667eea;\r\n  margin-bottom: 15px;\r\n}\r\n\r\n.detail-status {\r\n  margin-bottom: 15px;\r\n}\r\n\r\n.detail-stock,\r\n.detail-sales {\r\n  margin-bottom: 15px;\r\n  font-size: 16px;\r\n}\r\n\r\n.detail-description {\r\n  margin-bottom: 25px;\r\n}\r\n\r\n.detail-description h3,\r\n.detail-specs h3 {\r\n  font-size: 18px;\r\n  margin: 0 0 10px 0;\r\n  color: #2d3748;\r\n  border-bottom: 1px solid #e2e8f0;\r\n  padding-bottom: 5px;\r\n}\r\n\r\n.detail-description p {\r\n  line-height: 1.6;\r\n  color: #4a5568;\r\n  margin: 0;\r\n}\r\n\r\n.detail-specs {\r\n  margin-bottom: 20px;\r\n}\r\n\r\n.spec-item {\r\n  margin-bottom: 10px;\r\n  font-size: 16px;\r\n  color: #4a5568;\r\n}\r\n\r\n/* å“åº”å¼è®¾è®¡ */\r\n@media (max-width: 768px) {\r\n  .product-detail-content {\r\n    flex-direction: column;\r\n  }\r\n  \r\n  .detail-image-section {\r\n    max-width: 100%;\r\n  }\r\n  \r\n  .detail-image {\r\n    height: 250px;\r\n  }\r\n}\r\n\r\n.modal-header {\r\n  padding: 20px;\r\n  border-bottom: 1px solid #e2e8f0;\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n}\r\n\r\n.modal-header h3 {\r\n  margin: 0;\r\n  font-size: 18px;\r\n  color: #2d3748;\r\n  font-weight: 600;\r\n}\r\n\r\n.modal-close {\r\n  background: none;\r\n  border: none;\r\n  font-size: 24px;\r\n  color: #718096;\r\n  cursor: pointer;\r\n  width: 32px;\r\n  height: 32px;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  border-radius: 0;\r\n  transition: background 0.3s;\r\n}\r\n\r\n.modal-close:hover {\r\n  background: #f7fafc;\r\n}\r\n\r\n.modal-body {\r\n  padding: 20px;\r\n}\r\n\r\n/* è¡¨å•æ ·å¼ */\r\n.form-group {\r\n  margin-bottom: 20px;\r\n}\r\n\r\n.form-group label {\r\n  display: block;\r\n  margin-bottom: 6px;\r\n  color: #4a5568;\r\n  font-weight: 500;\r\n  font-size: 14px;\r\n}\r\n\r\n.form-group input,\r\n.form-group textarea,\r\n.form-group select {\r\n  width: 100%;\r\n  padding: 10px;\r\n  border: 1px solid #e2e8f0;\r\n  border-radius: 0;\r\n  font-size: 14px;\r\n  transition: border-color 0.3s;\r\n}\r\n\r\n.form-group input:focus,\r\n.form-group textarea:focus,\r\n.form-group select:focus {\r\n  outline: none;\r\n  border-color: #667eea;\r\n}\r\n\r\n.form-group textarea {\r\n  resize: vertical;\r\n  min-height: 80px;\r\n}\r\n\r\n.form-row {\r\n  display: grid;\r\n  grid-template-columns: 1fr 1fr;\r\n  gap: 16px;\r\n}\r\n\r\n.form-actions {\r\n  display: flex;\r\n  justify-content: flex-end;\r\n  gap: 12px;\r\n  margin-top: 30px;\r\n  padding-top: 20px;\r\n  border-top: 1px solid #e2e8f0;\r\n}\r\n\r\n.btn-cancel {\r\n  padding: 10px 20px;\r\n  border: 1px solid #e2e8f0;\r\n  background: white;\r\n  color: #4a5568;\r\n  border-radius: 0;\r\n  cursor: pointer;\r\n  font-size: 14px;\r\n  font-weight: 500;\r\n  transition: all 0.3s;\r\n}\r\n\r\n.btn-cancel:hover {\r\n  background: #f7fafc;\r\n}\r\n\r\n.btn-submit {\r\n  padding: 10px 20px;\r\n  background: #667eea;\r\n  color: white;\r\n  border: none;\r\n  border-radius: 0;\r\n  cursor: pointer;\r\n  font-size: 14px;\r\n  font-weight: 500;\r\n  transition: all 0.3s;\r\n}\r\n\r\n.btn-submit:hover {\r\n  background: #5a67d8;\r\n}\r\n\r\n/* å“åº”å¼è®¾è®¡ */\r\n@media (max-width: 768px) {\r\n  .page-header {\r\n    flex-direction: column;\r\n    align-items: flex-start;\r\n    gap: 16px;\r\n  }\r\n\r\n  .filters {\r\n    flex-direction: column;\r\n    align-items: stretch;\r\n  }\r\n\r\n  .search-box {\r\n    min-width: 100%;\r\n  }\r\n\r\n  .filter-group {\r\n    flex-direction: column;\r\n    width: 100%;\r\n  }\r\n\r\n  .filter-select {\r\n    width: 100%;\r\n  }\r\n\r\n  .form-row {\r\n    grid-template-columns: 1fr;\r\n  }\r\n\r\n  .product-actions {\r\n    flex-direction: row;\r\n    flex-wrap: wrap;\r\n  }\r\n\r\n  .modal {\r\n    margin: 10px;\r\n  }\r\n}\r\n\r\n@media (max-width: 480px) {\r\n  .products-table {\r\n    font-size: 14px;\r\n  }\r\n\r\n  .product-image {\r\n    width: 40px;\r\n    height: 40px;\r\n  }\r\n\r\n  .image-placeholder {\r\n    font-size: 18px;\r\n  }\r\n}\r\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}